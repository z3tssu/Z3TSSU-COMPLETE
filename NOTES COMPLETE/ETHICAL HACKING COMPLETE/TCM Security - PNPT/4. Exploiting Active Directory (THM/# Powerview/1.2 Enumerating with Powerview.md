---
title: 1.2 Enumerating with Powerview
updated: 2023-04-23T19:14:45.0000000+04:00
created: 2023-02-20T21:22:14.0000000+04:00
---

1.2 Enumerating with Powerview
Monday, February 20, 2023
9:22 PM

1.  Open a command prompt terminal on windows
2.  Change directory to the powerview.ps1 location
3.  Run the following command:

- **Powershell -ep bypass** (for Execution Policy)

Execution policy is enabled to prevent us from running scripts that we are not meant to in a way

![image1](image1-119.png)

4.  Now run powerview with below command:

- **. .\PowerView.ps1**

![image2](image2-57.png)

**\# - ---- ---------------- PowerView Cheat sheet.---------------**
[3.1 PowerView Cheat Sheet.html](3.1_PowerView_Cheat_Sheet.html)

----------------------------------------------------------------------------------------

| **Command** | **Get-NetDomain** |
|-------------|-------------------|

- This command will get information for us about the domain

![image3](image3-39.png)

| Command | **Get-NetDomainController** |
|---------|-----------------------------|

- To see specifically what domain controller there are.

![image4](image4-26.png)

| Command | **Get-DomainPolicy** |
|---------|----------------------|

- This will show all the policies in the domain #policies #policy 

![image5](image5-17.png)

| Command | **(Get-DomainPolicy)."system access"** |
|---------|----------------------------------------|

- To view further policies about passwords

![image6](image6-10.png)

| Command | **Get-NetUser** |
|---------|-----------------|

- This will dump all the users on the domain.

![image7](image7-7.png)

| Command | **Get-NetUser \| select cn** |
|---------|------------------------------|

- This will pull down only the usernames in the domain

![image8](image8-6.png)

| Command | **Get-NetUser \| select samaccountname** |
|---------|------------------------------------------|

- Will pull down only the sam account names.

![image9](image9-3.png)

| Command | **Get-UserProperty** |
|---------|----------------------|

- This will show all the property that a user might have

![image10](image10-1.png)

| Command | **Get-UserProperty -Properties pwdlastset** |
|---------|---------------------------------------------|

- Let's say we want to look at the properties of the user last set

![image11](image11.png)

| Command | **Get-UserProperty -Properties logoncount** |
|---------|---------------------------------------------|

- To view how many times a user might have logged in,
- Useful to view honeypot accounts

![image12](image12.png)

| Command | **Get-UserProperty -Properties badpwdcount** |
|---------|----------------------------------------------|

- To view which users have been entering bad passwords

![image13](image13.png)

| Command | **Get-NetComputer** |
|---------|---------------------|

- To get the computers in the domain

![image14](image14.png)

| Command | **Get-NetComputer -FullData** |
|---------|-------------------------------|

- This will provide you with more information

| Command | **Get-NetComputer -FullData \| select OperatingSystem** |
|---------|---------------------------------------------------------|

- Provides information only about the operating system of the computers

| Command | **Get-NetGroup** |
|---------|------------------|

- To get the groups in the domain

| Command | **Get-NetGroupMember -GroupName "Domain Admins"** |
|---------|---------------------------------------------------|

- To get the members of those groups

![image15](image15.png)

| Command | **Invoke-ShareFinder** |
|---------|------------------------|

- This will find all the SMB shares on the network

![image16](image16.png)

| Command | **Get-NetGPO** |
|---------|----------------|

- This is going to show us all the group policies

<https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993>

