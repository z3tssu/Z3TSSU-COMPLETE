---
title: Exploitation - Abusing Kerberos - ASREPRoasting | ...
updated: 2023-04-05T11:42:12.0000000+04:00
created: 2023-03-29T21:49:57.0000000+04:00
---

Exploitation - Abusing Kerberos - ASREPRoasting \| Impacket
Wednesday, March 29, 2023
9:49 PM
1.  After the enumeration of user accounts is finished, we can attempt to abuse a feature within Kerberos with an attack method called ASREPRoasting.

2.  ASREPRoasting occurs when a user account has the privilege "Does not require Pre-Authentication" set. This means that the account does not need to provide valid identification before requesting a Kerberos Ticket on the specified user account.

**<u>Retrieving Kerberos Tickets</u>**

Impacket has a tool called "GetNPUsers.py" (located in impacket/examples/GetNPUsers.py) that will allow us to query ASReproastable accounts from the Key Distribution Center. The only thing that's necessary to query accounts is a valid set of usernames which we enumerated previously via Kerbrute.

Remember: Impacket may also need you to use a python version \>=3.7.

you can do this by running your command with

- python3.9 /opt/impacket/examples/GetNPUsers.py.

**\# --------------------- Running Impacket \| GetNPUsers.py ---------------------**

| Command | python GetNPUsers.py -no-pass -usersfile ./users.txt -dc-ip \<target ip\> spooky.local/ |
|---------|-----------------------------------------------------------------------------------------|

![image1](image1-143.png)

**\# -------------------------- Identifying the Type of Hash: ------------------------**

- On a google search you can simple paste the hash and find out
- You can use ChatGPT
- You can use hashid

This will be the answer:

Based on the hash provided, it appears to be a Kerberos 5 hash. Specifically, it appears to be a Kerberos 5 AS-REP hash, which is used for authentication in a Kerberos environment.

**\# To crack a Kerberos 5 AS-REP hash like the one you provided, you would use hashcat's mode 18200.**

To use hashcat to crack this hash, you will need a wordlist or a set of rules that you can use to generate candidate passwords to test against the hash. Here's an example command to run hashcat with mode 18200 and a wordlist attack:

php

- hashcat -m 18200 \<hash_file\> \<wordlist_file\>

Example:

![image2](image2-71.png)

Cracked Hash:

![image3](image3-47.png)

