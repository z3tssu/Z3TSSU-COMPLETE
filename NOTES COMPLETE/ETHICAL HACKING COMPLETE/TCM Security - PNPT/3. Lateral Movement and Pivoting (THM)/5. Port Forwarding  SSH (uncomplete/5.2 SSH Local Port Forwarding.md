---
title: 5.2 SSH Local Port Forwarding
updated: 2023-04-23T19:14:45.0000000+04:00
created: 2023-04-18T11:05:34.0000000+04:00
---

AM
**Local port forwarding**

Allows us to "pull" a port from an SSH server into the SSH client. In our scenario, this could be used to take any service available in our attacker's machine and make it available through a port on PC-1. That way, any host that can't connect directly to the attacker's PC but can connect to PC-1 will now be able to reach the attacker's services through the pivot host.

Using this type of port forwarding would allow us to run reverse shells from hosts that normally wouldn't be able to connect back to us or simply make any service we want available to machines that have no direct connection to us.

![image1](image1-111.png)

To forward port 80 from the attacker's machine and make it available from PC-1, we can run the following command on PC-1:  

| Command | C:\\\> ssh tunneluser@1.1.1.1 -L \*:80:127.0.0.1:80 -N |
|---------|--------------------------------------------------------|

![image2](image2-52.png)

## Explaining the Commands

The command structure is similar to the one used in remote port forwarding but uses the **-L** option for local port forwarding. This option requires us to indicate the local socket used by PC-1 to receive connections (**\*:80**) and the remote socket to connect to from the attacker's PC perspective (**127.0.0.1:80**).

Notice that we use the IP address 127.0.0.1 in the second socket, as from the attacker's PC perspective, that's the host that holds the port 80 to be forwarded.

Since we are opening a new port on PC-1, we might need to add a firewall rule to allow for incoming connections (with dir=in). Administrative privileges are needed for this:

| Command | netsh advfirewall firewall add rule name="Open Port 80" dir=in action=allow protocol=TCP localport=80 |
|---------|-------------------------------------------------------------------------------------------------------|

Once your tunnel is set up, any user pointing their browsers to PC-1 at <http://2.2.2.2:80> and see the website published by the attacker's machine.

