Title: Leveraging Windows Services for Command Execution

- Ports:
  - 135/TCP, 49152-65535/TCP (DCE/RPC)
  - 445/TCP (RPC over SMB Named Pipes)
  - 139/TCP (RPC over SMB Named Pipes)
- Required Group Memberships: Administrators

- ### Using Windows Services for Command Execution:
  - Windows services can be utilized to run arbitrary commands as they execute a command when started.
  - By configuring a Windows service to run any application, we can execute commands remotely.
  - Creating a service can be done using the standard Windows tool called sc.exe, which connects to the Service Control Manager (SVCCTL) remote service program through RPC.

- ### Creating and Starting a Service:
  - Example commands to create and start a service named "THMservice":
    ```cmd
    sc.exe \\TARGET create THMservice binPath= "net user munra Pass123 /add" start= auto
    sc.exe \\TARGET start THMservice
    ```
  - The "net user" command will be executed when the service starts, creating a new local user on the system.
  - Output from the command execution won't be visible as the operating system handles starting the service.

- ### Stopping and Deleting the Service:
  - To stop and delete the service, execute the following commands:
    ```cmd
    sc.exe \\TARGET stop THMservice
    sc.exe \\TARGET delete THMservice
    ```

Note: When utilizing Windows services for command execution, ensure proper authorization and adhere to security best practices.