---
title: 4.2.1 Boolean-based blind SQLi
updated: 2022-11-28T15:22:25.0000000+04:00
created: 2022-11-28T14:55:01.0000000+04:00
---

**<u>4.2.1 Boolean-based blind SQLi</u>**
Monday, November 28, 2022
2:55 PM

**<u>Boolean-based blind SQLi</u>**

- attacker mainly sends an SQL query to the database, and the response identifies whether the query is a true or false result
- yes/no, on/off, 1/0 or any response which can only ever have two outcomes.

1.  **<u>Example 1 of Boolean-based blind SQLi</u>**

![image1](image1-183.png)

<https://website.thm/checkuser?username=admin>

1.  The browser body contains the contents of {"taken":true}.
2.  This API endpoint replicates a common feature found on many signup forms
3.  checks whether a username has already been registered to prompt the user to choose a different username.
4.  Because the taken value is set to true, we can assume the username admin is already registered.
5.  In fact, we can confirm this by changing the username in the mock browser's address bar from **admin to admin123**, and upon pressing enter, you'll see the value taken has now changed to false.

![image2](image2-81.png)

1.  The SQL query that is processed looks like the following:

- **select \* from users where username = '%username%' LIMIT 1;**

1.  As the only input, we have control over is the username in the query string
2.  we'll have to use this to perform our SQL Injection.
3.  Keeping the username as **admin123**,
4.  we can start appending to this to try and make the database confirm true things, which will change the state of the taken field from false to true.

**<u>Determine the number of Columns in the user table</u>**

1.  Change the username value to the following:
- admin123' UNION SELECT 1;--

![image3](image3-53.png)

1.  web application has responded with the value taken as false, we can confirm this is the incorrect value of columns
2.  Keep on adding more columns until we have a taken value of true
- admin123' UNION SELECT 1,2,3;--
![image4](image4-36.png)

**<u>Discovering the Database Name</u>**

1.  Now that our number of columns has been established
2.  Our first task is **discovering the database name.**
3.  We can do this by using the built-in **database()** method and then using the like operator to try and find results that will return a true status.

Try the below username value and see what happens:
- admin123' UNION SELECT 1,2,3 where database() like '%';--

![image5](image5-24.png)

1.  We get a true response because, in the like operator, we just have the value of **%, which will match anything as it's the wildcard value**.

2.  If we change the wildcard operator to **a%**, you'll see the response goes back to false, which confirms that the database name does not begin with the letter a.  

3.  We can cycle through all the letters, numbers and characters such as - and \_ until we discover a match.

4.  If you send the below as the username value, you'll receive a true response that confirms the database name begins with the letter s.
- admin123' UNION SELECT 1,2,3 where database() like 's%';--

![image6](image6-16.png)

1.  Now you can move up to the next character of the database name until you find another true response.
2.  Example: **'sa%', 'sb%', 'sc%**' etc.
3.  The final database name in this case is: **sqli_three**

**<u>Enumerating Table Names</u>**

1.  Once you have established the database name, you can use it to enumerate for the tables names, (similar method to the previous tasks)
2.  Set the username parameter in the URL as followed:

- admin123' UNION SELECT 1,2,3 FROM information_schema.tables WHERE table_schema = 'sqli_three' and table_name like 'a%';--

1.  Again like the previous method to identify the database name, you need to cycle through all letters until you receive a true response.
2.  You'll finally end up discovering a table in the **sqli_three database named users,**
3.  which you can be confirmed by running the following username payload:
- admin123' UNION SELECT 1,2,3 FROM information_schema.tables WHERE table_schema = 'sqli_three' and table_name='users';--

![image7](image7-12.png)

**<u>Enumerating Column Names</u>**

1.  we now need to enumerate the column names in the users table so we can properly search it for login credentials
2.  we search the columns table where the database is equal to sqli_three, the table name is users, and the column name begins with the letter a.
- admin123' UNION SELECT 1,2,3 FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='sqli_three' and TABLE_NAME='users' and COLUMN_NAME like 'a%';
3.  You will need to cycle through the letters as before until you find the correct column name with true responces.

**<u>Appending found column names</u>**

1.  you'll have to add the found column name to your payload each time you find a new column name,
2.  so you don't keep discovering the same one.
3.  For example, once you've found the column named **id, you'll append that to your original payload (as seen below).**

- admin123' UNION SELECT 1,2,3 FROM information_schema.COLUMNS WHERE TABLE_SCHEMA='sqli_three' and TABLE_NAME='users' and COLUMN_NAME like 'a%' and COLUMN_NAME !='id';

1.  Repeating this process three times will **enable you to discover the columns id, username and password.**

**<u>Enumerating Usernames:</u>**

1.  now you can use to query the users table for login credentials. First, you'll need to discover a valid username which you can use the payload below:

- admin123' UNION SELECT 1,2,3 from users where username like 'a%

1.  once you've cycled through all the characters, you will confirm the existence of the username **admin**.

**<u>Enumerating Passwords:</u>**

1.  Now you've got the username. You can concentrate on discovering the password. The payload below shows you how to find the password:

- admin123' UNION SELECT 1,2,3 from users where username='admin' and password like 'a%
