- ### Hash Values and Hashing Algorithms

	- Hash value is a fixed-length numeric value that uniquely identifies data.
	- Hash value is the result of a hashing algorithm.
- ### Common hashing algorithms:
  - MD5 (Message Digest, RFC 1321):
    - Designed by Ron Rivest in 1992.
    - 128-bit hash value.
    - Not considered cryptographically secure.
    - Vulnerable to attacks, including hash collision.
  - SHA-1 (Secure Hash Algorithm 1, RFC 3174):
    - Invented by the United States National Security Agency in 1995.
    - Produces a 160-bit hash value as a 40-digit hexadecimal number.
    - Deprecated by NIST in 2011.
    - Banned for digital signatures at the end of 2013 due to susceptibility to brute-force attacks.
    - NIST recommends migrating to stronger hash algorithms in the SHA-2 and SHA-3 families.
  - SHA-2 (Secure Hash Algorithm 2):
    - Designed by NIST and NSA in 2001.
    - Includes multiple variants, with SHA-256 being the most common.
    - SHA-256 returns a 256-bit hash value as a 64-digit hexadecimal number.
- Cryptographically secure hashes should have unique hash values for different files.
- Hash values are used by security professionals for:
  - Gaining insight into malware samples and suspicious files.
  - Uniquely identifying and referencing malicious artifacts.
- Ransomware reports often provide hashes related to malicious files.
- Examples of reports: The DFIR Report and FireEye Threat Research Blogs.
- ### Online tools for hash lookups:
  - VirusTotal
  - Metadefender Cloud - OPSWAT.

- #### Challenges with File Hashes as Indicators of Compromise (IOCs)
	- Identifying malicious files using hash values is straightforward, as any modification to a file produces a different hash value.
	- Attackers can easily modify a file, even by a single bit, resulting in a different hash value.
	- Threat hunting using file hashes as IOCs can become challenging due to the following reasons:
	  - Numerous variations and instances of known malware or ransomware.
- #### Example of modifying a file's hash value using the "echo" command:
  - Before Modification:
    ```
    PS C:\Users\THM\Downloads> Get-FileHash .\OpenVPN_2.5.1_I601_amd64.msi -Algorithm MD5
    Algorithm Hash                             Path                                                 
    _________ ____                             ____                                                 
    MD5       D1A008E3A606F24590A02B853E955CF7 C:\Users\THM\Downloads\OpenVPN_2.5.1_I601_amd64.msi
    ```
  - After Modification:
    ```
    PS C:\Users\THM\Downloads> echo "AppendTheHash" >> .\OpenVPN_2.5.1_I601_amd64.msi
    PS C:\Users\THM\Downloads> Get-FileHash .\OpenVPN_2.5.1_I601_amd64.msi -Algorithm MD5
    Algorithm Hash                             Path                                                 
    _________ ____                             ____                                                 
    MD5       9D52B46F5DE41B73418F8E0DACEC5E9F C:\Users\THM\Downloads\OpenVPN_2.5.1_I601_amd64.msi
    ```
