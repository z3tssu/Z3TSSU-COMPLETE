[https://read.amazon.com/?asin=B0DLLLY73G&ref_=kwl_kr_iv_rec_1](https://read.amazon.com/?asin=B0DLLLY73G&ref_=kwl_kr_iv_rec_1)

- To Follow up on
    1. ==Regional Enforcement and Allied Computer Task Force (REACT)==

# 1. A History of Cryptocurrencies and Crime

- Definition of Cryptocurrency
    1. Crypto part of cryptocurrency comes from the fact that all cryptocurrency have their transactions and transaction ledgers confirmed and protected by cryptography
- History of Cryptocurrency (Origins)
    1. Cryptographer David Chaum
        1. Created electronic money called Digicash
    2. Bit Gold concept by Nick Szabo
- Blockchain Meaning
    - Cryptographically connected series, or chain of blocks containing transaction data
- The Rise of the Smart Contract (Ethereum)
    - Uses Account Based Model
    - Ethereum provided a programming language called solidity (Turing-complete language) which afforded the ability for users to extend the functionality of the base Ethereum;
        - Building Smart Contracts; enable building for other cryptocurrencies on ethereum called tokens
- Current Cryptocurrency Blockchains
    - Almost all new cryptocurrencies are either direct emulations of the code of ethereum (such as BSC) or are based on smart contract architecture such as Cardano, Tron, VeChain, Internet Computer, etc
    
- ==Quotes - Something I can include in the presentation==
    
    - ‚ÄúMany Police officers have mentioned that they don‚Äôt really have any crimes involving crypto assets‚Äù The only reason for that statement is that they are simply not looking for it.
    - ‚ÄùCrime moves pretty fast. If you don‚Äôt stop and look around once in a while, you could miss it.‚Äù
    - ‚ÄúWhat has been is what will be, and what has been done will be done again; There is nothing new under the sun‚Äù
    - ‚ÄúDo not forget tried and tested investigative methodology just because the crime involves cryptocurrencies‚Äù
    
      
    

  

# 2. Understanding the Criminal Opportunities: Money Laundering

- An Outline of Scams and Crime in Crypto
    1. Risks of Centralized Power and Store of Value
    2. Risks of Decentralized Platforms
    3. Bridges
        1. Not Imposing Cybersecurity Audits
    4. Risks of Self-Storage in Cold Storage such as Hard Wallets
    5. Risks of Online Self-Storage
    6. Hacks and Cyberattacks
    7. Data Breaches
    8. KYC and AML Get-Grounds
        1. False Identifications
        2. Identity Theft
    9. Impersonation Scams
    10. Phishing
    11. Address Poisoning
    12. Investment Scams
    13. Ponzi Scams
    14. Pump-and-Dump Schemes
    15. Romance Scams, or ‚ÄúPig Butchering‚Äù
- There is not such thing as Crypto Crime
    - ‚Äú‚ÄùFinancial Investigators already understand these often complex concepts and how to follow the money. FIs simply need to learn how to it relates to cryptocurrencies and then apply their existing wealth of investigative knowledge‚Äù
- Money Laundering
    
    - Definition: Money Laundering involves the the process of making illegally obtained funds (dirty) appear legitimate (clean) by disguising their true source and mixing, or blending, them.
    
    - Difference between Standard Money Laundering and Cryptocurrency;
        1. The pseudo-anonymous nature of Bitcoin provided an easy and low-risk way of turning criminal money into crypto via unregulated exchange (These existing for the first 10 years of Bitcoins History)
            1. The criminal could simply convert the funds into crypto, on an exchange that doesn‚Äôt collect KYC, then convert it back to FIAT on an unregulated exchange again.
            2. Nowadays with regulated exchanges that require KYC, there is no longer an anonymity when it comes to the criminals cashing out, that is why they use other techniques to obfuscate the flow of funds
        2. Traditional money laundering had numerous steps, or layering, to make it successful, moving the funds through a variety of sources, assets switching's, and blending.
    - Stealing is easy; (Money Laundering)
        - Stealing is relatively easy; its what you end up doing with the proceeds of theft that is most likely to get caught.
        - Money Laundering used to be complex; now, with a cryptocurrency like Bitcoin it feels easy to the criminal.
            - Criminals can be paid in crypto, ransoms paid in crypto, payoffs made in crypto then can easily be turned back into fiat currency with a single mouse click through an exchange or even on the street.
    - When KYC got implemented
        - By 2022, a legislation similar to banking legislation was levied against any organization trading cryptocurrencies,
            - They enforced the implementation of anti-money laundering checks, KYC, and suspicious activity reports
- What is an Investigator Looking For?
    - ==Centralized Exchanges (Useful for Investigations)==
        - About
            - Works in a similar way to a bank, it is owned by a company or individuals
            - A user registers an account on the centralized exchange and they receive a deposit account for cryptocurrency
            - Everything is managed by the exchange, even though the crypto is yours, the exchange has authority over it, in the event of a court order or law enforcement request
        - What you cannot do as an investigator
            - You cannot track through centralized exchanges, it is like you have deposited a $20 bill into the bank and the next day you go back to the bank and ask for the same $20 bill back
            - This is because the cash has been mixed with other funds on that day and you will never see it again
            - Without help from the bank it will be impossible to trace the bill through the bank
        - Example of why you cannot trace through exchanges
            - When crypto is paid into an account at Coinbase, for example, that crypto is not physically moved into your account; rather, your account is credited with the correct amount and the actual crypto moves into the hot/ live wallet or the cold/offline wallet of the exchange. When the customer wants to gain access to their crypto, the correct amount is sent to them from the hot wallet. This means that we as investigators trace the funds into the exchanges wallet and...well that‚Äôs it; we can go no further without the explicit assistance of the exchange
        - Assistance from most primary exchanges and why it is useful for tracing
            - most primary exchanges, willing to work with an investigation, can provide records of ==crypto paid in, crypto withdrawn==, internal currency exchanges, fiat bank account information, name, address, email, phone, photo, proof of address, and usually IP addresses. This data can be vital in tracing the funds beyond the exchange and potentially identifying money laundering
    - ==NFTs and NFT Gaming==
        - Non-fungible token
            - An NFT, which stands for ‚Äúnon-fungible token,‚Äù is a unique digital fingerprint that can refer to another digital asset such as an artwork, text, music, or pretty much anything. There is no suggestion that someone playing a blockchain-based game or buying an NFT is automatically guilty of money laundering. However, games often have their own currencies/tokens on the blockchain and you can buy characters, skill cards, land, and objects in that token or standard crypto. Many games generate in-game elements as NFTs and may store them on _side chains_, alternative chains connected to a primary chain such as Ethereum.  
                  
                  
                
        - sandbox.game
            - You can buy land for thousands of dollars, transfer that land to another person anonymously on the blockchain and sell it for significally less without anyone noticing or reports being made to
        - Opensea.io
            - A broker for NFT sales
        - Checking NFT Sales
            - https://dune.com/rchen8/opensea
        - How money laundering can utilize NFT
            - In the simplest example, the person looking to receive criminal funds takes an ‚Äúartistic‚Äù picture of their dog, posts it on an NFT broker site for $250,000, and then the holder of the criminal funds buys the NFT, neatly moving $250,000 through the broker proxy to the receiver of the funds. The same has been done with auction houses and art dealers for decades, but of course auction houses are now seriously regulated.
    - ==Mixers==
        - Tracing through Mixers Manually (UTXO Model)
            - Follow each transaction, watching the funds split and split and recombine.
            - You will have to manually trace back through the splits and recombines
            - You will have to recognize the patterns
        - Tracing through Mixers Manually (Account-Based Model)
            - The tracing in account based models, typically imply the same amount of crypto value
            - Image, there is a bucket of tennis balls, all identical and each of 10 ETH value
            - A criminal then adds their own 10 ETH tennis ball into the bucket (mixer) and after some time they remove that tennis
            - It is almost impossible to identify which individual inputted and outputted the 10 ETH
    - ==Decentralized Exchanges==
        - decentralized exchange (DEX) is based around a smart contract that handles the exchange of digital assets. They are generally non-custodial in that they do not store funds on your behalf. There are no user accounts and no KYC information is taken; the contract simply allows a user to swap from one currency to another, for example, from Wrapped Ethereum to Wrapped Bitcoin. If we see this activity in a suspect‚Äôs flow of transactions, why might it be of interest to us?‚Äù
        - Swapping of tokens to another is always done on the same blockchain
        - In a DEX that swaps tokens on one blockchain we are able to follow the contract to see what funds are swapped and where they go.
        - Swapping funds from one currency to another can help obfuscate investigations
        - When we associate a DEX swap/exchange from an address that is already suspected, we want to watch the swaps carefully as they could be a basic attempt to clean the funds
        - DEXs in themselves should not be considered suspicious. They are used by crypto users and traders for completely legitimate reasons, but where you have a suspicious address, perhaps related to a suspect, and you see movement of funds through DEXs like Uniswap, PancakeSwap, Bisq, and many others, these trails should be carefully to followed to keep track of the funds.
    - ==Casinos==
        - [Crypto gambling - No KYC](https://www.bitcoin.com/gambling/casino/anonymous/)
    - ==Chain Hopping==
        - ‚ÄúMoving funds between one blockchain to another‚Äù
        - Lets say you want to move ETH to Solana, you cannot because they operate on two different blockchains
        - You need to use a bridge
        - As investigators, why are we interested in this money laundering typology? Specifically, because it‚Äôs harder to follow the money.
        - When a chain hop occurs, we need to trace the funds into the bridge and then use the destination chain to locate the output of the transaction.
        - Investigators need to watch suspect addresses carefully to ascertain if there are transactions that relate to bridges. Find out what bridge is being transacted with and then try to locate the output transaction on the destination chain.
    - ==Privacy Coins==
        - Zcash and Monero
        - Buy and Sell Monero - [localmonero.co](http://localmonero.co) - Taken Down
        - [haveno.exchange](http://haveno.exchange) - DEX for converting crypto and fiat currencies
    - ==Crypto ATMS==
        - List of crypto ATMS around the world
            - [https://coinatmradar.com](https://coinatmradar.com/)
        
- Peer-to-Peer Platforms
    - 1 to 1 communication/transaction between two individuals
    - Lets say a person wants to Buy and the other wants to Sell, they are connected directly to each other
    - Anonymous Peer-to-peer service
        - Bisq.network
    - IF we have a suspected address that has initiated a peer to peer service

# 3. Understanding the Criminal Opportunities: Theft

- Social Engineering
- Phishing
- Hacks
    - Typical hacks begin with social engineering, especially for exchanges, the attackers target and individual through spear phishing and attempt to gain an initial foothold into the exchanges networks, etc
- Fraud
- Rug Pull
- Pig Butchering/Romance Scams
- Investments Scams
- Support Scams
- Simple Theft
- Contract Manipulation
    - Fake Token
        1. A token could contain a very high buy fee, which will steal the majority of your money at the buying phase. Think of buying a token for $100 but $99 is the token buy fee.
        2. The tokens are not able to be sold (Squid Game Token is a good example) and only the owner may sell, as we discussed previously.
        3. The token code may contain a very high sell fee, which will steal the majority of your money at the selling phase.
- Flash Loans
- Playing By the Rules
- Other Criminal Opportunities

Useful document to read for cryptocurrency investigators [https://www.nationalcrimeagency.gov.uk/who-we-are/publications/605-necc-financial-sanctions-evasion-russian-elites-and-enablers/file](https://www.nationalcrimeagency.gov.uk/who-we-are/publications/605-necc-financial-sanctions-evasion-russian-elites-and-enablers/file)

You can check out OFAC Sanctions: [https://ofac.treasury.gov/media/913571/download?inline](https://ofac.treasury.gov/media/913571/download?inline)

# 4. Who should be a Cryptocurrency Investigator

- Skills they should posses
    
    1. Should be computer literate
    2. Should have knowledge of digital currencies
    3. Knowledge of the crypto markets
    4. Extensive knowledge of computer networks
    5. Cryptography
    6. Financial Crime
    
      
    
- OSINT Books to Read
    - Hunting Cyber Criminals by Vinny Troia (Wiley, 2020)
    - Open Source Intelligence Techniques by Michael Bazzell (Amazon Digital Services, 2012)‚Äî
- Cybercrime Skills
    - Criminology and Cybercrime combined courses
- Building a Crypto Team
    1. Financial Investigators
        1. Have a wide knowledge of money laundering and financial crime
    2. Digital Forensics Specialists
        1. Can uncover cryptocurrency usage in unrelated cases
        2. Analyzing seized data and devices, identifying usage of crypto
        3. OSINT Investigators
        4. Tactical Adviser
        5. Seizure Specialists
        6. Blockchain Forensics
        

# 5. The Role of Commercial Investigation Tools

  

- Primary and Secondary Investigation Focus
    - Criminal investigations
    - Civil investigations
    - Tax avoidance identification
    - Anti-money-laundering scoring
    - Sanctioned funds identification
    - Compliance monitoring
    - Regulators Due diligence
    - Proof of funds/provenance of funds
    - Auditing Operations security and counterintelligence analysts
    - DoD civil affairs
    - Financial journalist

# 6. Mining: The Key to Cryptocurrencies

- The purpose of Mining
    - Cryptocurrency mining became a cornerstone of the blockchain ecosystem for solving these two issues but also for enabling users of the cryptocurrency to get involved in validating transactions by closing blocks on the blockchain in return for a reward, which injects new coins into the system.
- What Really is Mining?
    - Validating transactions and minting new coins.
    - As you have learned, cryptocurrencies, unlike traditional currencies, do not rely on centralized institutions like banks or governments to validate and record transactions. Instead, a decentralized network of miners work together to verify the legitimacy of transactions before they are added to the blockchain.
    - The Bitcoin method of mining, proof of work, means that the first person to find the solution to a mathematical problem will win,
- The Process of Mining?
    1. Once a transaction is initiated by a user, it enters a pool of unconfirmed transactions known as the mempool.
    2. Miners then select transactions from this pool, verify their authenticity, and compile them into a new block.
    3. The new block is added to the existing blockchain, ensuring that the transaction is permanently recorded and visible to all users.
    4. Once this is complete, the miners will be rewarded with New Coins and the transactions fees paid by the users
- How many Bitcoin will there ever be in the blockchain?
    - There will only be 21 million bitcoins in the blockchain
    - A miner receives only 3.125 BTC for every mined block
    - This amount is cut in half every 210,000 blocks or 4 years
- PoW (Proof of Work)
    
    - This method of mining, developed by Satoshi for Bitcoin, requires miners to solve complex mathematical problems to add new blocks to the blockchain. The process is actually quite simple.
    
    - How it Actually Works?
        - A group of miners compete against each other to solve a mathematical problem
        - The first miner to solve this problem, broadcasts the solution to the blockchain and the other miners then validate this
        - If majority agrees on the solution then the block will be confirmed and the miner will be rewarded
    - The complete Process of PoW (Proof of Work)
        - **Step 1:** Miner selects transactions from the **mempool**.
        - **Step 2:** Transactions are hashed using **SHA256**.
        - **Step 3:** Miner repeatedly modifies data and rehashes it.
        - **Goal:** Find a resulting hash that starts with **a specific number of zeros**.
        - **Difficulty Level:** Set by the **Bitcoin network**.
            - More leading zeros = **higher difficulty**.
        - **Current Requirement (at time of writing):** Hash must start with **19 zeros** to mine a block successfully.
        - Miners will have to try 312.67 exahashes per second‚Äîthat‚Äôs 312,667,846,052,947,000,000 hashes every second to find a hash value with 19 zeroes in around 10 minutes.
- PoS (Proof of Stake)
    
    - proof of stake (PoS) mining aims to reduce energy consumption and improve network security.
    - Miners are known as Validators are chosen based on the number of coins they hold and who are willing to ‚Äústake‚Äù a certain amount of cryptocurrency as collateral.
    
    - How PoS Mining Works
        - **Validators** are chosen **at random** to:
            - **Create new blocks**
            - **Validate transactions**
        - **Selection Probability:** Depends on the validator's **stake** (amount of cryptocurrency held and staked).
            - More coins staked = **higher chance of selection**
        - **Once Selected:**
            - Validator **verifies transactions**
            - **Creates a new block**
            - **Adds it to the blockchain**
        - **System Characteristic:** Fundamentally **simple and efficient**
        - Anyone who owns and stake 32 ETH can become an independent Ethereum Validator
    - Advantages of PoS Mining
        - More energy efficient and don‚Äôt require hardware
        - Improves the network security and greater distribution

# 7. Cryptocurrency Wallets

- You need knowledge of cryptocurrency wallet an an investigator

## üïµÔ∏è‚Äç‚ôÇÔ∏è Identifying Cryptocurrency Use During Investigations

**Context:**

- Applies during **search phases** of an investigation (e.g., **premises searches** or **digital examinations**)

**Key Objective:**

- Identify **cryptocurrency usage**

**Primary Indicator:**

- Presence of **wallets** (either **software** or **hardware**)

**Investigator Consideration:**

- ==**Digital forensics investigators**== ==must:==
    - Recognize **wallet software** on **mobile phones** or **computers**
    - Be able to identify wallets **even if app names are unfamiliar**
    - extracting software applications
    - extracting browser extensions
    - Extract any browser plug-ins that may be related to crypto
    - Correlate with the browser history
    - External Storage devices should be scanned for wallet files along with any primary computers or handled devices Q

## Good Resources for Digital Forensics in Cryptocurrency Investigations

![[/image 27.png|image 27.png]]

## Basics of what a wallet is

- It does not store the actual cryptocurrency
- It holds the private keys of the user that allow that user to perform transactions on the blockchain
- It just contains information of the private keys and the funds that are attached to that private key

![[/image 1 3.png|image 1 3.png]]

## What you can compare a crypto wallet to

- It can be compared to a bank card that is basically your key to your funds
- It enables you to go to the ATM and lookup your balance
- Or to perform a transaction to a particular vendor

## Types of Cryptocurrency Wallets

- Hot Wallets
    - Always connected to the Internet
    - Provides users always-on view of their crypto assets
    - It is also more vulnerable and there are malware or threat actors capable of exploiting vulnerabilities to extract seed phrases
    - An always connected wallet will generally be a vulnerable wallet
- Desktop Wallets
    - Application wallet installed directly on the computer
    - Extensions that are installed in the browser
    - Not all wallet application will be installed on the computer itself
        - wallets like electrum can be installed as a standalone on a USB Key
- Full Node Wallets
    - Hold a complete copy of the blockchain and acts as a node on the blockchain network
        - Example: Bitcoin Core
        - Acts as both a personal wallet and as a node on the Bitcoin Network
        
- Ethereum Node Client
    - Ethereum does not have a full node wallet
    - You can run the application to become a node client however
        - using: https://ethereum.org/en/run-a-code
- Mobile Wallets
    - Basically wallet application stores on a users
- Web/Online Wallets
    - They are custodial like wallets that can be hosted by exchanges, example Binance, Coinbase, etc
    - In reality the company hosting your wallet is responsible for its security
    
- Cold Wallets
    
    - Wallets that are not connected to the internet
    
    - Types of Cold Wallets
        1. Hardware Wallet
            1. Physical devices for storing crypto private keys securely.
            2. Often look like a small USB Key
        2. Paper Wallets
            1. Wallets that are on Paper lol
            2. You can essentially create the wallet without it ever being online
            3. You enter the public key of the wallet, it will only receive the funds once it is connected to the blockchain
            4. You can try this on: [https://iancoleman.io/bip39/](https://iancoleman.io/bip39/)
- Good Software Wallets
    - Exodus
    - ElectrumQ

# 8. The Importance of Discovery

- Discovery of evidence requires knowing how to look while not being closed-minded as to what you may find
- When you have your search briefing you are told to search for evidence that will support your case of suspicion, but this will leave you completely closed-mined to look for only one particular thing
- In the case of crypto, it can be kept in almost all category of crime and there needs to be awareness of what crypto evidence looks like and its importance with every person who attends a search or a crime scene or is searching across digital assets such as phones or computers
- Crypto can be widely used as a mechanisms for storage of proceeds of crime

## Premises Searching:

1. Investigators should familiarize themselves with local legislation and consult with legal experts and ensure that their actions are compliant with local or relevant laws
2. When writing your warrant you must mentioned the intended items to be seized, in this case if you suspect cryptocurrency usage, you must write a plausible description about your suspicion that links the suspect to the crypto usage

- Handling and Securing Evidence
    - Cryptocurrency cannot be considered seized until the funds are moved to an address controlled by the investigator
    - You have to keep in mind that the suspects may have distributed the seed phrases, private keys to other entities and they will have the ability to perform transactions on the behalf of the suspect
- Evidence Bags
    - When doing a search and containing evidence, do not use clear bags for cryptocurrency identified paper wallets, seed phrases or any viewable phrases
    - Someone could simply copy that and then later on perform malicious dues and extract the funds
    - Q
- Photography
    - There needs to be protocol to image captures and storage
    - An officer can photograph a seed phrase
    - Where is this seed phrase being stored?
    - Who has access to this seed phrase? Q

## Physical Clues

- Hardware Wallets
    - If you find a hardware wallet in the premises, the seed words will most likely be somewhere close
    - A suspect will ensure their assets are well protected/back-up meaning that will ensure they are able to recover in the event of disaster, etc
    - The Hardware Wallets comes with a box and in the box are cards for writing down seed phrases
- Paper Wallets
    - These are wallets that are directly printed/writen on paper
    - It contains the private key and public key for wallet re-creation
        
        ![[/image 2 4.png|image 2 4.png]]
        
- QR Codes
    - If you find QR Codes, it can be treated as a financial evidence as they could be the key to the funds Q
- Documents (Bank Statements, etc)
    - Basically you need to check on statements or physical document record of any interaction with online crypto services
    - You need to note the name of the crypto service company utilized on the bank statement and provide that to the financial investigator as a heads up
    - You just need to identify anything related to crypto that can provide a lead to further investigations
    - Search personnel or even financial analyst should be trained to recognize names of and possible names of crypto companies and currencies
        
        - Example: Binance, Coinbase, Kraken, Bybit, and others
        
        ![[/image 3 2.png|image 3 2.png]]
        

## Questioning (To Ask Suspect)

![[/image 4 2.png|image 4 2.png]]

![[/image 5 2.png|image 5 2.png]]

![[/image 6 2.png|image 6 2.png]]

  

## Searching for Digital Assets

- Search for Digital Assets
    - It entails for a broad spectrum of technology devices

## Digital Forensics

- The tools AXIOM from Magnet Forensics if good for extracting crypto related data
- The founder mentions that it capable of extracting addresses and transaction IDs, depending on the app
    - Support Bitcoin client on Windows
    - Support other apps such as
        
        ![[/image 7 2.png|image 7 2.png]]
        

## Identification

### What are you looking for

![[/image 8 2.png|image 8 2.png]]

![[/image 9 2.png|image 9 2.png]]

![[/image 10 2.png|image 10 2.png]]

# 9. The Workings of Bitcoin and Derivatives

## What is a Blockchain?

- A Blockchain is just a ledger
- Example:
    - It is just like you are recording transactions on lets say an excel sheet, including the date, time, etc other fields
    - But in terms of the blockchain, each 10 minutes a list of new transactions are locked into a group called a block
    - The block is locked cryptographically through the process of mining or validating
    - When we lock a new block, that block will contain all the list of transactions in the previous block
    - These blocks link together cryptographically forming a chain of blocks
    - To alter the blockchain you will need to calculate the locks of the block preceding all blocks. Which is virtually impossible

## UTXO (Unspent Transaction Output)

- Definition
    - Unspent Transaction Output
    - It is basically the amount of assets or BTC that are unspent and were preceding of other transactions
    - The difference with crypto, when you look in your wallet, the funds are not actually there, but they are stored on the blockchain ledger as unspent transactions outputs, which are linked to your private key
    - Your Private key will look at the blockchain for any UTXO that it has control over
- Scenario
    - Imaging, you go to the shop to buy a cake, it costs lets say $13
    - You have in your wallet two $10 dollar bills, these bill are in fact you unspent transaction, as they came from other transactions before, (ATM withdraw, change from other transactions, etc)
    - Now to buy the $13 dollar cake, you need to give the shop keeper both 10s, these will be the inputs of your transaction.
    - The shop keeper will give you a change of $7, this will be the ouputs of the transaction
- Bitcoin Scenario
    - If you have an unspent transaction of 1.2 BTC in your wallet and want to buy something that is 1 BTC, you have to transact the whole amount and receive the 0.2 as change (minus fees)
    - You cannot split the UTXO in the same way that you cant tear up a dollar bill to pay less than a dollar
    
- Bitcoin Address
    
    They do not contain capital O or lowercase i to prevent copy errors
    
    - Legacy addresses,
        - which start with a 1 and are 34 characters long. Sometimes referred to as Pay-to-Public-Key-Hash (P2PKH).
    - Legacy SegWit (Segregated Witness) addresses,
        - which start with a 3 and are 34 characters long. Sometimes referred to as Pay-to-Script-Hash (P2SH).
        - These addresses enable the use of multi sig, which requires multiple signatures for authorization of a transaction
        - Multisig 2 of 3, 2 of the 3 private keys are required
        - Useful for an investigator to know, as it could entail that the suspect has other conspirators
    - Native SegWit addresses,
        - which start with bc1q and are 42 characters long. Sometimes referred to as Pay-to-Witness-Public-Key-Hash (P2WPKH).
    - Taproot addresses,
        - which start with bc1p and are 62 characters long. Sometimes referred to as Pay-to-Taproot (P2TR). Taproot will be explained in more detail later in this chapter.
- What does a transaction look like?
    - Example 1
        
        ![[/image 11 2.png|image 11 2.png]]
        
        - Left side are the Inputs, Right side are the outputs
        - There is one input of 0.58 BTC
        - Where you see multiple outputs, one will always almost be the change
        - In this transaction, the 1FWQ address is the input and also the change address, this is because the user had to spend all the transactions to pay the address 1EWJ7, and receive the remaining funds back to his input address
        - though this is not always the case, the input will not always be the change address
    - Example 2
        
        ![[/image 12 2.png|image 12 2.png]]
        
        - Take a moment and try to identify the three elements. What is:
            - The input payments?
            - The change address?
            - The onward payment?
- üîç Importance of Identifying Crypto Change Address Usage in Investigations
    
    **Why it matters:**
    
    - **Following criminal funds** (e.g., **ransomware payments**) often requires tracing transactions across **multiple addresses**.
    
    **Example:**
    
    - A victim pays **0.0026 BTC** to address `1FWQ`
    - The funds are then forwarded to address `1EWJ`
    - Investigators need to **track the flow of funds** beyond the initial recipient
    
    **Key Insight:**
    
    - **Change addresses** are:
        - Often **different from the input address**
        - **Still owned** by the **spender** of the transaction
    - Recognizing change addresses is **critical** to avoid **losing the trail**
    - We should not mistakenly track the change address
- üßæ Transaction Identifiers & Address Formats in Bitcoin
    
    **üîπ Transaction ID (TXID):**
    
    - A **unique identifier** for each Bitcoin transaction
    - Format: **Hexadecimal (Base16)**
        - Includes characters: `0‚Äì9` and `A‚ÄìF`
        - **No error checking** (not meant for regular user interaction)
    - Purpose in investigations:
        - **Uniquely identifies** a transaction
        - Useful for tracing transactions involving **multiple payments or recipients**
    
    **üîπ Bitcoin Addresses:**
    
    - Format: **Base58Check**
        - A version of Base58 that includes **error-checking code**
        - Reduces risk of mistakes during manual entry
    
    **üîç Key Insight for Investigators:**
    
    - TXIDs help trace and **distinguish specific transactions**
    - Bitcoin address format includes **built-in safeguards** to ensure accuracy

## Tracking Bitcoin Transactions vs. Ethereum ‚Äî Why It Matters

### üîç Key Concept: Bitcoin's UTXO Model = Better Traceability

- In Bitcoin, **each payment** is treated as a **whole, discrete unit** (thanks to the **UTXO model ‚Äì Unspent Transaction Output**).
- This allows **individual payments** to be **tracked precisely** across the blockchain.
- **Contrast with Ethereum:** Uses an **account-based model**, making it **harder to trace individual payments** because all funds are part of a single, pooled balance.

---

### üí° Analogy: Bank Account vs. Cash (to Understand the Difference)

**1. Ethereum (Bank Account Model):**

- 10 victims send $1,000 each to a fraudster‚Äôs account ‚Üí Total balance = $10,000
- Fraudster sends $1,000 to another account.
- ‚ùå We **can‚Äôt tell** which victim‚Äôs money was used ‚Äî it‚Äôs all mixed in one balance.

**2. Bitcoin (Cash with GPS Trackers):**

- 10 victims give ten $100 bills each to a fraudster.
- If each bill had a **GPS tracker**, we could trace a **specific bill** through every transaction.
- ‚úÖ This is how Bitcoin works: Each Bitcoin input can be **individually tracked** from victim ‚Üí fraudster ‚Üí exchange/mixer.

---

### üéØ Investigative Advantage

- If **Victim A** sends 1 BTC to a known fraud address, and 9 others do the same:
    - We can **identify Victim A‚Äôs exact BTC** as it moves across the blockchain.
    - Even if the fraudster combines funds or uses mixers, **we can show that our victim‚Äôs BTC was used**.
- Useful for:
    - Submitting evidence to **exchanges**
    - **Recovering funds**
    - **Isolating victims‚Äô payments** in complex fraud schemes

---

### üß† Summary

|   |   |   |
|---|---|---|
|Feature|Bitcoin (UTXO)|Ethereum (Account-Based)|
|Transaction Model|UTXO|Account Balance|
|Traceability|‚úÖ Easy to trace individual payments|‚ùå Hard to trace exact funds|
|Analogy|Cash with GPS trackers|Bank account with mixed funds|
|Investigative Usefulness|High|Limited|

---

Let me know if you want this as a visual chart, case study template, or investigation playbook!

---

  

## Blockchain Explorers + Examples

- Just search for Blockchain + Explorer and you will finds results
- Check all blockchains for that Address
    - BTC uses the same address for LTC
    - Ethereum 0x address use the same address for multiple other addresses

---

### Blockchain Explorer Examples (BTC)

1. [Blockchain.com](http://Blockchain.com)
2. [Blockchair.com](http://Blockchair.com)
3. BlockCypher.com

---

### Following Bitcoin Transactions on a Blockchain Explorer

**Key Concept:**

- **Bitcoin transaction tracing** is different from **Ethereum** (which uses a balance/account-based model).
- Bitcoin uses the **UTXO model**, so tracking must be done by following **transaction IDs (TXIDs)**, not just addresses.

**Common Mistake:**

- Clicking on an **output address** when tracing a transaction only shows **all activity related to that address**, not the next transaction in the chain.
- This can lead to confusion when trying to follow the **flow of funds**.

**Proper Technique:**

- Use a **Bitcoin explorer** (e.g., [Blockchain.com](https://www.blockchain.com/))
- Look for **icons or arrows** to navigate to:
    - The **next transaction** (where funds were sent)
    - The **previous transaction** (where funds came from)
- **Do not** click on the address to trace funds backward.
    - Instead, use the **black arrow** pointing back.
    - Hovering over it shows: _‚ÄúTransaction the funds were received from.‚Äù_

**Visual Example:**

- Refer to **Figure 9.8** (from the text) for an example using Blockchain.com explorer.
    
    **Back-Facing Arrow:**
    
    - Clicking it shows the **previous transaction** where a specific address (e.g., `bc1q7cyr`) was **credited** with Bitcoin (e.g., 11.34... BTC).
    - This helps identify **where the funds came from**.
    
    **Forward Navigation:**
    
    - You can also follow **where the funds went** from an output.
    
    **Change Address Identification:**
    
    - In the example, **only one arrow** is shown for output address `bc1q2306`.
    - Why? The **other output** is the **same as the input address**, indicating it‚Äôs the **change address**.
    - This is a key way to **spot change outputs** in Bitcoin transactions.
    
    ![[/image 13 2.png|image 13 2.png]]
    

---

### Following Bitcoin Transactions on a Blockchain Explorer 2

![[/image 14 2.png|image 14 2.png]]

---

### üîÑ Using Blockchair.com for Transaction Tracing

**Figure 9.9 Example (Blockchair Explorer):**

- Shows a similar transaction view as Blockchain.com.
- Blockchair uses **distinct arrow icons** for:
    - **Back (where funds came from)**
    - **Forward (where funds went)**

**Change Address Detection:**

- Blockchair **guesses** which address is the **change output**, and assigns **both arrows** to that address.

**Unspent Output Behavior:**

- Output address `bc1qvy` has **no forward arrow** because:
    - The funds have **not yet been spent**.
    - Therefore, there is **no forward transaction to trace**.

---

---

### Blockchain Explorer APIs

**APIs Available:**

- Most explorers (e.g., **Blockchain.com**) offer APIs to:
    - Access transaction and block data
    - Automate queries using programming

**Example API Request:**

```Plain

https://blockchain.info/rawaddr/$bitcoin_address
```

- Returns transaction history for a given Bitcoin address
- Great for **automated analysis or custom tools**

**API Documentation:**

- Blockchain.com API

---

### API Usage Considerations

- Some APIs offer **free usage** with no authentication
- Others require:
    - **Registration**
    - **API keys**
    - **Paid plans** for extended use

**TIP:**

- **BlockCypher** allows advanced users to:
    - Download its source code
    - Run it **locally** using its API
    - GitHub: [https://github.com/blockcypher/explorer](https://github.com/blockcypher/explorer)

## What Else Can you Learn in a Transaction?

---

### Bitcoin Transactions & Analysis Notes

### üîπ Transaction Structure

- Every Bitcoin transaction has a **Transaction ID (TXID)**.
- Contains:
    - **Inputs** (source of funds)
    - **Outputs** (destination of funds)
- Most transactions include a **change address**.

### üîπ Coinbase Transaction

- If the **input** is labeled ‚Äú**Coinbase**,‚Äù it refers to:
    - The **block reward** for a miner (not the Coinbase exchange).
    - This transaction is created when a miner **mines a block**.

---

### Times & Dates in Blockchain Analysis

### ‚ùó Important Considerations

- **Blockchains do not record exact timestamps** on transactions.
- **Block timestamps** are added only when a block is mined.
- Different **blockchain explorers** may show different time data:
    - Mempool time (when it was first seen)
    - Block time (when it was confirmed)
    - Localized time (based on viewer‚Äôs timezone)

### üîç Explorer Behavior

1. **Mempool Time:**
    - Reflects when the transaction was **first seen** (not confirmed).
    - Not stored on blockchain; explorer-specific.
2. **Block Time:**
    - Reflects when the transaction was **mined** into a block.
    - More accurate but may be delayed.
3. **Timezone Display Issues:**
    - Some explorers adjust the time to **local time zones** (e.g., viewer‚Äôs region).
    - This can cause discrepancies of **several hours** in reports.
    - **Best practice:** Always use **UTC** for consistency.

### ‚ö†Ô∏è Caution in Reporting

- Be cautious when:
    - Linking a transaction to a person‚Äôs action/time.
    - Using time data from explorers (double-check the type).
- Real-life Example:
    - A suspect's transaction appeared to occur **after arrest** in one explorer.
    - But another explorer showed the transaction hit the **mempool earlier**, confirming it was made **before** the arrest.

---

### Values in Transactions

### BTC vs. Fiat

- **Bitcoin values** are fixed and stored on the blockchain.
- **Fiat values** are **not stored** in the blockchain.
    - Vary based on **explorer** and **exchange rate used**.

### üí∏ Two Types of Fiat Value Reporting:

1. Based on the **Bitcoin value at the time of mining**.
2. Based on the **Bitcoin value at the time of viewing**.

### ü§∑ How to Tell what the Explorer is Using

![[/image 15 2.png|image 15 2.png]]

---

### Bitcoin Transaction Values & Reporting in Investigations

### üìâ Why Fiat Value Accuracy Matters

- Bitcoin-to-fiat values **fluctuate heavily**.
- The value shown **today** may not reflect what it was **when the transaction occurred**.
- Investigators are often asked: **"What was the Bitcoin worth?"**
    - ‚ö†Ô∏è Be **very careful** when answering ‚Äî context matters.
    - Use the **value at the time** of the crime, not current value.

### üßæ Example Case: Fluctuating Bitcoin Value

- Victim is defrauded of **1 BTC in November 2021**.
- Purchased in 2020 at **$12,000**.
- Sent when BTC was worth **$67,000**.
- Fraudster converted BTC to fiat when value dropped to **$57,000**.
- Case goes to court in 2023, BTC is now worth **$28,715**.
- Judge awards victim **$28,715**, fraudster keeps nearly **$30,000** in gains.

### ‚ùì Which value is correct?

- $12,000 (purchase price)?
- $67,000 (at time of sending)?
- $57,000 (when converted by fraudster)?
- $28,000 (at time of trial)?

‚û°Ô∏è **Values are complex** and depend on:

- Local legislation
- Legal definitions (property vs. cash)
- Court decisions

### ‚öñÔ∏è Legal Considerations

- Some judges award the **original asset** (e.g., 1 BTC).
- Others use the **highest value since theft**.
- UK Law: Views crypto as **property**, so likely return = **Bitcoin**, not fiat.

---

### OMNI Layer & Token Tracking

### üß© What is Omni Layer?

- Originally **Mastercoin**.
- Built **on top of Bitcoin blockchain**.
- Allows:
    - Creation of custom tokens
    - Smart contracts
    - Token transfers using Bitcoin addresses

### üîé Tools to Investigate OMNI Transactions

- Use **Blockchair.com**:
    - Can **visually show** OMNI transactions (e.g., USDT using Bitcoin addresses)
    - Example in **Figure 9.14**
- Also available:
    - **OmniExplorer.com** ‚Äì shows only OMNI transactions

‚û°Ô∏è Tracking OMNI is **similar to Bitcoin** and not overly complex.

---

### Taproot Upgrade (Introduced November 2021)

### üîë Overview

- Most significant Bitcoin upgrade since **SegWit (2017)**
- Introduced a new address format: **Pay-to-Taproot (P2TR)**
    - Taproot addresses start with `**bc1p**`
- Benefits: **Lower fees**, **better privacy**, and **increased smart contract capability**

---

### üîê Privacy & Functionality Improvements

### 1. **Unified Appearance for Transactions**

- All transaction types (simple, multisig, smart contracts) look **identical** on the blockchain.
- Makes it hard to tell transaction type ‚Üí **enhances privacy**

### 2. **Schnorr Signatures**

- Replaces ECDSA with more efficient **Schnorr signatures**
- Enables **signature aggregation** (e.g., multisig appears like single-sig)
- Reduces data size and improves privacy/cost efficiency

### 3. **Conditional Transactions**

- Only the **executed condition** of a smart contract is revealed.
- Other possible conditions remain **hidden**, boosting confidentiality

### 4. **MAST (Merkelized Abstract Syntax Trees)**

- Allows hiding of unexecuted parts of a contract
- Only shows what was used, keeping unused conditions **private**

### 5. **Reduction in Address Distinction**

- Reduces differences between P2PKH, P2SH, etc.
- Makes it harder for observers to **identify address type or user intention**

---

### üîé Investigative Impact

- Taproot hides the **type of transaction**, not just the participants
- Analysts can only see the **result**, not the conditions or decision logic
- Multisig setups now appear like single-signature transactions

---

### üß† Example Scenario

**Alice, Bob, and Charlie** use a **2-of-3 multisig wallet**:

- **Without Taproot**:
    - Multisig is visibly distinct on the blockchain
    - Investigators can spot every use of the multisig wallet
- **With Taproot**:
    - Multisig appears identical to a normal transaction
    - Investigator can‚Äôt tell it‚Äôs a 2-of-3 multisig
    - Only the **executed condition** is visible (not rejected ones)
    - Transaction looks like a regular single-user transaction

‚û°Ô∏è **Result:** Taproot **obscures transaction logic**, making **investigation and tracing more difficult**

---

---

### The Bitcoin Lightning Network ‚Äì Summary & Investigative Insights

### üßæ Basic Concept (Explained via Bar Tab Analogy)

- **Instead of paying for each transaction on-chain**, users:
    - Open a **channel** (like a bar tab) with deposits.
    - Perform many off-chain transactions, which are simply noted.
    - **Settle the tab later**, recording only the final balance on the blockchain.

### ‚úÖ Benefits

- Faster transactions
- Lower fees
- Increased privacy

---

### üîç Investigative Considerations & Techniques

### ‚ö†Ô∏è Challenges

- Lightning transactions are **off-chain**, making them **harder to trace**.
- Provides **greater privacy** than base layer Bitcoin.
- Only **opening and closing** of channels are recorded on-chain.

### üõ†Ô∏è Investigative Techniques

1. **Node Analysis**
    - Payments are routed through multiple nodes.
    - Investigators running well-connected nodes may **observe some payment flows**.
    - ‚ö†Ô∏è Limited unless controlling significant parts of the network.
2. **Invoice Information**
    - Payments often require invoices generated by the recipient.
    - If investigators gain access to these, they can see **amount, purpose, and timing**.
3. **Channel Opening and Closing**
    - These events are **visible on the Bitcoin blockchain**.
    - Large or frequent changes might indicate suspicious activity.
4. **Timing Analysis**
    - Correlate timing across multiple nodes to infer **transaction flow**.
    - Useful if the investigator operates/monitors multiple nodes.
5. **Cooperative Entities**
    - Work with **vendors, exchanges, or wallet providers** that use Lightning.
    - May reveal information about users and transactions.
6. **Exit Node Monitoring**
    - Watch **nodes where Lightning payments exit** and settle on-chain.
    - Useful for identifying **destination addresses** of off-chain payments.
7. **Backup Data**
    - If investigators gain access to **Lightning node backups**, they can retrieve:
        - Transaction history
        - Routing information

---

### üí° Key Takeaways

- Lightning offers **superior privacy** and scalability over base Bitcoin.
- Nodes only know about their **direct neighbors**, not full payment routes.
- Tracing Lightning transactions requires **more advanced, resource-heavy methods**.
- It‚Äôs **not impossible**, but significantly more difficult than on-chain Bitcoin investigations.

---

# 10. Bitcoin: Investigation Methodology

## Building an Investigation in Bitcoin

### Background

- **Bitcoin** was the first public blockchain and quickly became associated with criminal activity.
- Over time, investigators have become skilled at examining Bitcoin-related crimes.
- However, there's no single, **standard methodology** for crypto investigations‚Äîeach case can differ drastically.

### Key Insight: Crypto Crime ‚â† Blockchain Tracing Alone

- People often assume crypto investigations begin with **blockchain tracing tools**.
- But many cases require **traditional investigative methods**.

### üßµ Example Case

- Victim lost $300,000 in Bitcoin stored in a wallet.
- Funds were moved to a new address and **never moved again**.
- No clues from tracing; required:
    - **Physical evidence** (e.g., wallet left in jacket)
    - **Seed phrase handling**
    - **CCTV and non-digital forensics**
- Shows how **physical theft and human error** still play major roles.

---

### Comparing to Traditional Crime

- Traditional cases (e.g., murder) follow **predictable processes**:
    - Forensics, timelines, identification.
- Crypto cases are **diverse**:
    - Can involve theft, fraud, or crypto **used as payment** in other crimes.
- Standardized, FBI-style crypto investigation procedures are **hard to define**.

---

### Tracing Tools & Methodology

- Tracing on public chains (like Bitcoin) is foundational but:
    - Requires understanding of blockchain mechanics.
    - Open-source tools exist, but **professional tools improve accuracy**.
    - **Budget**, tool access, and **interpretation skills** are critical.

---

### Pattern Recognition & Tool Awareness

- Investigators must:
    - Understand how tools work ‚Äúbehind the scenes‚Äù
    - Recognize patterns and link behaviors

---

### Suggested Resource

- The book _"Investigating Cryptocurrencies"_ (2018) by the author focuses on **Bitcoin investigations**.
- Still relevant for understanding **fundamentals**, even if specific tools have changed.

---

## Address Clustering

### üìå Definition:

- **Address clustering** is the process of grouping cryptocurrency addresses believed to be controlled by the same entity or individual.
- This is inferred using **heuristics** and **analytical techniques** such as:
    - Transaction patterns
    - Shared usage
    - Blockchain metadata

### üß† Purpose of Clustering:

- Helps investigators:
    - Understand **relationships between addresses**
    - **Track the flow of funds**
    - Identify **ownership** and activity patterns
- Enables detection of **larger networks** and **criminal ecosystems**

### üïµÔ∏è‚Äç‚ôÇÔ∏è Example:

- Finding a single address during a device search can lead to discovery of a whole cluster of addresses tied to the suspect.

### üì¶ Types of Clustering Use Cases:

### 1. Ownership Clusters:

- Used in blockchain intelligence tools (e.g., Chainalysis, TRM Labs).
- Groups addresses under a **common owner** (e.g., Binance exchange).
- Useful for:
    - **Investigative value** of suspect-controlled addresses
    - Aggregating **funds sent, received, and held**
    - Uncovering **scale of criminal enterprise**

‚úÖ **Example**:

An address tied to Yunhe Wang had $900, but the cluster revealed **$130 million** in total‚Äîcritical for identifying large-scale crime.

### 2. Cluster-Level Tracing:

- Some tools plot **entire clusters by default** (e.g., Chainalysis).
- Others (e.g., TRM Labs) plot only **single addresses** unless cluster metadata is requested.
- Helps manage **large graphs** and provide a **high-level view** of investigations.

‚ö†Ô∏è **Court Challenges**:

- Courts may prefer **address-specific evidence** over general cluster-level data.
- Like with bank accounts, evidence must show **granular transaction metadata**.

### ‚öñÔ∏è Practical Insight:

- Cluster-level analysis is excellent for insight and scale.
- **For court**, you often need exact transaction paths: from **which address** to **which address**, not just that "X Bitcoin left a cluster."

### üí° Tips for Investigators:

- Don‚Äôt fixate only on tracing; **leverage metadata** (funds in/out, transaction counts).
- Choose tools wisely depending on:
    - Your case needs
    - How you plan to present evidence (in court vs. internal intelligence)

## How to identify Clusters?

Clusters = Groups of addresses believed to be controlled by the **same entity**.

### üîç Co-spend Heuristic

### ü§î What is it?

- A Bitcoin wallet can hold many addresses.
- To make a payment, multiple addresses (each with their own Bitcoin balance) may be used together.
- For example: If you want to spend **6.5 BTC** and have wallets with **1 BTC**, **2 BTC**, and **4 BTC**, you‚Äôll need to use all three.

**Why does this matter?**

- All the input addresses in a transaction are assumed to be controlled by the **same entity** (since the user must have access to the private keys of all inputs to authorize the transaction).

---

### üîç Investigating with Co-spend

Let‚Äôs say you find this Bitcoin address:

==**35GHbYHRaDFgG7ReyWP3L6d7PgggB1itV2**==

- You see it received **1.131 BTC** across **52 transactions**.
- You check a transaction like this:
    
    **TXID**: `46ed5f6da0f2c04d61e718b2d14c87661d1d1f12dec67fd56bcd0140c4decebe`
    
- You find that this address is used **together** with **5 other addresses**:
    - `3FwYUzmNYYAEWg644EiYrJUG3pTCcGzZHw`
    - `3HGkVo45HqhpGrMBaLNhR6AL4zvVAqLZxz`
    - `3GS9UJBfgh1zaau7mXR3FCGC9qY7Lsn61v`
    - `3KpUH5vht9pvGtAuye6onviBedJe51ztn9`
    - `3MU2j7BEzmHyRKcMshGLVUoHu7GUo5UatK`

üëâ Therefore, all these addresses are likely **owned by the same user** or **controlled by the same service**.

---

### üïµÔ∏è Clustering Addresses

ü§î **What can you do with this?**

- You can cluster addresses by:
    1. Looking at which addresses are used together in the **input** of transactions.
    2. Tracing them across other transactions to find more related addresses.
    3. Repeating the process to expand the cluster.

üìä **In Practice**:

- This can be very effective, but time-consuming if done manually.
- When used in commercial tools, this clustering can reveal huge networks.
- In this example, the address **35GHbYH...** is part of a cluster with **nearly 13 million addresses**! üò≤
- That cluster is owned by **OKX**, a major cryptocurrency exchange.

---

### üß† Key Takeaway

Co-spend heuristics help analysts **link Bitcoin addresses** to a common owner by observing **which addresses are co-spent in transactions**.

While powerful, it‚Äôs important to watch out for techniques like **CoinJoin**, which intentionally mix addresses from different users to protect privacy.

  

---

### ü™ôChange Analysis

Whenever someone sends Bitcoin, they often get some change back ‚Äî just like at a store! üõçÔ∏è That change goes to a **change address** (another address owned by the sender).

### Why is this important?

1. üß© **Clustering**:
    
    If we‚Äôre building a cluster of addresses, the **change address gets grouped in**, giving us a fuller picture of who owns what.
    
2. üïµÔ∏è‚Äç‚ôÇÔ∏è **Following the Money**:
    
    If we‚Äôre tracing a suspect‚Äôs transactions and don‚Äôt recognize the change address, we might **mistake it for someone else‚Äôs wallet** and go in circles! üîÑ
    

---

### üß†üõ†Ô∏è How to Spot a Change Address

Sometimes tools like **Blockchair** or commercial blockchain intelligence platforms can do this for you. But it's also helpful to **do it manually** like a pro analyst üßê.

Here are **4 primary methods** you can use:

1. üîπ **Simple Spend / Nominal Spend / Optimal Change**
    
    (This method looks at spending patterns where the exact amount is sent to one address, and the odd leftover goes to the change address.)
    
2. üî∏ **Address Type Analysis**
    
    If the input address is a certain type (like legacy or SegWit), and only one output matches it, that might be your change address!
    
3. üîê **Multisig Analysis**
    
    Multisig (multiple signatures) addresses stand out. If you see a multisig used only in the change output, it‚Äôs likely the sender owns it.
    
4. üî¢ **Round Number Payments**
    
    Humans love round numbers! If one output is a clean amount (e.g. exactly 0.5 BTC) and the other is an odd leftover (e.g. 0.273598 BTC), the round number one is likely going to the **recipient**, and the other is the **change**.
    

---

### ‚ö†Ô∏è Reminder: Don‚Äôt Trust Just One Heuristic!

These techniques are based on patterns and **guesses**, not guarantees. They work best when **multiple methods agree**. üß†‚úÖ

### üí° Nominal Spend

### üíµüîÅ What is Nominal Spend?

The **Nominal Spend** technique helps identify which address in a transaction is the **change address** (the one that sends leftover Bitcoin back to the sender).

üîç Why is this tricky?

- Bitcoin transactions charge **fees based on size** (more addresses = more bytes = more fees).
- Wallets try to **minimize fees** by selecting the **smallest number of inputs** needed to cover the transaction.

‚ö†Ô∏è Odds of having the exact BTC amount + fee?

**100 million to 1** üò≤ ‚Äî so change is _almost always_ involved!

---

### üß†üõ†Ô∏è How Nominal Spend Works

üí° Wallets use:

- As few inputs as possible.
- Just enough to pay what‚Äôs needed.

üëâ **Heuristic trick**:

Ask this ‚Üí _‚ÄúAre all the inputs needed to pay the biggest output?‚Äù_

If YES ‚û°Ô∏è That output is probably the **real payment**

If NO ‚û°Ô∏è The smaller output is likely **change** ü™ô

---

### üß™ Real Example 1

TXID:

`ac7e855d06a7a1d1b0fe4000bf11feea6e1fee44e18675549ec696e766581244`

**Inputs** (all from same address):

- 0.03183296 BTC
- 0.00304770 BTC
- 0.49107418 BTC

**Outputs**:

- `3PtJ3K...` ‚Üí 0.51884135 BTC
- `bc1qsy...` ‚Üí 0.00642224 BTC

ü§ì Analysis:

- You only need _two_ of the inputs to pay 0.00642224.
- But you need **all three** to pay 0.51884135.

‚úÖ So...

üßæ `3PtJ3K...` is the payment

üí∞ `bc1qsy...` is the change!

---

### üß™ Real Example 2

TXID:

`03ba36a19bb7cb3ede88dd4cca78a9bed380524c8995a6a910e98f944ee91053`

**Inputs**:

- 1.00000000 BTC
- 0.99951167 BTC
- 0.78960600 BTC

**Outputs**:

- `19Gmgg...` ‚Üí 0.78856700 BTC
- `1PsKxK...` ‚Üí 2.00000000 BTC

ü§ì Analysis:

- Any individual input could almost cover 0.78856700.
- But you need **all three** to reach 2.0 BTC.

‚úÖ So...

üßæ `1PsKxK...` is the payment

üí∞ `19Gmgg...` is the change!

---

### üéØ Why Does This Matter?

1. üß© You can **cluster the change address** with the sender's inputs.
2. üß≠ You can **follow the money accurately** instead of going in loops!

---

Want to test yourself with more TXIDs or get help using tools like **OXT**, **Blockchair**, or **Mempool.space**? I got your back! üöÄüí°

### üî†üì¨ Address Type Analysis

When you create a Bitcoin wallet, it follows a standard (called **BIP**) that decides how your addresses are formatted.

These can look like:

- `1...` ‚Üí Legacy
- `3...` ‚Üí P2SH (Pay-to-Script-Hash)
- `bc1...` ‚Üí Bech32 (SegWit)

üí° **Fun fact**: Wallets usually generate **change addresses** using the **same format** as their inputs.

---

### üß™ Example Time!

From an earlier example:

**Inputs**:

- All start with `bc1...` ‚úÖ
    
    This suggests the wallet is using **Bech32 (SegWit)**.
    

**Outputs**:

- `3PtJ3K...` (starts with **3**) ‚Üí P2SH
- `bc1qsy...` (starts with **bc1**) ‚Üí Bech32

üîç So, which one is the change?

- Since all **inputs** are `bc1...`, the **change** is most likely also a `bc1...` address.
- Therefore, the **payment** is `3PtJ3K...` and the **change** is `bc1qsy...`.

---

### ‚úÖ Why This Helps

Using **address type analysis** can:

1. üß† Boost confidence in your conclusion when **combined with another method** like **Nominal Spend**.
2. ‚öñÔ∏è Be useful in legal/forensic cases, especially when needing strong evidence.

üìå **Tip**: One heuristic (like nominal spend) can be questioned, but when **multiple heuristics agree**, it strengthens your analysis like a well-backed detective case! üïµÔ∏è‚Äç‚ôÄÔ∏èüîéüìö

---

### üõ°Ô∏è Multisig Analysis üîêüîç

### üîê What is a Multisig Wallet?

A **multisig (multi-signature) wallet** needs **multiple private keys** to approve a transaction.

It‚Äôs like needing multiple keys to open a safe! üßë‚Äçüîßüîëüîë

üí° Example:

A wallet may be configured as **2-of-3**, meaning:

- 3 people have keys.
- Any **2** of them are enough to sign and send Bitcoin.

This increases security and reduces the risk of losing funds forever.

---

### üß† How Multisig Helps in Analysis

If the **inputs** of a transaction are from a **multisig 2/3 wallet**, and one of the **outputs** is also a multisig 2/3 address, it's likely that output is the **change address**.

That‚Äôs because wallets usually return change to the **same type of wallet** it came from.

---

### üì∏ Real Example (Figure 10.1)

![[/image 16 2.png|image 16 2.png]]

**Inputs:**

- Two addresses, both labeled **MULTISIG 2/3**
    - 4.35825002 BTC
    - 5.99957097 BTC

**Outputs:**

- `bc1q7ppp...` ‚Üí 0.05772516 BTC (also **MULTISIG 2/3** & tagged as **Change** üü®)
- `bc1qmh...` ‚Üí 10.3 BTC (not multisig)

üîç Here's the magic:

- Both inputs are **required** to make the big payment of 10.3 BTC.
- But either input alone could have easily paid the smaller 0.0577 BTC.

‚úÖ Conclusion:

- `**bc1qmh...**` is the **payment address** üßæ
- `**bc1q7ppp...**` is the **change address** üí∞

---

### üß© Bonus: Cross-Confirm with Other Heuristics!

You couldn‚Äôt use **address type analysis** here because both outputs are `bc1...`.

But guess what? The **Multisig Tag + Value Analysis** BOTH pointed to the same conclusion. üéØ

This combo gives us high confidence in our findings ‚Äî perfect for forensics or court cases ‚öñÔ∏èüë®‚Äç‚öñÔ∏è

---

### üî¢üéØ Round Number Payments

This one‚Äôs simple and surprisingly powerful!

**Ask yourself**:

üëâ _‚ÄúIs one of the outputs a nice, clean number?‚Äù_

Humans LOVE round numbers. Whether it‚Äôs for convenience or psychology, most people (including scammers üïµÔ∏è‚Äç‚ôÇÔ∏èüí∞) don‚Äôt send awkward values like `0.24736589 BTC`.

Instead, they go for:

- **0.1 BTC**
- **0.5 BTC**
- **1 BTC**
- **2 BTC**
    
    Easy. Clean. Memorable. ‚úÖ
    

---

### üß™ Real-World Example

**Inputs:**

- 1.00000000 BTC
- 0.99951167 BTC
- 0.78960600 BTC

**Outputs:**

- `1PsKxKt...` ‚Üí **2.00000000 BTC** üí∞
- `19GmggCh...` ‚Üí **0.78856700 BTC**

üéØ See it?

- 2 BTC is a **perfect round number**.
- The other output is a weird leftover amount.

**Conclusion:**

- üßæ `1PsKxKt...` is the **payment address**
- üí∞ `19GmggCh...` is the **change address**

---

### üß† Why This Works

The odds of Bitcoin + transaction fee magically resulting in a perfect number like 2.00000000 BTC are **100 million to 1**! ü§Ø

So if you spot a round number, it‚Äôs almost certainly the **intended payment**, and the quirky leftover is the **change**.

---

### üß© Bonus Tip

When this heuristic lines up with:

- Nominal Spend üîç
- Address Type Analysis üî°
- Multisig Detection üîê

You‚Äôve got a rock-solid case for identifying **which address is which**. Perfect for blockchain forensics üßë‚Äçüíªüìä or court-ready evidence ‚öñÔ∏è

### üìö Final Summary of All Four Methods:

|   |   |
|---|---|
|**Method**|**What It Looks At**|
|**1. Nominal Spend**|Inputs required to cover outputs. Change needs fewer inputs; payment needs more.|
|**2. Address Type**|Change address usually matches input address type (e.g., all bc1 or all 1).|
|**3. Multisig Analysis**|Change address is likely the same multisig type as the input (e.g., 2-of-3).|
|**4. Round Numbers**|Payments are often neat values (e.g., 1 BTC), while change is messy decimals.|

  

## Other Clues for Identifying Change & Payment Addresses

### ‚úÖ Additional Hints:

- **Same Input = Same Change**: Some wallets reuse the same address for change. Be careful‚Äîit can be easy to miss.
- **Vanity Addresses**: Sometimes addresses include recognizable strings (e.g., `EHxYK`) that hint at ownership.
- **Blockchain Explorers Help**: Tools like [Blockchair](https://blockchair.com/) try to identify change for you, but **always verify manually**‚Äîespecially for court or investigative purposes.

---

### üîÅüëõ Change of Wallet

Just because you see BTC move from a **"1" address to a "3"** or a **"bc1"**, it doesn't always mean ownership has changed. The user may simply be **moving funds to another one of their own wallets** ‚Äî especially if there's **no change** in the transaction.

### üîç Clues it‚Äôs just a wallet move:

- Round numbers are used (like 0.3 BTC instead of 0.35676523).
- All funds are cleared from the wallet.
- There‚Äôs **only one output** and **no change**.

### üí° Example Transaction

**Inputs:** 5 addresses with small amounts

**Output:** 1 address with the exact sum = 0.01084202 BTC

‚úÖ Likely just moving everything to a new wallet the user controls.

---

### üè¶üè∑Ô∏è Exchange Deposit Patterns (Many to One)

When users send funds **to an exchange**, the deposit:

- Usually has **1 output**.
- Is often followed by **many other deposits going to the same output**.

üß† Example TXID:

`0fef4aae322eeb...`

üîé 60 inputs ‚Üí 1 output

üëÄ That output is owned by **Binance** (confirmed using blockchain intelligence tools).

---

### üí∏ Withdrawal Patterns (One to Many)

On the flip side...

When exchanges send funds **out**, you'll often see:

- 1 input address
- LOTS of outputs going to different addresses

üß† Example TXID:

`27b3360e96c7785a...`

üëÅÔ∏è Input = Exchange (Binance)

üì§ Outputs = 20 different addresses

---

### üß≠ When to Stop Tracing: The 3-Hop Rule üö¶

When you're tracing a suspect‚Äôs funds...

> "How many blind hops should I take before I stop?"

üìå Use this rule:

**If you trace 3 transactions forward and still don‚Äôt know who owns the address, it‚Äôs probably changed hands.**

No ownership info?

No attribution in a tool?

‚Üí Time to pause and reassess.

---

### üåÄüßä What About Mixers?

If you hit a **mixer**, things get complicated fast:

üåÄ Mixers mix many users‚Äô funds to obscure their paths.

üí• Patterns include:

- Coin splitting & recombining
- Peel chains (sending small amounts repeatedly)
- Endless loops to confuse trackers

üîí **Not covered in this book**, but just know that **mixers ‚â† wallet changes** ‚Äî they‚Äôre deliberate privacy tools.

---

### üîÑ Three-Hop Rule (üí° Pro Tip)

- When tracking a suspect‚Äôs funds, don‚Äôt blindly follow forever.
- Use a **"three-hop rule"**:
    - Follow **up to three transactions**.
    - If you can‚Äôt confirm ownership or see a clear purpose, stop and try another direction.

---

### üåÄ Mixers vs Peel Chains

|   |   |
|---|---|
|**Type**|**How it works**|
|**Mixers**|Combine coins from **multiple users** to break the transaction trail.|
|**Peel Chains**|Send a **small portion** (e.g., to exchange), return rest as change, and repeat.|

- **Mixers** = **Advanced obfuscation**
- **Peel chains** = Used in fraud, laundering, and ransomware

---

### ü©∫ Address Triage: Investigative Efficiency Over Complexity

### ‚ùóWhy Simplicity Matters

- Investigations **shouldn't just trace every hop endlessly**.
- Overly complex graphs (e.g., 700+ transactions) may look impressive but **fail to communicate useful intelligence**.
- The **best graphs** are often the **simplest** ones‚Äîfocused, relevant, and understandable to others (like in court).

---

### üîç What Is Address Triage?

Before diving into tracing:

- **Pause and assess** the address.
- Triage involves asking **key investigative questions**:
    - **When** did this address first and last appear?
    - Does it match the **timeframe** of a known scam?
    - Are the **amounts** similar to scam requests (e.g., 0.1 BTC or 0.3 BTC)?
    - Are there many **small inbound transactions** (possibly victims)?
    - Does it match known patterns like **ransomware**, **pig butchering**, or **vanity usage**?

Doing this allows you to:

- Prioritize important leads.
- Avoid wasting time tracing meaningless data.
- Spot **likely victim addresses** or **clustered wallets** faster.

---

### üìä Making the Most of Your Tools

### ‚úÖ If You Have a Blockchain Intelligence Tool:

- Use it to visualize flow, cluster addresses, and assess average transaction values over time.
- These tools often **highlight patterns** that support your manual observations.

### üõ†Ô∏è If You Don‚Äôt Have a Tool:

- Use **blockchain explorer APIs** (e.g., Blockchair API: [https://blockchair.com/api/docs](https://blockchair.com/api/docs))
- Export **CSV** or **JSON** data for analysis in:
    - Excel
    - Python (via PyCharm)
    - ChatGPT (yes, you can give me your exported data!)

---

### üß† Python-Based Address Triage Tool (via ChatGPT)

### üß© **What It Does:**

1. **Reads raw data** from a CSV-style transaction log (e.g., from Blockchair).
2. **Parses and processes timestamps** into:
    - `Date`
    - `Time`
    - `Hour` (for time-of-day analysis)
3. **Generates Visualizations**:
    - üìä Transaction **counts per day**
    - üïí Distribution of transactions **by hour**
    - üí∞ Transaction **values in BTC and USD**
4. **Prints summary stats**:
    - Mean, min, max, count, etc. ‚Äî useful for quick detection of outliers or bulk payments.

---

### ‚úÖ **Why It‚Äôs Useful:**

- Helps you **triage an address**:
    - Is it part of a scam?
    - Do values match victim reports?
    - Was it only active in a narrow timeframe?
- Gives a **visual context** to how a wallet is being used before you even trace a single transaction.

---

### üîß Bonus Tips:

- You can **replace** `**StringIO(data)**` with `pd.read_csv('yourfile.csv')` if working with real files.
- Want to scale this up? Connect it to an **API** like:
    - [Blockchair API](https://blockchair.com/api/docs)
    - Chainalysis, CipherTrace, Elliptic (if you have access)
- Use tools like **PyCharm** or **Jupyter Notebooks** to test and adapt this code easily.

---

### üß™ Address Triage Code (Explained)

### üßë‚Äçüíª Code Sample

````Python
Sure! Here's the full code without explanation, ready to copy and use:

```python
import pandas as pd
from io import StringIO
import matplotlib.pyplot as plt
import seaborn as sns

# Sample data as provided by the user
data = """
Transactions number,Affected address/xpub,Effect,Ticker,Amount fiat (USD),Asset rate (USD),Date/Time,Transaction hash
1,1La7LPC9U9WSRL2nhKCMMU2nUFb65YMGCj,0.0066645,BTC,441.22,66185.21,2024-06-17 21:36:07,a31a28e53b609f2d0db02d3d4609876ba0bacc3603b93b4b3acf2ea006645b7
2,1La7LPC9U9WSRL2nhKCMMU2nUFb65YMGCj,0.0001929,BTC,12.77,66185.21,2024-06-17 21:26:20,93880d1f731a2f8f9bf3d7a8b56be5522a5fe49d5a90ecf3aa924bd765a1b9
3,1La7LPC9U9WSRL2nhKCMMU2nUFb65YMGCj,0.00105143,BTC,69.59,66185.21,2024-06-17 21:26:20,43a673d6158849b793d697487fa3b619b0b268f8111955d53c2a8df0588527ab
4,1La7LPC9U9WSRL2nhKCMMU2nUFb65YMGCj,0.00378036,BTC,250.0,66185.21,2024-06-17 20:16:20,63e7012ee96c72946e6d162a2ceff30c390ea90dca4d59902155e23f7bfb6c7d
5,1La7LPC9U9WSRL2nhKCMMU2nUFb65YMGCj,0.00008311,BTC,5.50,66185.21,2024-06-17 19:38:10,b9d1619309ab553492f7e0b2a189ec8b51164958937a004d97042dcbhbc1533c
"""

# Read the sample data into a DataFrame
df = pd.read_csv(StringIO(data))

# Convert Date/Time to datetime
df['Date/Time'] = pd.to_datetime(df['Date/Time'])

# Create additional columns for analysis
df['Date'] = df['Date/Time'].dt.date
df['Time'] = df['Date/Time'].dt.time
df['Hour'] = df['Date/Time'].dt.hour

# Plot transaction counts over time
plt.figure(figsize=(10, 6))
df.groupby('Date').size().plot(kind='bar', title='Transaction Counts Over Time')
plt.xlabel('Date')
plt.ylabel('Number of Transactions')
plt.xticks(rotation=45)

# Plot distribution of transactions by time of day
plt.figure(figsize=(10, 6))
sns.histplot(df['Hour'], bins=24, kde=False)
plt.title('Distribution of Transactions by Hour of Day')
plt.xlabel('Hour of Day')
plt.ylabel('Number of Transactions')
plt.xticks(range(0, 24))

# Plot value of transactions in BTC
plt.figure(figsize=(10, 6))
df.plot(kind='bar', x='Date/Time', y='Effect', title='Value of Transactions in BTC', color='blue')
plt.xlabel('Date/Time')
plt.ylabel('Value (BTC)')
plt.xticks(rotation=45)

# Plot value of transactions in USD
plt.figure(figsize=(10, 6))
df.plot(kind='bar', x='Date/Time', y='Amount fiat (USD)', title='Value of Transactions in USD', color='green')
plt.xlabel('Date/Time')
plt.ylabel('Value (USD)')
plt.xticks(rotation=45)

# Adjust layout and show plots
plt.tight_layout()
plt.show()

# Display summary statistics for additional insights
summary_stats = df.describe()
print(summary_stats)
``` 

Let me know if you want the same structure but loading from a real `.csv` file or using a real API.
````

### üîπ **Step 1: Import Required Libraries**

These are Python libraries used for data handling and visualization.

```Python
import pandas as pd                 # Data manipulation
from io import StringIO             # Allows reading string data as if it were a file
import matplotlib.pyplot as plt     # Plotting graphs
import seaborn as sns               # Advanced statistical visualization
```

---

### üîπ **Step 2: Sample Data Input**

You'd typically replace this with data from Blockchair (or CSV/API).

```Python
# Sample data
data = """
Transactions number,Affected address/xpub,Effect,Ticker,Amount fiat (USD),Asset rate (USD),Date/Time,Transaction hash
1,1La7LPC9U9WSRL2nhKC...
"""
```

In practice, use this instead:

```Python
df = pd.read_csv("your_blockchair_export.csv")
```

---

### üîπ **Step 3: Load Data into DataFrame**

```Python
df = pd.read_csv(StringIO(data))  # For test/demo use
```

---

### üîπ **Step 4: Process the Date/Time Column**

Split full timestamp into components for better filtering and grouping.

```Python
df['Date/Time'] = pd.to_datetime(df['Date/Time'])
df['Date'] = df['Date/Time'].dt.date
df['Time'] = df['Date/Time'].dt.time
df['Hour'] = df['Date/Time'].dt.hour
```

---

### üîπ **Step 5: Plot Transaction Volume Over Time**

This helps identify periods of activity (scam peak, wallet dumping, etc.)

```Python
plt.figure(figsize=(10, 6))
df.groupby('Date').size().plot(kind='bar', title='Transaction Counts Over Time')
plt.xlabel('Date')
plt.ylabel('Number of Transactions')
plt.xticks(rotation=45)
# plt.show()
```

---

### üîπ **Step 6: Plot Time-of-Day Distribution**

Helps spot behavioral patterns (e.g., fraud bursts at certain hours).

```Python
plt.figure(figsize=(10, 6))
sns.histplot(df['Hour'], bins=24, kde=False)
plt.title('Distribution of Transactions by Hour of Day')
plt.xlabel('Hour of Day')
plt.ylabel('Number of Transactions')
plt.xticks(range(0, 24))
# plt.show()
```

---

### üîπ **Step 7: Plot Value of Transactions in BTC**

Looks for clusters of transaction amounts (small peel chains, ransom demands, etc.).

```Python
plt.figure(figsize=(10, 6))
df.plot(kind='bar', x='Date/Time', y='Effect', title='Value of Transactions in BTC', color='blue')
plt.xlabel('Date/Time')
plt.ylabel('Value (BTC)')
plt.xticks(rotation=45)
# plt.show()
```

---

### üîπ **Step 8: Plot Value of Transactions in USD**

If USD values are included, this is useful for victim loss calculations.

```Python
plt.figure(figsize=(10, 6))
df.plot(kind='bar', x='Date/Time', y='Amount fiat (USD)', title='Value of Transactions in USD', color='green')
plt.xlabel('Date/Time')
plt.ylabel('Value (USD)')
plt.xticks(rotation=45)
# plt.show()
```

---

### üîπ **Step 9: Clean Layout + Display Summary Stats**

```Python
plt.tight_layout()
plt.show()

# Show summary statistics (count, mean, min, max, etc.)
summary_stats = df.describe()
print(summary_stats)
```

---

## ‚úÖ **What This Code Helps You Do**

- Triage a wallet before full tracing.
- Spot suspicious behavior patterns:
    - Time of day
    - Transaction bursts
    - Value anomalies
- Identify likely scam patterns like:
    - Small regular inputs (victims)
    - High-value outputs (laundering, payout)
    - Repeating round number payments

---

Would you like this code turned into a downloadable `.py` file, Jupyter notebook, or PDF cheat sheet with notes?

---

### ‚òÑÔ∏èAttribution

One of the main benefits of using commercial blockchain intelligence tools like **TRM**, **Chainalysis**, or **Elliptic** is **access to their attribution databases**. These databases help investigators identify and cluster addresses, associating them with specific entities or services.

- These companies invest heavily (millions of dollars) to cluster addresses and infer ownership using:
    - **Test spends**
    - **Open-source intel**
    - **Court/government records**
    - **Other proprietary heuristics**

### Free or Low-Cost Options:

If you don't have access to these premium tools, you can try:

- **[WalletExplorer](http://walletexplorer.com/)** ‚Äî a free tool that groups addresses by entity.
- **[Breadcrumbs](http://breadcrumbs.app/)** ‚Äî offers attribution with a free option and a solid address database.

Let me know if you'd like a comparison between the free tools or a deeper dive into how attribution works!

# 11. The Workings of Ethereum and Derivatives

## History of the Ethereum Cryptocurrency

### üß†üíª Getting Hands-On with Ethereum

- This chapter gives you real Ethereum addresses to play with üß™ ‚Äî so grab a computer, open Etherscan.io, and explore the blockchain yourself!
- Typing long addresses = üòµ‚Äçüí´. If you're on an iPhone üì±, just use the camera's text scanner to copy/paste directly into your browser. Easy-peasy.

---

### ‚öîÔ∏è Ethereum vs. Bitcoin: The Showdown

- Bitcoin‚Äôs been the criminal king üëë for years, but Ethereum is now stealing the spotlight in most investigations üîç.
- **Bitcoin** = no balance, just inputs/outputs. It's like using exact cash and getting change ü™ô.
- **Ethereum** = balance-based, like a bank account üè¶. You send the exact amount, no change involved!

---

### üìú The Epic Tale of Ethereum

- Created by the genius **Vitalik Buterin** in 2013 üß†.
- He dreamed of a platform for smart contracts ü§ñ and decentralized apps (dApps).
- Officially launched in **July 2015** as ‚ÄúFrontier‚Äù üöÄ.
- Raised a cool **$18 million** during the 2014 crowdsale üí∞.

---

### ‚öôÔ∏è From ETH 1.0 to 2.0 ‚Äì Level Up! üéÆ

- Ethereum‚Äôs had MAJOR upgrades to boost scalability, security, and speed ‚ö°.
- September 2022 brought **Ethereum 2.0** ‚Äì the big switch from PoW to PoS ‚ôªÔ∏è.
- Result: Less energy use, faster transactions, and a more sustainable future üå±.

---

### üï≥Ô∏è The Mysterious 0x00...000 Address

- Ever seen an address full of zeros? That's the **Genesis Address**, aka the **Black Hole**, **Null address**, or just `0‚Å¥‚Å∞` üï≥Ô∏è.
- Coins sent here are **gone forever** ‚Äî think of it like tossing tokens into a fire pit üî•.
- Sometimes used in crypto bridges with a system called **Mint and Burn** üîÑ.

---

### üßô‚Äç‚ôÇÔ∏è Create Your Own Address with Style ‚ú®

- Ethereum addresses start with `0x` and are 42 characters long üò≤.
- Want one that ends with your initials (like `ABC`)? Use a **vanity address generator**! üß©
- Super cool, but pro tip: run the generator **offline** for safety üõ°Ô∏è.

---

### üïµÔ∏è‚Äç‚ôÄÔ∏è Investigator Pro Tips: ETH vs BTC

- Ethereum = balance-based, no change üí∏.
- Bitcoin = trackable amounts split and merged like a money puzzle üß©.
- Example: 0.2 ETH sent to a scammer just **adds** to their balance. No change, no trace. üîé

---

### üö® Watch Out! Not Every Address Is a Villain

- In 2022, **Tornado Cash** got banned üò±. Any wallet receiving funds from it was flagged.
- Mischievous pranksters sent ETH through Tornado Cash to famous people like Jimmy Fallon and Coinbase‚Äôs CEO... just to get them blacklisted! ü§¶‚Äç‚ôÇÔ∏è

---

### ‚õìÔ∏è Ethereum: The Techy Stuff

- Ethereum blocks are mined about **every 12 seconds** ‚è±Ô∏è using **proof-of-stake**.
- Smart contracts are like mini-programs on the blockchain ‚Äî they make dApps and DeFi magic possible ‚ú®üîó.
- Bitcoin = old-school block-by-block. Ethereum = programmable, upgradeable, and future-ready üöÄ.

  

## ü™ôTypes of Tokens in the Crypto World

- In crypto, **tokens** are built **on top of existing blockchains**, often using **smart contracts** ü§ñ.
- We don‚Äôt usually call Bitcoin or ETH a token (but we technically could!) üß†
- To trade a token, you still need the blockchain‚Äôs native coin to pay transaction fees:
    - Want to trade Tether on Bitcoin? You‚Äôll need **BTC** ü™ô
    - Want to trade stETH on Ethereum? You‚Äôll need **ETH** ‚öôÔ∏è

### üìú Ethereum Token Standards (aka "ERCs")

Ethereum uses standards called **ERCs** (Ethereum Request for Comments), like how Bitcoin uses BIPs. These define how tokens behave. üß¨

üîó For more details, check: [https://eips.ethereum.org/erc](https://eips.ethereum.org/erc)

### ‚ú® Most Common ERC Token Standards:

- **üîÅ ERC-20**: Fungible tokens like DAI, USDC ‚Äî same and swappable üí∏
- **üñºÔ∏è ERC-721**: Non-fungible tokens (NFTs). Unique items like digital art or game collectibles üé®üéÆ
- **üé≠ ERC-1155**: Hybrid ‚Äî can handle both fungible and non-fungible tokens. Great for games or artists releasing limited series üíé

---

### üß™ Other Interesting ERC Standards:

- **üîß ERC-777**: Adds more flexibility to ERC-20. Supports custom behaviors during transfers (great for developers) üë®‚Äçüíª
- **üè† ERC-1400**: Designed for **security tokens** like stocks or real estate üè¶. Includes rules for compliance and investor protection.

---

### üßÆ A Note on ETH Values & Time

- 1 **ETH** = üí∞ but underneath it lies a tiny unit called **Wei**.
- 1 ETH = **1,000,000,000,000,000,000 Wei (10¬π‚Å∏)** ‚Äî that‚Äôs a **quintillion**! ü§Ø
- **Gwei** is often used for gas fees:  
    üí° 1 Gwei = 1,000,000,000 Wei (10‚Åπ)

---

### üïí How Ethereum Handles Time

- Ethereum **doesn‚Äôt timestamp individual transactions** ‚åõ
- Instead, it uses the **block timestamp** (when the block was mined ‚õèÔ∏è)
- Time is recorded in **UNIX time** ‚Äî seconds since Jan 1, 1970 üìÜ
- This method keeps things **consistent** across the network!

---

## Ethereum Transaction Types

All Ethereum transactions fall into **two main categories**:

1. **üí∏ ETH (Ether) Transactions** ‚Äì Straight-up value transfer.
2. **üìú Contract Transactions** ‚Äì Smart contract interactions (not always token-related!).

### ‚õΩ ETH Is the Fuel!

- Every transaction, no matter what it does, **requires ETH to pay gas fees**.
- This is üîë for investigators ‚Äî if someone‚Äôs using Ethereum, they had to **acquire ETH** from somewhere. That means there‚Äôs a **trail** (think: exchanges with KYC info üßæ).
- **ETH isn‚Äôt a token.** To trade it as one, it must be wrapped into **WETH (Wrapped ETH)** üéÅ.

---

### üö® MAKE SURE YOU HAVE ETH!

- When seizing crypto from a suspect‚Äôs wallet, **NEVER seize the ETH first**! üò¨
- Why? You‚Äôll need ETH to move any tokens out ‚Äî no ETH = stuck tokens üß∑
- Always seize tokens first, **then the ETH**. Even criminals and officers have made this mistake! üòÖ

---

### ü™ô ETH vs. Contract Transactions

- ETH ‚Üí ETH transfers = **primary transactions** ‚úÖ
- All other types = **contract transactions** ‚Äì which just means smart contracts are doing the magic üßô‚Äç‚ôÇÔ∏è‚ú®
- These contracts can do _a lot_ ‚Äì from moving tokens to running entire apps.

---

### üß† Smart Contract Magic

Smart contracts = auto-executing code that does things like:

- üé® NFT creation (ERC-721, ERC-1155)
- üé≤ Blockchain-based gambling
- üè¶ DeFi & DEXs (Decentralized Exchanges)

They open a world of complex actions, but always run on top of Ethereum.

---

### üï≥Ô∏è Internal Transactions (a sneaky extra type!)

- These don‚Äôt come from users, have no signature, and **aren‚Äôt shown on-chain directly** ü´£
- They‚Äôre the result of smart contracts calling other contracts or doing transfers behind the scenes ü§ñ

---

### üßë‚Äçüíª EOAs (Externally Owned Accounts)

- Every user wallet = an **EOA**
- Controlled with a private key üîê
- EOAs can send ETH or trigger contracts
- **EOA ‚û°Ô∏è EOA transfers** = Ethereum‚Äôs simplest transaction to trace üîç

---

### üíµ What Are Stablecoins?

- **Stablecoins** are tokens (usually ERC-20) whose value is **pegged to a fiat currency** (most often the **U.S. dollar** üí≤).
- The idea: **1 stablecoin = $1** ‚Äî unlike other crypto tokens, which can swing wildly in value üé¢.
- They‚Äôre used to keep value steady in crypto wallets and trades.

## üïµÔ∏è‚Äç‚ôÄÔ∏è Tracing Stablecoins = Just Like Tokens

You can trace stablecoins **just like any other token** on the Ethereum blockchain.

### ‚ú® Examples of Stablecoins:

- **USDT** ‚Äì Tether (also lives on Bitcoin via OMNI)
- **USDC** ‚Äì From Circle and Coinbase
- **DAI** ‚Äì Backed by smart contracts via MakerDAO ü§ñ
- **BUSD** ‚Äì Binance‚Äôs stablecoin

---

## ‚ö†Ô∏è But Are They _Really_ Stable?

Don't let the name fool you! ü§î

Just because it‚Äôs called a ‚Äústable‚Äù coin doesn‚Äôt mean it's bulletproof.

- Stability is **supposed** to come from real-world assets backing the coin üìä
- BUT... there have been serious **questions** about whether those assets **actually exist** üò¨

---

### üö® Real-Life Disaster: Terra UST Crash

- In May 2022, the **Terra (UST)** and **Luna** projects **collapsed** üò±
- $45 **billion** lost in just 72 hours ‚Äî a whopping **99.9% value drop** üí£üíî

---

## üìö Want to Dive Deeper?

Check out this great explainer from the Richmond Fed:  
üëâ [Stablecoins and How They Can Fail](https://www.richmondfed.org/publications/research/economic_brief/2022/eb_22-24)

---

## One Address for All Tokens

- A **single Ethereum wallet address** (EOA) can hold both **ETH** and **any tokens** (like NFTs, stablecoins, gaming tokens, etc.).
- That‚Äôs right ‚Äî **one address, multiple assets (Tokens)!** üß∫

---

### üìå Don't Forget to Check Everything

When investigating a wallet:

- ‚úÖ Check the **ETH balance** (you always need ETH to make transactions!)
- ‚úÖ Check the **token holdings** (these could hold the real value üí∏)

> üîé Many investigators forget to check the tokens, which could be worth way more than the ETH sitting there!

---

### üîó Use Etherscan (and Friends!)

- **[Etherscan.io](https://etherscan.io/)** is your best friend for Ethereum investigations üë®‚Äçüíª
- Prefer to see the **raw data**? Etherscan lets you peek under the hood with transaction history, tokens, and more üßæ
- Other tools: [blockchair.com](https://blockchair.com/) can be handy too üß†

---

### üìä Example Breakdown (Figure 11.4)

- 0xBBE8dFF69082174d04F74B55b1f65a90dC4194FE
- ETH Balance: **0.007 ETH** (~$16.51 at the time)
- Token Holdings: **$491.23** (üí• way more than the ETH!)
- Always click that **drop-down box** to reveal token details! ü™Ñ

---

### üß† A Token Isn‚Äôt Always What It Seems‚Ä¶

In this case:

- Token name: **MAVIA**
- Associated with a game called **Heroes of Mavia** üéÆ
- Just because a wallet holds a token doesn't mean the owner bought it!
    - üì® Tokens can be sent without permission (so don‚Äôt jump to conclusions!)
    - Always **research the token** before assuming wrongdoing üë©‚Äç‚öñÔ∏è

---

### üßæ The Takeaway

- One Ethereum address (EOA) can hold **multiple token types** and **ETH**.
- Always check both.
- Be cautious about assuming ownership or intent just based on token presence üïµÔ∏è‚Äç‚ôÇÔ∏è

---

  

## Same Address, Different Chains?

Yes ‚Äî it‚Äôs true! ‚úÖ

If someone owns an Ethereum address (and its private key üîê), **that same address can exist on other blockchains** too.

> üîÅ The same address on other blockchains will be owned by the same person.

This is a **MUST-KNOW üî•** for investigators:

- If we miss this, we might miss **hidden assets** or **proceeds of crime**.

---

### üîÑ Example in Action:

üìå Address: `0x3a194c54985D77896b02Ac608D6223F96bec279A`

- On **Etherscan**, you‚Äôll see ETH + 5 tokens on the Ethereum mainnet.
- But if you click the **Multichain Portfolio** button, you‚Äôll see more holdings on other chains ‚Äî like **Base** (a Layer 2 network built by Coinbase).

---

### üß≠ Use BaseScan (or other explorers)

üîç Go to: [https://basescan.org](https://basescan.org/)

Paste in the **same address**!

You‚Äôll find:

- ETH (maybe a different amount)
- 7 other tokens (different from mainnet holdings!)

üì¢ These **must be evaluated separately** ‚Äî each chain has its own balances and tokens!

---

### üíº Investigator Tip

When investigating Ethereum wallets, **ALWAYS check other chains**:

- ‚úÖ Binance Smart Chain (BSC)
- ‚úÖ Base
- ‚úÖ Polygon
- ‚úÖ Arbitrum
- ‚úÖ Avalanche
- ‚úÖ And many others!

Use:

- **Etherscan‚Äôs Multichain Portfolio button**
- Or your commercial blockchain tool of choice

## Reading Basic Transactions on Etherscan

When you search an Ethereum address on **Etherscan.io**, you‚Äôll get a list of all its transactions. Each transaction comes with key fields that help you understand **what‚Äôs happening and who‚Äôs involved**. Let‚Äôs break it down! üëá

![[/image 17 2.png|image 17 2.png]]

---

### üß© Key Fields You‚Äôll See:

- **üîÑ Type of Transaction**
    - Example: ETH transfer between wallets.
- **üÜî TXID (Transaction ID)**
    - A unique fingerprint for each transaction üß¨
- **‚õèÔ∏è Block Number**
    - Shows which block the transaction was added to (e.g., Block `19162667`)
- **‚è∞ Date & Time**
    - Pro tip: Click ‚ÄúAge‚Äù in Etherscan to switch between time formats! üïí
- **üì§ From Address**
    - Where the ETH is being sent from
- **üì• To Address**
    - Where the ETH is being sent to
- **üìä Direction**
    - Is this an **inbound** or **outbound** transaction for the address you searched?
- **üí∞ ETH Amount**
    - How much ETH was moved
- **üí∏ Fee**
    - Not always visible in the summary, but it‚Äôs there (and it‚Äôs paid in ETH!)

---

### üïµÔ∏è Why This Info Matters

Once you understand these fields, you can:

- üìÖ See **when** an address was first used
- üë£ Track its **transaction history**
- üëØ Identify who they‚Äôre interacting with
- üß† Understand what kind of activities (or patterns) the address is involved in

## Transaction Methods 101 üßæ‚ú®

Not all Ethereum transactions are just about moving ETH around! While we saw a simple **Transfer** earlier, there‚Äôs a _whole universe_ of transaction methods out there‚Äîand they can tell us a lot about what a user is up to! üöÄüßë‚Äçüíª

---

### üîß So, What Are "Methods"?

In Ethereum, each contract interaction uses a method‚Äîaka a function name. It could be super clear (like `Transfer`), cryptic, or even just a code! üòµ‚Äçüí´ There‚Äôs no master list, so it‚Äôs up to _you_, the investigator, to figure it out. üïµÔ∏è‚Äç‚ôÄÔ∏èüß©

---

### üîç Let‚Äôs Look at Some Real Examples

![[/image 18 2.png|image 18 2.png]]

From **Figure 11.9**, here are a few we might run into:

- **Transfer üîÅ**
    
    A good ol‚Äô ETH-to-ETH transaction‚Äîsimple and straightforward.
    
- **Sell To Uniswap üîÑ**
    
    Looks like the user is trading tokens on **Uniswap**, a decentralized exchange. Could be swapping tokens or setting up trading positions.
    
- **Unstake üå±‚û°Ô∏èüí∞**
    
    Withdrawing crypto that was staked. This user is probably involved in staking/investing.
    
- **Deposit With‚Ä¶ and Create Proxy ü§∑‚Äç‚ôÇÔ∏è**
    
    These names aren‚Äôt very clear‚Äîwe‚Äôd need to dig deeper. But they might be creating a proxy contract or initiating a deposit.
    
- **Buy Token üõçÔ∏è**
    
    As expected, this means the user is buying a token‚Äîmaybe from a presale, like in the example with Mollars.
    

---

### üß† Why This Matters

Tracking these method names can reveal:

- üïπÔ∏è Gaming activity (`Place Bet`, `Withdraw`)
- üí∞ Investing or trading behavior
- üß± Contract interaction patterns

It gives us a glimpse into the _intentions_ behind the transactions, not just the flow of money. Pretty cool, right?

---

### üí• GOING ATOMIC! üí•

Ever heard of **atomic match**?

It‚Äôs a method you‚Äôll sometimes see, especially in decentralized exchanges (DEXs). Here‚Äôs the deal:

- **Atomic Match ‚öõÔ∏è** means multiple transactions must either:
    - All succeed ‚úÖ‚úÖ‚úÖ
    - Or all fail ‚ùå‚ùå‚ùå

This ensures fairness‚Äîno ‚Äúhalfway‚Äù swaps where one party loses out. Think of it like a digital handshake: ü§ù Either both sides agree and it happens, or it doesn‚Äôt happen at all.

## Transaction and Address Types

There are two main types of addresses on the Ethereum blockchain:

- **üë§ Externally Owned Accounts (EOAs):** These are controlled by a private key and can hold ETH and multiple types of tokens. They're basically user wallets!
- **üß† Contract Addresses:** These can run code (smart contracts), but only when triggered by a transaction from an EOA. Think of them like automatic crypto robots!

---

### üîÅ Common Transaction Types

On Ethereum, users typically perform 4 kinds of transactions:

1. **üí∏ EOA ‚û°Ô∏è EOA**
    
    Just a plain ol' Ether transfer!
    
2. **üõ†Ô∏è EOA ‚û°Ô∏è Creating a Contract**
    
    Deploying a new smart contract. No ETH moved, except the fee.
    
3. **üì® EOA ‚û°Ô∏è Contract Transaction**
    
    Can involve token transfers, swaps, bets, and more!
    
4. **üîÑ ERC-to-ERC Transfers**
    
    Swapping between different token standards (e.g., ERC-20 to ERC-721).
    

---

### üí° Tips for Using Etherscan

- üß† **Etherscan is smart!** It often names exchanges and contract owners.
- üßæ **Transactions Tab:** Shows most Ethereum blockchain activity (except plain ERC-20 token transfers).
- ü™ô **ERC-20 Tab:** Tracks only ERC-20 token-related activity for laser-focused insights.
- üé® **NFTs Tab:** Pops up when NFT-related transactions are involved.

## What Are These Contracts We Keep Mentioning?

An **Ethereum contract** is a digital agreement or program that runs on the blockchain. It‚Äôs written in a programming language called **Solidity**, known for being Turing-complete ‚Äî meaning it can perform any computation üß†!

But wait, they‚Äôre not just for legal stuff üßæ ‚Äî Ethereum contracts can automate clever actions with no middleman involved. ü™Ñ‚ú®

---

### üéÆ Gaming, üíñ Causes, and More!

- Into **gaming**? Create a **virtual marketplace** to trade items safely with no fraud üéÆüõí.
- Passionate about **charity**? Build a contract to collect and distribute donations automatically to verified organizations üíñüì§.

These contracts work like digital magic to make sure things run smoothly and trustlessly.

---

### üß± Building Blocks of the Web3 World

Ethereum contracts are **versatile**, like LEGO blocks üß± of the new digital economy. They bring trust through code and put **power in the hands of the coder** üíª.

But ‚ö†Ô∏è **just because it‚Äôs on the blockchain doesn‚Äôt mean it‚Äôs 100% safe**. Bugs üêû and exploits can exist ‚Äî so read with care!

  

## üîç Identifying Contract Transactions

- **EOA to EOA (ETH-to-ETH)** transfers always carry ETH value. Easy to spot! üí∏
- When a **contract** is involved, there **may or may not** be ETH involved ü§î.
- Some say contracts always have **0 ETH**, but in cases like converting ETH to **WETH**, value is present.
- ‚ö†Ô∏è Contract addresses **look just like EOAs**! You can‚Äôt tell just by looking.
- ‚úÖ Best way to check: look for **contract tags** or use a **block explorer** like Etherscan.

---

### üìä Examples of Transactions

![[/image 19 2.png|image 19 2.png]]

- First one is a **Transfer** üü¢ ETH-to-ETH.
    - Binance sent 0.0262857 ETH.
- Second one is **Approval** ‚Äì gives permission to another address to move tokens on behalf of the user. üîê
    - Common with DEXs and DeFi platforms like Uniswap!
    - The "Out" address is a **contract** (check icon on Etherscan).
- üß† Pro tip: Contracts can have lots of activity, but don't panic ‚Äì we'll learn how to read them better in the next chapter!

---

### üß† Conclusion

- You now know how Ethereum transactions work üéâ!
- You're ready to:
    - Read blockchain data
    - Spot different transaction types
    - Start tracking funds across smart contracts üîç
- üí° Next up: deeper dive into **reading contracts**.
- ‚òï Go grab a coffee‚Äîyou‚Äôre doing amazing!

  

# 12. Ethereum: Investigation Methodology

## üì¶ Following ETH-to-ETH Transactions

ETH is the _main coin_ on Ethereum ü™ô ‚Äî it‚Äôs used to pay for everything! But‚Ä¶ is ETH a token? ü§î Not exactly. ETH is usually called a **coin**, while things created by contracts are called **tokens**.

üîÅ Just remember:

- **Coin = Primary currency (like ETH, BTC)**
- **Token = Contract-based stuff**
    
    We‚Äôll use these terms clearly in the next chapters. Let‚Äôs go! üöÄ
    

### üîÅ ETH-to-ETH Transactions Are Like Bitcoin‚Äôs

Just like Bitcoin üí∞, ETH transfers have:

- **Input address & value**
- **Output address & value**
    
    No ‚Äúchange‚Äù is given back ‚Äî it‚Äôs like a bank account üìí: amounts are updated directly. Super easy to read!
    

---

### üßæ A Real ETH Transaction

```Python
0xf714d916443435ca229b389e46fe45d779c8e64a6ecd4ffce71753850a2667d7
```

About the transaction:

`0x754B...` ~0.0997 ETH sent to `0xf070c...`.

- The fee? Just a bit over **0.0008 ETH** üßÆ

![[/image 20 2.png|image 20 2.png]]

---

### üí≤ Switching from ETH to Dollars

Etherscan shows **current value** üíµ. But you can **click** on the $ value to reveal the price **at the time of the transaction** ‚è≥.

üëâ This helps in investigations ‚Äî like proving a $300 ransom was actually $300 at the time of payment, even if it‚Äôs $400 now!

![[/image 21 2.png|image 21 2.png]]

---

### üîç Tracking the Transaction Further

ETH tracking is tricky üß©. Unlike Bitcoin, Ethereum doesn‚Äôt show a ‚Äúfollow this transaction‚Äù button.

1. You need to click on the destination wallet
2. You need to **scroll** through the destination wallet's history üìú and **match timestamps from when the funds were sent to the destination wallet** üïí.

---

### ‚è∞ When Did It Happen?

1. Take note of the time from when the transaction occured!

- üìÖ Example: Nov 26, 2023 ‚Äì 06:05:47 PM UTC

1. Go to the Destination Address and Press the ‚ÄúAge‚Äù button to switch to time, and scroll through until you see the matching time
2. Find the one with the right time and amount.

Use this to search through the destination wallet and locate the right transaction. üïµÔ∏è

![[/image 22 2.png|image 22 2.png]]

---

### üïµÔ∏è‚Äç‚ôÄÔ∏è Matching In & Out

Look at this clever trace:

![[/image 23 2.png|image 23 2.png]]

- üëõ 0.27 ETH arrives
- ‚ûï 0.02 ETH also arrives
- üîÑ 0.30 ETH is sent to Binance

Perfect match! üéØ Even if we don‚Äôt know who sent the 0.02, we can still trace the victim‚Äôs 0.27. This is **chain analysis magic** ü™Ñ!

---

### üîç Tricky side of Ethereum - Whose Funds Have Moved?

---

We‚Äôre following a victim‚Äôs payment of `0.011...ETH` into the suspect‚Äôs wallet `0x853`. üßæ But wait! That wallet already had a **balance of 1.1 ETH** before our transaction was added. üòÆ Then the suspect moves `0.009...ETH` out to `0xDf8`.

![[/image 24 2.png|image 24 2.png]]

üí≠ So whose funds got moved? Was it the **victim‚Äôs** or the suspect‚Äôs **existing** ETH?

That's the tricky part with Ethereum‚Äôs **account-based model**‚Äîyou **can‚Äôt tell**! üôà

Unlike Bitcoin‚Äôs **UTXO model** where each input/output is crystal clear üíé, Ethereum works from a **single balance**, so we can‚Äôt pinpoint which funds were used. This makes tracking much harder in certain cases.

---

---

---

### üßæ Wrapping Up ETH-to-ETH Transactions

ETH-to-ETH transactions are relatively simple. üéØ

We just look at:

- From ‚û°Ô∏è To
- Date üóìÔ∏è / Time ‚è∞
- Value üí∞

That helps us trace the flow of ETH, but remember: we're **tracking balances**, not discrete transaction chains. It‚Äôs like following a **bank account** rather than tracing **individual bills**.

üß† Even though you‚Äôll see lots of simple ETH transfers, **most real-world investigations involve contracts**.

## üíº Smart Contracts Deep Dive

### ü§ñüíº What Is a Smart Contract?

**A smart contract is:**

> Self-executing code with the terms of the agreement between buyer and seller directly written into lines of code.

üí° It lets people make **trusted transactions** without needing a bank, court, or middleman.

No judge üë®‚Äç‚öñÔ∏è, no notary ‚úçÔ∏è ‚Äî just code! üîê

---

### üß†üßë‚Äçüíª Do I Need to Be a Coder?

Nope! Investigators don‚Äôt need to know how to write **Solidity**, the programming language for smart contracts.

But üëÄ understanding what a contract is doing ‚Äî or knowing how to spot shady ones ‚Äî **is super helpful**.

üëæ Fraudsters may:

- Use contracts to **steal funds**
- Reuse shady contract code
- Deploy ‚Äúmalicious‚Äù contracts early in a scam

Having access to a coder üë®‚Äçüíª or using tools like **Etherscan** can help **non-programmers** follow the money!

---

### üîé Detecting Contract Creators on Etherscan

üí° If you paste a contract address ==0x881D40237659C251811CEC9c364ef91dC08D300C== into **Etherscan**,

![[/image 25 2.png|image 25 2.png]]

you‚Äôll:

- See it's labeled as a **contract**
- View the **creator** and **TXID** of its creation
- Check when it was created üïì

üïµÔ∏è Example:  
- A contract created by **AirSwap** at a transaction starting with ==0xb61e1747cb==

This can reveal if a contract:

- Was deployed just before a fraud üëÄ
- Matches a known scam pattern ‚ö†Ô∏è

Just like checking a domain registration date to spot scam websites üìÖüåê

---

### üîÅüß¨ Identifying Contract Clones & Similar Code

==0x1c479675ad559DC151F6Ec7ed3FbF8ceE79582B6==

Etherscan can also show you **similar or exact** contracts.

Scammers often **reuse code** üíª across multiple fake projects.

1. Click on Contract to view the contract itself

![[/image 26 2.png|image 26 2.png]]

üîß Click **More Options ‚Üí Similar** on Etherscan to:

![[/image 27 2.png|image 27 2.png]]

- Detect reused scam contracts
- Extend your investigation
- Find more victims üò¢
- Link contracts back to the **same fraudster** üéØ

![[/image 28.png|image 28.png]]

---

### üïµÔ∏è‚Äç‚ôÇÔ∏è Case Example (Figure 12.8)

üí• A fake token contract was matched with **three exact clones**.

One hadn‚Äôt been used, but the creator had sent funds to an exchange.

üì¨ The investigator sent a request to the exchange‚Ä¶

‚úÖ And got a **suspect ID** back!

---

## üîß Methods, Functions, and Events

Let‚Äôs dive into some smart contracts and figure out what they do ‚Äî **without needing to be a coder**! üòé

In Ethereum smart contracts, **methods** (aka functions) tell us what a transaction is doing. Even though they‚Äôre not required, you‚Äôll usually spot these popular ones:

- `**Name**` ‚Äì üè∑Ô∏è Gets the token name
- `**totalSupply()**` ‚Äì üìä Returns total supply of the token
- `**balanceOf(address _owner)**` ‚Äì üí∞ Shows how much a specific address owns
- `**transferFrom(address from, address to, uint256 value)**` ‚Äì üöö Sends tokens on behalf of someone else
- `**approve(address spender, uint256 value)**` ‚Äì ‚úÖ Lets another account spend your tokens

### üì¢ Events (Transfer, Approve)

Smart contracts can emit **events** ‚Äî messages written on the blockchain üìù.

Events are NOT mandatory but they‚Äôre super helpful! Why? Let‚Äôs break it down:

- üîé **Transparency** ‚Äì Everyone can see what‚Äôs happening
- ‚ö° **Efficiency** ‚Äì Reading logs uses less gas than reading storage
- üîÑ **Interactivity** ‚Äì Apps can react to contract actions in real time

üßæ Common Events:

- **Transfer Events** ‚Äì When tokens are sent from one account to another üöÄ
- **Approval Events** ‚Äì When token owner gives permission to for an account to spend tokens on their behalf ü™™
- **Custom Events** ‚Äì Contract-specific, e.g., for staking or voting üó≥Ô∏è

---

### üß† Using Etherscan Like a Pro

Etherscan is your detective tool üïµÔ∏è‚Äç‚ôÇÔ∏è. When you see a smart contract icon üìÑ or a double one üìÑüìÑ (new contract), that‚Äôs your clue!

![[/image 29.png|image 29.png]]

Go to the **Contract** tab and you‚Äôll see:

### üë®‚Äçüíª Code

- See the Solidity code üíª
- Verified code is public ‚Äî great for audits!
- If it‚Äôs just hex üßä, it‚Äôs likely unverified.

### üìñ Read Contract

- üßæ Check variables and view-only functions (no gas cost!)
- Great for checking balances or token names

### ‚úçÔ∏è Write Contract

- Used to change stuff (like sending tokens)
- ‚ö†Ô∏è Needs a connected wallet and costs gas
- Be careful ‚Äî this actually changes the blockchain!

---

### üõ°Ô∏è Proxy Contracts

Proxy contracts split storage & logic. Why? Because contracts can't change once deployed!

üîÅ The proxy just points to a logic contract, which **can be upgraded**. So no need to redeploy ‚Äî just update the logic! üõ†Ô∏è

---

### üß™ Example Contracts

- Example Contract (Oyster Pearl)
    
    ==0x1844b21593262668B7248d0f57a220CaaBA46ab9==
    
    - Browse this contract in Etherscan
    - Go to Contract
    - View the First 9 functions
        
        ![[/image 30.png|image 30.png]]
        
- Example Contract (Bored Ape)
    
    ==0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D==
    
    - In the Write Contract Screen you can see
        - mintApe
        - reserverApes
        - safeTransferFrom
        - transferOwnership
    - This contract related to the Bored Ape Yacht Club NFT Collection
    
- Example Contract (Swap Contract)
    
    ==0x881D40237659C251811CEC9c364ef91dC08D300C==
    
    ![[/image 31.png|image 31.png]]
    
- Example Contract (Trickier one - **UniswapV3Pool**)
    
    ==0xC2e9F25Be6257c210d7Adf0D4Cd6E3E881ba25f8==
    
    ![[/image 32.png|image 32.png]]
    

---

### üìú Logs View | ü™µ Ethereum Logs

![[/image 33.png|image 33.png]]

---

Every time an Ethereum transaction happens, **logs** get created! üìù

They're like the **receipts** of what actually occurred behind the scenes.

These logs can be a bit technical üòÖ, but they‚Äôre **super useful for investigations** ‚Äî especially when tracing money across bridges üåâ.

---

### üîç Example: ETH-to-Contract Transaction

Let‚Äôs say you check a transaction on [Etherscan](https://etherscan.io/) like this one:

üßæ **TXID**: `0x9ffa9c9e4b39a818e7081f86db3fbe54d32e2325c468d33ede7224f1ad260afb`

This is a **basic ETH ‚Üí Contract** transaction.

---

### üìÇ How to View Logs on Etherscan

At the top of the transaction page, you‚Äôll find buttons:

- üìã **Overview**
- ü™µ **Logs**
- üß† **State**

Clicking **Logs** reveals juicy details, like:

---

### üí° Log Breakdown Example

üë§ **Address**: `Lido: Execution Layer Rewards Vault`

‚û°Ô∏è This is where the funds went! (It uses an ENS name for easy reading.)

üè∑Ô∏è **Name**: `ETHReceived(uint256 amount)`

‚û°Ô∏è The function that ran ‚Äî here, the contract received some ETH!

üîë **Topics**:

```Plain
0x27f12abfe35860a9a927b465bb3d4a9c23c8428174b83f278fe45ed7b4da2662
```

‚û°Ô∏è This is the hash (fingerprint) of what happened ‚Äî used to identify log types.

üí∞ **Data Amount**: `205154322788559076`

‚û°Ô∏è Sounds huge? It‚Äôs in **wei**, the smallest unit of ETH.

Divide by `10^18` ‚ûó to get the real amount:

**=** `**0.205154322788559076 ETH**` üí∏

---

---

### üßæ State Logs ‚Äì See the Balance Before & After!

Wanna see **how much ETH** was in someone‚Äôs wallet before and after a transaction? That‚Äôs what **State Logs** are for! üïµÔ∏è‚Äç‚ôÄÔ∏èüìä

On Etherscan, right next to the "Logs" button, you‚Äôll find the **State** button. Click it, and boom üí• ‚Äî you'll see something like this:

![[/image 34.png|image 34.png]]

This tells us:

- ‚úÖ One address **received** `0.2051 ETH`
- ‚ùå Another **sent** `0.2055 ETH`

### üîé **Why State Logs Are So Cool**

Ethereum makes it **super easy** to check wallet balances before and after a transaction ‚Äî no math gymnastics required! ü§∏

üîô With **Bitcoin**, you'd need to:

1. Add up every incoming transaction üì•
2. Subtract all outgoing ones üì§
3. Do this from the wallet's entire history... üò´

‚è© But with **Ethereum**:

- Just look at the State log!
- Know the **exact balance** at any point in time üß†‚ú®

---

### üß™ **Real-World Example**

Let‚Äôs say a suspect claims,

> "I only had 2 ETH in my wallet on that day!" üòá

üë®‚Äçüíª You can:

- Find a transaction near that date
- Check the **State log**
- And prove if that was true or... üí• Busted!

---

## ü§ù ETH-to-Contract Transactions

Sometimes you're not just sending ETH to another wallet ‚Äî you're sending it to a **smart contract**.

That could be to a user either:

- Buy an NFT üñºÔ∏è
- Swap ETH for another token üí±
- Use a DeFi protocol like lending or staking üè¶

In these transactions:

- ‚úÖ The **sender** is always a user (EOA)
- üß† The **receiver** is a **smart contract** (you‚Äôll spot the üìÑ icon on Etherscan)

### üîÑ How It Works

üßç‚Äç‚ôÇÔ∏è **User (EOA)** ‚Üí sends **ETH** ‚Üí üíª **Smart Contract**

Then, the contract does its magic and might:

- Send tokens back to the user ü™ô
- Send tokens to someone else üë§
- Wrap the ETH into WETH üîÅ

üìä Fees? Paid in ETH too. Always.

üì• Your balance goes down.

üì§ The contract processes the ETH and might return you something else.

---

### üìä How ETH to Contract work - Flow Diagram

![[/image 35.png|image 35.png]]

---

### üß™ Real Example: Uniswap V2 Swap üß¨

üìÑ TXID:

`0xb892ad91b112cbd2181c42d1efefa54e19dd1714fff481684fae29f55bdb1c7c`

üëÄ What happened?

> üí± Swapped 0.25 ETH for 2,895,602.64 DEGEN tokens
> 
> Using **Uniswap V2** ü¶Ñ

### üîç Let‚Äôs Break It Down

**Step 1:**

- üßç From: `0xDF62...DaBb1` (User/EOA)
- üíª To: `0x80a6...Cd5d9` (Contract ‚Äî Maestro Router 2)

üß† This contract **wraps ETH** ‚Üí into **WETH** because ETH isn't an ERC-20 token.

**Step 2:** ERC-20 Transfer Details üí°

- Maestro Router sends **0.25 WETH** ‚Üí to another contract `0x6eBA...`
- That contract sends back **2.89 million DEGEN tokens** ‚Üí to original user

---

---

### üîÑ üì¶ Raw Input Data/Decode Raw Input Data

So‚Ä¶ we swapped ETH ‚Üí DEGEN, but _where exactly_ did that happen? ü§® Let‚Äôs get technical üïµÔ∏è‚Äç‚ôÇÔ∏è

Scroll down to **"More Details"** section of a transaction on Etherscan is the **raw input data** ‚Äî that‚Äôs where the magic is! ‚ú®

You‚Äôll see a function like this:

![[/image 36.png|image 36.png]]

```Plain
swapExactETHForTokensSupportingFeeOnTransferTokens()
```

‚úÖ This tells us the **contract's intent**: swap ETH for a token (like DEGEN)

‚úÖ Method ID and values follow ‚Äì you can decode it using **Decode Input Data**

---

### üß¨ Decode Input Data Breakdown:

|   |   |   |   |   |
|---|---|---|---|---|
|#|Name|Type|Value/Data||
|Row 0|`amountOutMin`|uint256|Minimum amount of DEGEN expected (slippage protection) üîí||
|Row 1|`path`|address[]|Token path: From WETH ‚û°Ô∏è to DEGEN||
|Row 2|`to`|address|User‚Äôs wallet (the recipient!) üíå||
|Row 3|`deadline`|uint256|Unix timestamp deadline ‚è±Ô∏è||

  

  

---

### üß© Etherscan Confusion: Same Address, Different Identities?!

Let‚Äôs talk about the **weird behavior** of Etherscan that _almost_ tricks you ü§Ø

### ü§ñ Two Transactions‚Ä¶ Same Address?

Here‚Äôs what we saw:

```Plain
From Maestro Router ‚Üí 0x6eBA... (for Wrapped ETH üßä)
From 0x6eBA... ‚Üí 0xDF62F... (for DEGEN ü™ô)
```

Both lines mention **0x6eBA**, but:

- The first one shows it as a **Wrapped ETH** address
- The second shows it as a **DEGEN token** sender

üòµ What‚Äôs happening?!

---

### üß† The Etherscan Filter

Etherscan **filters transactions** based on the token context.

That means:

- If you click **0x6eBA** on a WETH transaction, it takes you to a WETH page üßä
- If you click **the same address** on a DEGEN transaction, it takes you to a DEGEN page ü™ô

So it _looks_ like two different addresses ‚Äî but it‚Äôs **actually the same one!**

---

### üîç Which Contracts Own It?

To find out who really owns `0x6eBA`, we:

1. üß≠ Visit the two Etherscan links:
    1. [https://etherscan.io/token/0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2?a=0x6ebade7ea56b6efc2106549c047d1faec4bdf89c](https://etherscan.io/token/0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2?a=0x6ebade7ea56b6efc2106549c047d1faec4bdf89c)
        1. This link takes us to the address 0xc02a, which is the wrapped ETH address, but filters for any transactions that include 0x6eb.
    2. [https://etherscan.io/token/0xb27b907c2de4a2bf87c14fe503cf7ea4388451d5?a=0x6ebade7ea56b6efc2106549c047d1faec4bdf89c](https://etherscan.io/token/0xb27b907c2de4a2bf87c14fe503cf7ea4388451d5?a=0x6ebade7ea56b6efc2106549c047d1faec4bdf89c)
        1. This link takes us to the address 0xb27b, which is owned by DEGEN, but again filters for any transactions that include 0x6eba.
2. üß© **Who really owns** `**0x6eBA**`**?**
    - Searching the address directly in Etherscan reveals: **Uniswap V2** üí±

This **lines up perfectly** with the Transaction Action:

> "Swap 0.25 ETH for 2,895,602 DEGEN on Uniswap V2"

üéØ Case closed ‚Äî `0x6eBA` is the swap contract address (Uniswap V2)!

---

---

### ‚ö†Ô∏è Beware of Filtered Views!

When clicking addresses in Etherscan:

- üìå Check if you're seeing a **filtered token view**
- üëÄ Always verify with a **full search** or use blockchain tools

Look out for the ‚Äúüîí FILTERED BY TOKEN HOLDER‚Äù badge ‚Äî it's a red flag üö©

---

### üß¨ Full Transaction Recap

Here‚Äôs the beautiful 5-step summary from your investigation:

1. üßç‚Äç‚ôÇÔ∏è `0xDF62F` sends **0.25 ETH** to Maestro
2. ‚ôªÔ∏è Maestro wraps it into **WETH**
3. üßæ DEGEN contract **approves Uniswap** to spend tokens
4. üí± Uniswap **swaps WETH for DEGEN**
5. üéÅ 2.89M DEGEN sent **back to 0xDF62F**

---

## üßæ Token-to-Token Transactions

### üîÑ What It Is:

A **token-to-token transaction** involves transferring tokens via a smart contract (e.g., ERC-20 or ERC-721), **without any ETH value** involved in the transaction itself.

### üìù Key Characteristics:

![[image 37.png]]

- **No ETH value** in the transaction (always 0).
- **ETH is still needed** to pay the **gas/transaction fee**.
- The sender‚Äôs **token balance decreases** by the amount sent.
- The **"From" address** on-chain will show the **token contract** address (not the user).
- The **destination token balance** increases, but identifying this address might require digging into the smart contract logs.

---

### üß™ Example Breakdown:

### ‚úÖ Transaction Details:

- **TXID**: `0x7f3ccfadb47dea39835a0dda10a0c0efbf4f6f7944da7bdf6c3b02cca7fde6d0`
- **Timestamp**: Feb-16-2024 09:07:47 AM UTC
- **Value**: `0 ETH`
- **Transaction Fee**: `0.0012835278726216 ETH` (~$3.61)

### ü™ô Token:

- Token: **VRA** (Verasity)
- Found on [CoinMarketCap](https://coinmarketcap.com/)
- Described as a decentralized protocol for **NFT sharing, leasing, and financing**.

---

### üß† Key Analysis Tips:

1. **Do Research**: (On Coinmarketcap can be a start)
    - Look up **unknown tokens** to understand their purpose and legitimacy.
    - Investigate **token price history** to detect pump-and-dump or scam behavior.
    - Cross-reference the **creation date** of the token with scam activity timelines.
2. **Smart Contract Clarity**:
    - The **"To" address** is often the **contract**, not the final recipient.
    - Check **"ERC-20 Tokens Transferred"** logs to find actual **recipient address**.
    - Example:
        - From: `0xBFCd86...2723d6aD`
        - To: `0x974026...702Ac35C`
        - Amount: `6,000,000 VRA` (~$45,205.51)
3. **Plain Language Interpretation**:
    - `0xBFC` tells contract `0xF411` to transfer 6M VRA to `0x9740`.

---

## üîß Etherscan Balance Checker

üîó https://etherscan.io/balancecheck-tool

![[image 38.png]]

- Check ETH or token balances at a specific **date and time**.
- Great for verifying if a scammer held tokens during a reported incident.
- Example given: Checking **DONALD TRUMP 2024 token** balances.

## üñºÔ∏è NFTs ‚Äì What Are They?

An **NFT** (Non-Fungible Token) is a digital token that proves ownership or authenticity of a **unique item**, like a üéÆ gaming card, üé® artwork, üé∂ music, or more! Unlike Bitcoin or other **fungible** tokens (which are all the same), **NFTs are one-of-a-kind**. This uniqueness makes them perfect for securely owning digital (and sometimes physical) assets! üîê‚ú®

### üéÆ Where NFTs Are Still Thriving

Even if some NFTs were overpriced üí∏, they're **still hot in online gaming**. Think characters, skills, weapons, etc., all tradable on the blockchain. Because they offer real, usable in-game items, they remain the **most common NFT transactions today**. üïπÔ∏èüî•

---

### üö® NFTs & Money Laundering

Be alert! üö® NFTs can be a **tool for money laundering** due to their unregulated value, especially in the ‚Äúart‚Äù space. Investigators should keep an eye on wallets holding NFTs. üïµÔ∏è‚Äç‚ôÇÔ∏èüíº

---

### üîç NFT Transactions: What‚Äôs Inside?

NFT transactions can be a bit trickier than normal tokens. Why? ü§î Because they often involve more smart contract functions. For instance, a typical OpenSea NFT deal may include:

- üë§ Buyer
- üìú OpenSea contract
- üí∞ OpenSea fee address
- üßæ Seller address
- ‚õìÔ∏è Blockchain fee

---

### üß™ Investigating an NFT on Etherscan

üîç On **Etherscan**, we check this TXID:

`0x66276114032a34cc8c547049e4ce498f7194b49bd2c48d1e415d51463f30fab2`

It says:

![[image 39.png]]

**Sale: 1 NFT For 0.8499 ETH On OpenSea via Seaport** üñºÔ∏èüíµ

But wait! Who‚Äôs the buyer or seller? We dig deeper...

### üßë‚Äçüíª **Who‚Äôs Who in the Transaction?**

![[image 40.png]]

From: `0x3D1ff3F071CfaF83407e73666744412F113CEEF6`

- üéØ Buyer

To: `0x35F4bf...53514Cfa`

- üßæ Seller (owner)

1. 0x3D1 interacted with Open sea‚Äôs contract address 0x000
2. 0x00 paid 0.0042 fees to Open Sea‚Äôs contract
3. 0x00 paid 0.84 to the NFT Owner
4. ERC-721 Token ID[658] is what the Buyer transacted for
5. The token owner 0x35F4 sent the token to the buyer

---

### üîó **Clicking the NFT Token ID üÜî**

When you click the **Token ID [658]** link, it can take you to a page that shows:

![[image 41.png]]

- üñºÔ∏è The actual NFT (sometimes)
- üóÇÔ∏è What collection it belongs to
- üßæ The **full transaction history** ‚Äì from the moment it was minted (created) to all the owners it's passed through!
    
    üí° This is _super useful_ for investigators! üïµÔ∏è‚Äç‚ôÄÔ∏è
    

---

### üìä **History Breakdown ‚Äì NFT #658**

1. Go to Inventory and click on the token

![[image 42.png]]

1. Scroll down to the transaction section

![[image 43.png]]

Let‚Äôs break down this NFT's history (so easy to read! üëì):

- ‚úÖ Minted
- üîÅ Transferred twice (no value)
- üí∞ Sold for **1.3899 ETH**
- üîÅ Transferred again
- üí∏ Sold again:
    - For **0.7739 ETH**
    - Then for **0.8499 ETH**

üí° **Quick Profit Alert!** üö®

ü§ë The NFT was bought and sold for a **$200 profit** in **just over an hour** on **Feb 20, 2024**!

---

---

### üåê Other Tips?

Most NFTs are bought and sold on platforms like:

- üõí **OpenSea**
- üåü **LooksRare**
- üé® **Rarible**

These platforms don‚Äôt use regular login methods (like username/password). Instead, they ask you to **connect your crypto wallet**, and you‚Äôre anonymously verified using your **public/private key pair** üîëüíº

### üîç **Investigators‚Äô Secret Weapon**

This setup is super helpful for investigators! üïµÔ∏è‚Äç‚ôÇÔ∏è Why?

You can simply enter a user‚Äôs Ethereum address on platforms like:

- [OpenSea.io](https://opensea.io/)
- [Rarible.com](https://rarible.com/)
- [LooksRare.org](https://looksrare.org/)

And voil√†! You‚Äôll see:

- All NFTs owned
- How many were bought/sold
- üí∞ Value of sales
- üìä Other analytics

Example ETH address:

`0x3D1ff3F071CfaF83407e73666744412F113CEEF6`

---

### üïµÔ∏è‚Äç‚ôÄÔ∏è **Finding Hidden Clues: Usernames & Aliases**

Sometimes these NFT accounts have **usernames or aliases** ‚Äî and those can lead to other platforms or profiles! üï∏Ô∏èüåê

üîé Example:

- Seller‚Äôs address: `0x35F4...`
- Username found: `NFTinitcom_CheckBlur`
- Google it and BAM üí• you find a website **NFTinit.com** and an X (Twitter) account!

---

### üéØ **Bonus Tip for Curious Investigators**

But for now, you can practice! Head to **Etherscan**, click on the **NFTs menu**, and select **Latest Trades**.

You‚Äôll see an _endless feed of NFT transactions_ to study! üíªüßæüìà

---

## üè¶ Decentralized Exchanges (DEXs)

A **DEX** is like a digital marketplace where users can **trade crypto directly** ‚Äî no middlemen, no banks, no company in the middle! üîóüí∏

‚úîÔ∏è Powered by **smart contracts** on blockchains like **Ethereum**

‚úîÔ∏è No need to trust a third party ‚Äì everything‚Äôs **automated**

‚úîÔ∏è Offers **transparency & security** üîê

Popular DEXs include:

- ü¶Ñ Uniswap (Ethereum)
- ü•û PancakeSwap (Binance Smart Chain)
- üåÄ Curve
- üê¶ Dodo

### üåä What‚Äôs Liquidity & Why Should You Care?

Before understanding DEX transactions, you gotta get liquidity! üíß

üí° **Liquidity** = how easily you can swap between tokens

Think of it like how much **cash** or **crypto** the exchange has on hand üí∞

In **centralized exchanges**, they hold tokens themselves (like a bank).

In **DEXs**, the smart contract holds the tokens in a **liquidity pool** ‚Äî which YOU can provide!

### üí∏ **How Does It Work?**

- You can **add liquidity** to a pool (e.g. ETH + USDC)
- You become a **Liquidity Provider (LP)** üßë‚Äçüåæ
- You get **LP tokens** and earn **a share of trading fees** üí∞

Watch out though ‚Äî **low liquidity = high slippage** (bad exchange rates üò¨)

Also: **More liquidity = less price manipulation risk**

---

### üìò **Understanding Liquidity 101 üìò**

At the center of it all is the **liquidity pool** üåÄ

‚úÖ Smart contract

‚úÖ Holds 2+ tokens

‚úÖ Auto-calculates exchange rates based on token supply

When you provide liquidity:

- You deposit equal values of both tokens
- Get LP tokens in return ü™ô
- Earn trading fees when people swap ü§ë

---

### ‚ö†Ô∏è **Liquidity Risks & Rewards**

**High liquidity =** smoother trades üõ∂

**Low liquidity =** bigger price swings, risk of manipulation üö®

üéÅ Platforms offer rewards to LPs:

- Fee shares
- Governance tokens üó≥Ô∏è

‚ùó **Impermanent loss** = when token prices change after you‚Äôve deposited, you might withdraw **less value** than you put in. üò¢ But fees might make up for it!

---

### üîÑ **DEX Fund Flow ‚Äì Behind the Scenes**

Here‚Äôs how swaps work:

1. üßç User deposits tokens into the swap contract
2. ‚öôÔ∏è Contract may convert ETH ‚Üí **wrapped ETH (WETH)**
3. üîÑ Finds the best route for conversion
4. ü™ô User gets the swapped token
5. üíº Deposited funds stay in contract (if added as liquidity)

üìå Note: **Swapping funds to obfuscate** is not the same as **investing funds in liquidity pools**. Investigators must know the difference! üïµÔ∏è‚Äç‚ôÇÔ∏è

---

### üß™Example Swap 1

You‚Äôve already looked at contract transactions ‚Äî now let‚Äôs jump into a **more advanced swap**! üåÄ

Here‚Äôs the transaction hash to check on **Etherscan**:

üßæ `0xb46f35d20c4e2b94e7db1da6879a1c39977e2568986d92162fbd509b412f1749`

![[image 44.png]]

### üß© Initial Glance**‚Ä¶**

At first glance, the Transaction Action looks like:

![[image 45.png]]

All we know:

- A swap is happening
- The user is `0x94df...` (our starting point üîç)
- It‚Äôs using **1inch**, a DEX aggregator üõ†Ô∏è

> An aggregator finds the best deal by searching across multiple DEXs

---

### üîç **Let‚Äôs Check the Fund Movements**

![[image 46.png]]

---

### üß† **Let‚Äôs Piece It Together!**

üîπ **Step 1:**

User `0x94df...` sends **113 DYDX**

‚Üí most goes into the swap

‚Üí a small bit (~1 DYDX) goes to a **fee wallet**

üîπ **Step 2:**

Contract at `0xbAd9AD...` is identified as **USDC-related**

‚Üí this is where the DYDX is swapped to USDC! üîÅ

üîπ **Step 3:**

Funds pass through **1inch v5 Aggregator Router**

‚Üí then come right back to the user üéØ

---

  

### üí° Tip for Practice

If you want to master this skill:

- Head to **Etherscan**
- Go to **Tokens > Token Transfers**
- Look for transactions with **Swap** functions
- Try following the token movements like a forensic ninja ü•∑üîç

  

## üïµÔ∏è‚Äç‚ôÇÔ∏è Investigating DeFi Contracts & Transactions (Quick Reference)

### üîç **Key Concepts in DeFi Investigation**

- **Smart Contracts**: Autonomous programs on-chain that handle logic for swaps, staking, lending, etc.
- **DeFi vs CeFi**: Some contracts, like derivatives platforms, run off-chain; always check with the service provider for internal logs.
- **Two-Way Contract Relationship**: Look for **inflow** (deposit/invest) and **outflow** (withdraw/profit) to/from a contract.

---

### üç¨ **Liquidity Pools & Swap Contracts Explained (Jelly Beans Analogy)**

- **Two assets in a pool** (e.g., ETH & NickCoin).
- Users **swap** one for the other based on the current ratio.
- The **exchange rate shifts** with each swap.
- Users who provide liquidity earn **fees** from swaps = **yield farming**.
- Creators can **pump & dump** tokens by manipulating interest and draining the ETH once the price peaks.

---

### üîÑ **Common Functions to Watch in DeFi Investigations**

### üí∞ Deposit-Related

- `deposit()`
- `addLiquidity()`
- `stake()`
- `enter()`
- `mint()`
- `invest()`

### üí∏ Withdrawal-Related

- `withdraw()`
- `removeLiquidity()`
- `unstake()`
- `exit()`
- `burn()`
- `harvest()`
- `claimRewards()`

### üîÄ Generic

- `transfer()`
- `approve()`

---

### üîé **Example Analysis: SushiSwap Liquidity Withdrawal**

üìÑ **TXID**: `0xadc1b92dc...f392`

**Action**:

Withdraw ETH & DAI from a SushiSwap LP (removeLiquidityETH).

**Key Steps Identified:**

1. **LP tokens sent back** to SushiSwap = user proves ownership of liquidity.
2. ETH is **unwrapped from WETH** and returned.
3. DAI is returned after internal burns and routing.
4. SushiSwap **mints & burns LP tokens** to rebalance.

üí° Tip: Internal ERC-20 token transfers are **not always in logical order**‚Äîyou must match them with the user‚Äôs address to reconstruct the story.

---

### üîë **Governance Tokens**

- Grant **voting rights** and **proposal submission** powers.
- Represent **stakeholder interest**.
- Encourage **decentralized governance** and participation.

---

### üîê **The Approve Transaction**

**Three Steps:**

1. **Approve**: Token holder allows contract to spend X amount.
2. **Allowance**: Contract stores how much it‚Äôs allowed to use.
3. **transferFrom()**: Contract then moves tokens when action is triggered (e.g., swap, add liquidity).

üí¨ Approve is often followed by **Execute** (trade/swap).

---

### üß† **Investigator Tips**

- Watch for **pump and dump** schemes.
- Check for **ownership of LP/Governance tokens**‚Äîsigns of DeFi investments.
- Identify **contract interaction patterns** using tools like Etherscan.
- If DeFi interaction is complex (e.g., exploits), consult a **Solidity dev**.

---

If you'd like, I can help you with:

- A **step-by-step Etherscan walkthrough** on real transactions
- A **DeFi forensic worksheet template**
- A quick reference **cheatsheet** for DeFi analysis (printable or PDF)

Want one of those? Let me know! üßæüîçüìÇ

## üïµÔ∏è‚Äç‚ôÇÔ∏è Step-by-Step DeFi Transaction Investigation on Etherscan

### üéØ Goal:

Understand what happened in a DeFi transaction (e.g., a user **removed liquidity** from a SushiSwap pool).

### üß≠ Step 1: Identify the Transaction

Go to [Etherscan](https://etherscan.io/) and paste the transaction hash (TXID) in the search bar.

üì¶ **Example TXID**:

`0xadc1b92dc6477b2299992744659841049d0599f43a9a4fecf1d44812a997f392`

---

### üìù Step 2: Read the Summary

At the top, Etherscan shows:

- **From:** Wallet initiating the transaction
- **To:** Contract being interacted with
- **Value:** Any ETH transferred
- **Method:** The function called (e.g., `removeLiquidityETH()`)

üß† _This tells you the user's intent and target contract._

---

### üî¨ Step 3: Review Input Data

Scroll down to the **Input Data** section ‚Üí click ‚ÄúDecode Input Data.‚Äù

Here you‚Äôll find:

- Function name
- Token address
- Liquidity amount
- Minimum expected output
- Recipient address

üëÄ This is the **instruction** sent to the contract. In this case:

```Solidity
removeLiquidityETH(address token, uint liquidity, uint amountTokenMin, uint amountETHMin, address to, uint deadline)
```

---

### üßæ Step 4: Review Internal Transactions

This section shows **ETH transfers**.

Example:

```Plain
Transfer 0.027 ETH from SushiSwap:Router to 0xUser
```

‚úÖ This confirms part of the liquidity being returned to the user was in ETH.

---

### üí∞ Step 5: Analyze ERC-20 Transfers

This is where the **tokens** are moved. Look for:

- **LP tokens** sent by the user to the contract
- **DAI/WETH** being sent back to the user
- **Null address** (0x000...000) = token burned (e.g., LP tokens destroyed)
- **Minted LP tokens** = liquidity adjustment

üß© Use addresses to match:

- Who sent it?
- Who received it?
- Is it a contract, DEX, or user?

---

### ü™ô Step 6: Interpret the Events

Using the info:

1. **User sent LP tokens** ‚Üí proving they want to withdraw.
2. **Contract returns ETH & DAI** ‚Üí their original deposit.
3. **LP tokens are burned** ‚Üí balance the pool.

üí° This means the user exited the pool and got their funds back.

---

### üîÑ Step 7: Look for Approve Transactions Before This

Check the user‚Äôs address and search earlier transactions for:

- `approve()` function
- Transfer of LP tokens or DAI to contract

üîê These show **setup steps** that granted permission to the contract.

---

### üß† Step 8: Ask These Questions

- Does this transaction make sense?
- Are the token values consistent?
- Could this be part of a **money laundering**, **pump-and-dump**, or **token scam**?
- Are any contracts involved tagged as malicious or unusual?

---

### üõ†Ô∏è Tools That Help

Use these tools alongside Etherscan:

- üîó [Token Sniffer](https://tokensniffer.com/): Scam detection for tokens
- üîç [DeBank](https://debank.com/): DeFi wallet balance tracker
- üß† [EthTx.info](https://ethtx.info/): Visual breakdown of complex transactions

---

Would you like me to:

1. **Break this into a printable checklist?** üìù
2. **Show you how to trace a DeFi transaction from a specific wallet step-by-step?**
3. **Create a case simulation based on a suspect wallet?**

Just let me know!

# üîç Investigating Binance Smart Chain (BSC) üõ°Ô∏è

### üìò What is BSC?

- BSC launched in **September 2020** as a parallel chain to Binance Chain (2019).
- **BNB token** originated on Ethereum in 2017.
- BSC brought **smart contract support + EVM compatibility**, making it appealing to Ethereum devs.
- **Advantages:** Lower fees, faster transactions, proof-of-stake consensus.
- **Validator count (as of 2024):**
    - BSC: 56
    - Ethereum: ~1 million
- Uses **Go Ethereum (Geth)** protocol ‚Äî very similar to Ethereum.

---

### üß† For Investigators:

- BSC is **not fundamentally different** from Ethereum.
- Use **BscScan.com** (Etherscan‚Äôs twin for BSC).
- Common dApps are **forks** of Ethereum projects:
    - ü•û PancakeSwap = üç∞ Uniswap fork.
- **Token standards:**
    - ERC-20 ‚Üí BEP-20
    - ERC-721 ‚Üí BEP-721
    - ERC-1155 ‚Üí BEP-1155

---

### üíº Investigating Funds on BSC

- Main coin: **BNB** (just like ETH on Ethereum).
- üõë Important: **Seize tokens before seizing BNB** ‚Äî gas fees are paid in BNB.
- Fraud tokens still require BNB to operate ‚Üí track BNB origin for investigation.
- **Addresses are the same across chains** ‚Üí look at multichain assets!

---

### üåâ Multichain Insights:

- Addresses may have **funds on multiple chains** (often >80% have both BSC & ETH).
- Example: Romance scam cracked using NFT purchase on BSC linked to Ethereum address alias ‚Üí OSINT = üîë

---

### üßæ BNB Transfer Example (TXID: 0xe99ea2...)

- Simple transfer of BNB.
- **Structure & fields identical to Ethereum**.
- Investigators should feel at home.

---

### üß© Contract Interaction Example (TXID: 0x6e3cbf...)

- PLAY token claimed via function:
    
    ```Solidity
    claim(address _to, uint256 _nonce, address _token, uint256 _amount, bytes _signature)
    ```
    
- Shows minting (from **Null Address**) to a user ‚Üí reward system via XCAD Network (Watch2Earn).
- Commercial tools may **miss function call context** ‚Äî open-source research critical.

---

### üñºÔ∏è NFT Sale Example (TXID: 0xffdcf5...)

- **Sale of NFT** on PancakeSwap for **0.024 BNB**.
- Buyer: `0x94853‚Ä¶` triggered `buyTokenUsingBNB()` function.
- Transfers:
    - 0.0216 WBNB to seller `sledge1313.bnb`.
    - BEP-721 NFT [ID: 7175] to buyer.
- Fees:
    - Conversion from BNB to WBNB incurs fee.
    - No explicit platform fee seen, but remainder suggests PancakeSwap takes a cut.

---

### üîß Tools & Tips:

- BscScan includes **Multichain Info pane** to identify assets on other chains.
- Investigators should **check for LP tokens, staked assets, or claimed rewards**.
- Use both commercial tools and **manual review via BscScan** for full context.
- Always **check input data / function calls** to understand transaction intent.

---

### üß† What You‚Äôve Learned:

- If you understand Ethereum, you're already **well-equipped for BSC**.
- Same fundamentals: address format, token standards, transaction structure.
- Stay vigilant ‚Äî commercial tools miss context; **manual review + OSINT = winning combo**.

---

Would you like this broken into flashcards, visuals, or a printable cheat sheet format?