
PowerShell Remoting (WinRM) lets you execute commands and transfer files between systems even when HTTP, HTTPS, or SMB are blocked.  
It operates over:

- **HTTP (5985)**
    
- **HTTPS (5986)**
    

---

## 1. Confirm Current User and Host (Target)

On the **target machine**:

```powershell
whoami
hostname
```

Example output:

```
htb\administrator
DC01
```

_You are logged in as Administrator on the `DC01` target._

---

## 2. Check Remote Host Connectivity (Attacker)

On the **attacker machine** (your control machine):

```powershell
Test-NetConnection -ComputerName DATABASE01 -Port 5985
```

Example output:

```
ComputerName     : DATABASE01
RemoteAddress    : 192.168.1.101
RemotePort       : 5985
TcpTestSucceeded : True
```

_Connection confirmed — WinRM is open and reachable._

---

## 3. Start a Remote PowerShell Session (Attacker)

On the **attacker machine**:

```powershell
$Session = New-PSSession -ComputerName DATABASE01
```

_No credentials are required if you are already an Administrator on the remote host._

---

## 4. Transfer File: Local ➜ Remote

From the **attacker machine** to the **target machine**:

```powershell
Copy-Item -Path C:\samplefile.txt -ToSession $Session -Destination C:\Users\Administrator\Desktop\
```

_`samplefile.txt` is copied from the attacker (`DC01`) to the target (`DATABASE01`) desktop._

---

## 5. Transfer File: Remote ➜ Local

From the **target machine** to the **attacker machine**:

```powershell
Copy-Item -Path "C:\Users\Administrator\Desktop\DATABASE.txt" -Destination C:\ -FromSession $Session
```

_`DATABASE.txt` is copied from the target (`DATABASE01`) to the attacker (`DC01`) in the `C:\` directory._

---

## 6. Close the Session (Attacker)

On the **attacker machine**:

```powershell
Remove-PSSession $Session
```

_Always clean up sessions when done._

---

Would you like me to integrate this with your **Netcat/Ncat** and **Nginx HTTP/S** notes into a single combined cheat sheet for quick reference?