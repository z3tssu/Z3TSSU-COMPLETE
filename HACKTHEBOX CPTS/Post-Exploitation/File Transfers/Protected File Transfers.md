
When handling sensitive data during penetration tests or red team operations — such as **user credentials, NTDS.dit files, LSASS dumps, or scan logs** — encrypt **everything** before transfer.  
A plaintext leak can have serious consequences for both you and your client.

---

## 1. Best Practices Before Exfiltration

- Use **dummy or simulated data** for DLP testing.
    
- **Never exfiltrate live PII, credentials, or trade secrets** unless explicitly authorized.
    
- Always document your encryption methods and passwords in your engagement report.
    
- Use unique, strong keys for each engagement.
    

---

## 2. File Encryption on Windows

### Import the AES Module

On the **attacker or target machine** where PowerShell is available:

```powershell
Import-Module .\Invoke-AESEncryption.ps1
```

---

### Encrypt a String

```powershell
Invoke-AESEncryption -Mode Encrypt -Key "p@ssw0rd" -Text "Secret Text"
```

_Outputs an encrypted Base64 string._

---

### Decrypt a String

```powershell
Invoke-AESEncryption -Mode Decrypt -Key "p@ssw0rd" -Text "<Base64-String>"
```

---

### Encrypt a File

```powershell
Invoke-AESEncryption -Mode Encrypt -Key "p4ssw0rd" -Path .\scan-results.txt
```

_Generates an encrypted file:_  
`scan-results.txt.aes`

---

### Decrypt a File

```powershell
Invoke-AESEncryption -Mode Decrypt -Key "p4ssw0rd" -Path .\scan-results.txt.aes
```

---

## 3. File Encryption on Linux

### Encrypt a File with OpenSSL

On the **target or attacker machine**:

```bash
openssl enc -aes256 -iter 100000 -pbkdf2 -in /etc/passwd -out passwd.enc
```

_You will be prompted to enter a password._

---

### Decrypt the File

```bash
openssl enc -d -aes256 -iter 100000 -pbkdf2 -in passwd.enc -out passwd
```

---

## 4. Transfer Methods After Encryption

Once encrypted, you can safely transfer files using:

- HTTPS
    
- SFTP
    
- SCP/SSH
    
- Encrypted tunnels (e.g., SSH port forwarding, VPNs)
    

---

## 5. Security Reminders

- Use strong, unique passwords per engagement.
    
- Rotate encryption keys between projects.
    
- Never transmit the password through insecure channels.
    
- Log your encryption methods and share passwords securely with authorized stakeholders only.
    

---
