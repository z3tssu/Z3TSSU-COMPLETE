  

# **Access Control List (ACL) Overview**

## What do ACLs define:

- ==who has access to which asset/resource and==
- ==the level of access they are provisioned==

## Two Types of ACLs

- Discretionary Access Control List (DACL)
    - a list that says who can or cannot access something. If there's no DACL, everyone can access it. If there is a DACL but it doesn't list anyone, then no one can access it.
- System Access Control Lists (SACL)
    
    - Allows administrator to log access attempts made to secured objects
    
    ![[Notion/CPTS/RESOURCES/image 22.png|image 22.png]]
    

## Example of ACL in Use

### DACL & ACE

- The ACL for the user account "forend" lists several permission entries, which together form the DACL. Each entry (like Full Control or Change Password) is an ACE that shows what rights different users or groups have over the "forend" account.
    
    ![[image 1 14.png|image 1 14.png]]
    

### SACLs

- The SACLs can be seen within the `Auditing` tab.
    
    ![[image 2 10.png|image 2 10.png]]
    

# Access Control Entries (ACEs)

## Three main types of ACE

1. Access Denied ACE
    - Show that a user is denied explicit access to an object
2. Access Allowed ACE
    - Show that a user is granted access to an object
3. System Audit ACE
    - Generate audit logs and a user attempts to access an object

## Components of ACE

![[Notion/CPTS/RESOURCES/image 3 7.png|image 3 7.png]]

1. The security identifier (SID) of the user/group that has access to the object (or principal name graphically)
2. A flag denoting the type of ACE (access denied, allowed, or system audit ACE)
3. A set of flags that specify whether or not child containers/objects can inherit the given ACE entry from the primary or parent object
4. An [access mask](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/7a53f60e-e730-4dfe-bbe9-b21b62eb790b?redirectedfrom=MSDN) which is a 32-bit value that defines the rights granted to an object

## Why are ACEs Important

- Can be used in a pentest for lateral movement
- Administrators tend to misconfigure these ACLS to objects in the AD environment

## Active Directory Object Security Permissions

- F`orceChangePassword` abused with `Set-DomainUserPassword`
- `Add Members` abused with `Add-DomainGroupMember`
- `GenericAll` abused with `Set-DomainUserPassword` or `Add-DomainGroupMember`
- `GenericWrite` abused with `Set-DomainObject`
- `WriteOwner` abused with `Set-DomainObjectOwner`
- `WriteDACL` abused with `Add-DomainObjectACL`
- `AllExtendedRights` abused with `Set-DomainUserPassword` or `Add-DomainGroupMember`
- `Addself` abused with `Add-DomainGroupMember`

![[Notion/CPTS/RESOURCES/image 4 6.png|image 4 6.png]]