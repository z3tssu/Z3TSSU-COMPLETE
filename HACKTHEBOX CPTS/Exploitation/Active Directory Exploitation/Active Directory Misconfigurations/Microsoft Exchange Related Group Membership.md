
## TL;DR

- Exchange installs often get high AD privileges via groups/ACLs.
    
- **Exchange Windows Permissions** can control the domain DACL → possible DCSync if abused.
    
- **Organization Management** = Exchange “Domain Admins” (mailbox access + control of Microsoft Exchange Security Groups).
    
- Compromise of an Exchange server commonly leads to domain compromise (cached creds in memory, service runs as SYSTEM).
    
- **PrivExchange** is a PushSubscription relay/abuse that allows a mailbox user to make the Exchange service authenticate to an attacker-controlled host — high-impact when combined with over-privileged Exchange service ACLs.
    

---

## Important objects & groups

- **Exchange Windows Permissions** — members can write DACL to domain object (not protected by default).
    
- **Organization Management** — full control of `Microsoft Exchange Security Groups` OU (which contains Exchange Windows Permissions).
    
- **Exchange Trusted Subsystem** — common service principal used by Exchange; watch its ACLs and membership.
    

---

## Why this matters (attacker impact — high level)

- Add user/computer to privileged Exchange groups → escalate to domain-level privileges.
    
- Memory on Exchange (OWA, IIS worker processes, Transport services) often contains many credentials/hashes.
    
- With WriteDacl on domain you can grant DCSync privileges to an account or create backdoor ACLs.
    
- PrivExchange + SYSTEM context + WriteDacl → authenticate/relay to LDAP, extract NTDS, or otherwise escalate to Domain Admin.  
    (Notes describe risk and detection/mitigation rather than exploit steps.)
    

---

## Quick read-only checks (safe to run during assessments)

PowerShell (requires AD module):

- List members of Organization Management:
    

```powershell
Get-ADGroupMember -Identity "Organization Management" | Select Name,SamAccountName,ObjectClass
```

- List members of Exchange Windows Permissions:
    

```powershell
Get-ADGroupMember -Identity "Exchange Windows Permissions" | Select Name,SamAccountName,ObjectClass
```

- Check which groups have control over the `Microsoft Exchange Security Groups` OU:
    

```powershell
Get-ADOrganizationalUnit -Filter 'Name -like "Microsoft Exchange Security Groups"' | Get-ACL | Select -ExpandProperty Access
```

- Query Exchange-related OUs and groups:
    

```powershell
Get-ADOrganizationalUnit -Filter 'Name -like "*Exchange*"' | Select Name,DistinguishedName
Get-ADGroup -Filter 'Name -like "*Exchange*"' | Select Name,DistinguishedName
```

LDAP/DSQuery alternatives:

```cmd
dsquery group -name "*Exchange*" | dsget group -members
```

Inventory Exchange servers and service accounts:

- List Exchange servers from AD:
    

```powershell
Get-ADComputer -Filter {OperatingSystem -like "*Exchange*"} -Properties OperatingSystem | Select Name,OperatingSystem
```

---

## What to look for (red flags / indicators)

- Non-service user accounts (helpdesk, power users, workstations) as members of **Exchange Windows Permissions** or **Organization Management**.
    
- Computers listed as group members.
    
- Excessive ACLs on the domain object that grant WRITE_DACL/WRITE_OWNER to Exchange-related principals.
    
- Unusual authentications from Exchange server accounts to internal hosts.
    
- Large numbers of credentials/NTLM hashes exposed on Exchange hosts (IIS/OWA app pools, Transport processes).
    
- Outdated Exchange servers (missing security updates addressing PushSubscription/relaying).
    

---

## Detection tips

- Audit AD changes to `Organization Management`, `Exchange Windows Permissions`, and `Microsoft Exchange Security Groups` OU.
    
- Monitor for `Set-ADAccountControl`, `Add-ADGroupMember`, and DACL modifications on domain object.
    
- Log and alert on abnormal Exchange service network activity (unexpected outbound HTTP to internal hosts / unusual Kerberos/NTLM traffic).
    
- Periodically run BloodHound/ACL analysis to detect principals with WriteDacl / DCSync possibilities (use in authorized assessments only).
    
- Enable Exchange-related process memory monitoring (EDR) to detect suspicious credential harvesting / process dumps.
    

---

## Mitigation & hardening (priorities)

1. **Least privilege for Exchange** — remove Exchange-related principals from domain-level privileged groups.
    
2. **Lock down Organization Management** — limit membership to trusted admins, review periodically.
    
3. **Harden ACLs on domain object** — remove WRITE_DACL/WRITE_OWNER from Exchange principals unless explicitly required.
    
4. **Patch Exchange** — apply relevant cumulative updates; PrivExchange was addressed in later updates/patches.
    
5. **Segmentation** — isolate Exchange servers from general admin desktops and restrict outbound network flows.
    
6. **Credential hygiene** — avoid interactive logins to Exchange hosts with high-privilege accounts; use managed service accounts where possible.
    
7. **Monitor & log** — AD auditing on group/ACL changes; Exchange logging for unusual subscriptions/HTTP callbacks.
    
8. **EDR and memory protection** — detect/stop credential dumping from Exchange processes.
    

---

## Defensive tools & checks (authorized use)

- `Get-AD*` PowerShell cmdlets for membership & ACL inspection (read-only usage shown above).
    
- AD ACL auditing / BloodHound (graph analysis) — find principals with dangerous ACLs (use only in authorized environments).
    
- SIEM rules: alert on domain DACL changes, Add-ADGroupMember to Organization Management, unexpected Exchange service authentications.
    
- Patch management inventory for Exchange cumulative updates.
    

---

## PrivExchange — concise summary (no exploit instructions)

- Vulnerability in Exchange PushSubscription allowed a mailbox user to force the Exchange service to authenticate to a client-specified HTTP host.
    
- If Exchange service runs as SYSTEM and has domain DACL privileges, the authentication can be relayed/abused to gain elevated domain access.
    
- Treat PrivExchange as a high-severity risk where Exchange is over-privileged or unpatched.
    

---

## Notes / references to research further (authorized defenders)

- Review Exchange cumulative updates and Microsoft advisories for PushSubscription/PrivExchange fixes.
    
- Review community writeups and defensive guides (search for “PrivExchange” and “Exchange Windows Permissions DACL” from reputable security vendors).
    

---

## Short checklist (for a quick triage)

-  Are non-admin users or computers members of Exchange privileged groups?
    
-  Does Exchange-related principal have WRITE_DACL on domain object?
    
-  Are Exchange servers fully patched?
    
-  Is membership of Organization Management restricted and reviewed?
    
-  Are Exchange hosts monitored for credential dumping and abnormal outbound auth flows?
    

---

If you want, I can convert this into a one-page PDF checklist or a compact A4 “hacker notes” cheat-sheet formatted for printing.