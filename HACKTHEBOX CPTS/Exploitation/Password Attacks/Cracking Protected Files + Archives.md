
---

# Cracking Protected Files – 

### 1. Find Encrypted Files (by extensions)

```bash
for ext in $(echo ".xls .xls* .xltx .od* .doc .doc* .pdf .pot .pot* .pp*");do 
  echo -e "\nFile extension: " $ext; 
  find / -name *$ext 2>/dev/null | grep -v "lib\|fonts\|share\|core" 
done
```

_Search for common encrypted file types._

---

### 2. Find SSH Keys (by content)

```bash
grep -rnE '^\-{5}BEGIN [A-Z0-9]+ PRIVATE KEY\-{5}$' /* 2>/dev/null
```

_Look for SSH private keys on the system._

---

### 3. Check if SSH Key is Encrypted

```bash
cat /home/jsmith/.ssh/SSH.private
```

_Look for `Proc-Type: 4,ENCRYPTED` line._

Or:

```bash
ssh-keygen -yf ~/.ssh/id_ed25519
ssh-keygen -yf ~/.ssh/id_rsa
```

_If encrypted, it will ask for passphrase._

---

### 4. Extract Hash from Encrypted SSH Key

```bash
ssh2john.py SSH.private > ssh.hash
john --wordlist=rockyou.txt ssh.hash
john ssh.hash --show
```

_Convert key → hash → crack with John._

---

### 5. Extract Hash from Office Docs

```bash
office2john.py Protected.docx > protected-docx.hash
john --wordlist=rockyou.txt protected-docx.hash
john protected-docx.hash --show
```

_Crack MS Office files._

---

### 6. Extract Hash from PDF

```bash
pdf2john.py PDF.pdf > pdf.hash
john --wordlist=rockyou.txt pdf.hash
john pdf.hash --show
```

_Crack PDFs._

---

### 7. Useful *2john Tools

```bash
locate *2john*
```

_Shows all converters (zip2john, rar2john, gpg2john, etc.)._

---

**Quick Flow:**

1. Find file → 2john script → Hash → Crack with John (wordlist).
    

\
Here’s your simplified **hacker notes** version for **Cracking Protected Archives** – just the commands with short explanations:

---

# Cracking Protected Archives 

### 1. Get List of Archive Extensions

```bash
curl -s https://fileinfo.com/filetypes/compressed | html2text | awk '{print tolower($1)}' | grep "\." | tee -a compressed_ext.txt
```

_Grab all known compressed file extensions._

---

### 2. Crack ZIP Files

```bash
zip2john ZIP.zip > zip.hash
john --wordlist=rockyou.txt zip.hash
john zip.hash --show
```

_Extract hash from ZIP → crack with John._

---

### 3. Crack OpenSSL Encrypted GZIP

```bash
file GZIP.gzip
```

_Check if it’s OpenSSL-encrypted._

```bash
for i in $(cat rockyou.txt);do 
  openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null | tar xz
done
```

_Brute-force with wordlist, successful password extracts file._

---

### 4. Crack BitLocker (Virtual Drives)

```bash
bitlocker2john -i Backup.vhd > backup.hashes
grep "bitlocker\$0" backup.hashes > backup.hash
```

_Extract BitLocker password hash._

```bash
hashcat -a 0 -m 22100 backup.hash /usr/share/wordlists/rockyou.txt
```

_Crack with Hashcat (mode 22100 for BitLocker)._

---

### 5. Mount BitLocker Drive – Windows

- Double-click `.vhd`, enter cracked password.
    

---

### 6. Mount BitLocker Drive – Linux/macOS

```bash
sudo apt-get install dislocker
sudo mkdir -p /media/bitlocker /media/bitlockermount
sudo losetup -f -P Backup.vhd
sudo dislocker /dev/loop0p2 -u1234qwer -- /media/bitlocker
sudo mount -o loop /media/bitlocker/dislocker-file /media/bitlockermount
cd /media/bitlockermount && ls -la
```

_Mount and access cracked BitLocker volume._

Unmount when done:

```bash
sudo umount /media/bitlockermount
sudo umount /media/bitlocker
```

---

**Quick Flow:**

- ZIP → `zip2john` → `john`
    
- GZIP (OpenSSL) → brute-force with `openssl` + wordlist
    
- BitLocker → `bitlocker2john` → `hashcat` (mode 22100) → mount
    

---

Do you want me to merge these with the **Protected Files notes** into a single **cheat sheet table** (File Type → Command to Crack)?