
## **Overview**

- **Protocol**: Windows-integrated remote management protocol (CLI-based).
    
- **Transport**: Uses **SOAP** for remote connections.
    
- **Enablement**: Must be **enabled and configured** on Windows 10 and later.
    
- **Ports**:
    
    - `5985` – HTTP
        
    - `5986` – HTTPS
        
    - _(Previously: `80` for HTTP and `443` for HTTPS, now restricted for security)_
        
- **Windows Remote Shell (WinRS)**:
    
    - Works alongside WinRM for administration tasks.
        
    - Executes arbitrary commands remotely.
        
    - Default on Windows 7 and later.
        
- **Use Cases**:
    
    - Remote command execution.
        
    - PowerShell remote sessions.
        
    - Merging event logs.
        
- **Default Config**:
    
    - Enabled by default on **Windows Server 2012+**.
        
    - Requires **manual configuration and firewall exceptions** on older versions.
        

---

## **Footprinting the Service**

### **Nmap Scan**

Check service and scripts:

```bash
nmap -sV -sC 10.129.201.248 -p5985,5986 --disable-arp-ping -n
```

---

## **Evil-WinRM**

Use for interaction from Linux environments:

```bash
evil-winrm -i 10.129.201.248 -u Cry0l1t3 -p P455w0rD!
```

Example session:

```
Evil-WinRM shell v3.3
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Cry0l1t3\Documents>
```

**Note:** In Windows environments, connectivity can also be tested with PowerShell:

```powershell
Test-WsMan <hostname>
```