
## **Info**

- Predecessor of SSH.
    
- Used for communication between Unix systems.
    
- **Unencrypted transmissions**, making it insecure.
    

---

## **R-Command Suite Programs**

|**Command**|**Service Daemon**|**Port**|**Protocol**|**Description**|
|---|---|---|---|---|
|`rcp`|`rshd`|514|TCP|Copies files/directories between local and remote systems or between remote systems. Overwrites without warning.|
|`rsh`|`rshd`|514|TCP|Opens a remote shell without login prompts. Relies on `/etc/hosts.equiv` or `.rhosts` for trust validation.|
|`rexec`|`rexecd`|512|TCP|Executes remote commands. Requires username and password (unencrypted), but can be overridden by trust files.|
|`rlogin`|`rlogind`|513|TCP|Remote login similar to Telnet, but only for Unix-like systems. Authentication can be bypassed via trust files.|

---

## **/etc/hosts.equiv**

- Contains trusted hosts for automatic login without password prompts.
    
- **Global configuration** for all users on the system.
    

---

## **Scanning for R-Services**

```bash
sudo nmap -sV -p 512,513,514 10.0.17.*
```

---

## **Access Control & Trusted Relationships**

- Relies on **trusted client information** for authentication.
    
- Default authentication: **PAM**.
    
- **Bypasses authentication** if `/etc/hosts.equiv` or `.rhosts` files list the connecting host/user.
    
- `/etc/hosts.equiv` → Global trust configuration.
    
- `.rhosts` → Per-user trust configuration.
    

---

## **Sample `.rhosts` File**

```bash
cat .rhosts

htb-student     10.0.17.5
+               10.0.17.10
+               +
```

- Format: `<username> <ip/hostname>`.
    
- `+` wildcard allows **any user or host**.
    

---

## **Abuse of Misconfigurations**

- Misconfigured `hosts.equiv` or `.rhosts` allows **unauthenticated access**.
    
- Leads to potential **remote code execution**.
    

---

## **Login Using `rlogin`**

```bash
rlogin 10.0.17.2 -l htb-student
```

Example:

```
Last login: Fri Dec  2 16:11:21 from localhost
[htb-student@localhost ~]$
```

---

## **Listing Authenticated Users**

### Using `rwho`

```bash
rwho
```

Example output:

```
root     web01:pts/0 Dec  2 21:34
htb-student     workstn01:tty1  Dec  2 19:57  2:25
```

### Using `rusers`

```bash
rusers -al 10.0.17.5
```